"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const MEMORY_METRIC_NAMES = [
    'averagePercentMemoryUsed',
    'maximumPercentMemoryUsed'
];
function transform(result) {
    const { aggregations, hits } = result;
    const { timeseriesData, averagePercentMemoryUsed, maximumPercentMemoryUsed } = aggregations;
    const series = {
        averagePercentMemoryUsed: [],
        maximumPercentMemoryUsed: []
    };
    // using forEach here to avoid looping over the entire dataset
    // multiple times or doing a complicated, memory-heavy map/reduce
    timeseriesData.buckets.forEach(({ key, ...bucket }) => {
        MEMORY_METRIC_NAMES.forEach(name => {
            series[name].push({ x: key, y: bucket[name].value });
        });
    });
    return {
        series,
        overallValues: {
            averagePercentMemoryUsed: averagePercentMemoryUsed.value,
            maximumPercentMemoryUsed: maximumPercentMemoryUsed.value
        },
        totalHits: hits.total
    };
}
exports.transform = transform;
