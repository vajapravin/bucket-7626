/*! Copyright Elasticsearch B.V. and/or license to Elasticsearch B.V. under one or more contributor license agreements
 * Licensed under the Elastic License; you may not use this file except in compliance with the Elastic License. */(function(modules){function webpackJsonpCallback(data){var chunkIds=data[0];var moreModules=data[1];var executeModules=data[2];var moduleId,chunkId,i=0,resolves=[];for(;i<chunkIds.length;i++){chunkId=chunkIds[i];if(installedChunks[chunkId]){resolves.push(installedChunks[chunkId][0])}installedChunks[chunkId]=0}for(moduleId in moreModules){if(Object.prototype.hasOwnProperty.call(moreModules,moduleId)){modules[moduleId]=moreModules[moduleId]}}if(parentJsonpFunction)parentJsonpFunction(data);while(resolves.length){resolves.shift()()}deferredModules.push.apply(deferredModules,executeModules||[]);return checkDeferredModules()}function checkDeferredModules(){var result;for(var i=0;i<deferredModules.length;i++){var deferredModule=deferredModules[i];var fulfilled=true;for(var j=1;j<deferredModule.length;j++){var depId=deferredModule[j];if(installedChunks[depId]!==0)fulfilled=false}if(fulfilled){deferredModules.splice(i--,1);result=__webpack_require__(__webpack_require__.s=deferredModule[0])}}return result}var installedModules={};var installedChunks={2:0};var deferredModules=[];function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="__REPLACE_WITH_PUBLIC_PATH__";var jsonpArray=window["webpackJsonp"]=window["webpackJsonp"]||[];var oldJsonpFunction=jsonpArray.push.bind(jsonpArray);jsonpArray.push=webpackJsonpCallback;jsonpArray=jsonpArray.slice();for(var i=0;i<jsonpArray.length;i++)webpackJsonpCallback(jsonpArray[i]);var parentJsonpFunction=oldJsonpFunction;deferredModules.push([3201,0]);return checkDeferredModules()})({1146:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.aeroelastic=undefined;var _aeroelastic=__webpack_require__(303);var _aeroelastic2=_interopRequireDefault(_aeroelastic);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var stores=new Map;var aeroelastic=exports.aeroelastic={matrix:_aeroelastic2.default.matrix,clearStores:function clearStores(){stores.clear()},createStore:function createStore(initialState){var onChangeCallback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var page=arguments[2];if(stores.has(page)){throw new Error("Only a single aeroelastic store per page should exist")}stores.set(page,_aeroelastic2.default.state.createStore(initialState,onChangeCallback));var updateScene=_aeroelastic2.default.state.select(function(nextScene,primaryUpdate){return{shapeAdditions:nextScene.shapes,primaryUpdate:primaryUpdate,currentScene:nextScene,configuration:nextScene.configuration}})(_aeroelastic2.default.layout.nextScene,_aeroelastic2.default.layout.primaryUpdate);stores.get(page).setUpdater(updateScene)},removeStore:function removeStore(page){if(stores.has(page)){stores.delete(page)}},getStore:function getStore(page){var store=stores.get(page);if(!store){throw new Error("An aeroelastic store should exist for page "+page)}return store.getCurrentState()},commit:function commit(page){var store=stores.get(page);for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}return store&&store.commit.apply(store,_toConsumableArray(args))}}},1147:function(module,exports,__webpack_require__){"use strict";var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var matrix=__webpack_require__(498);var shapesAtPoint=function shapesAtPoint(shapes,x,y){return shapes.map(function(shape,index){var transformMatrix=shape.transformMatrix,a=shape.a,b=shape.b;var centerPoint=matrix.normalize(matrix.mvMultiply(transformMatrix,matrix.ORIGIN));var rightPoint=matrix.normalize(matrix.mvMultiply(transformMatrix,[1,0,0,1]));var upPoint=matrix.normalize(matrix.mvMultiply(transformMatrix,[0,1,0,1]));var x0=rightPoint[0]-centerPoint[0];var y0=rightPoint[1]-centerPoint[1];var x1=upPoint[0]-centerPoint[0];var y1=upPoint[1]-centerPoint[1];var A=(x-centerPoint[0]-(y-centerPoint[1])/y1*x1)/(x0-y0/y1*x1);var B=(y-centerPoint[1]-A*y0)/y1;var rightSlope=rightPoint[2]-centerPoint[2];var upSlope=upPoint[2]-centerPoint[2];var z=centerPoint[2]+(y1?rightSlope*A+upSlope*B:0);var inverseProjection=matrix.invert(transformMatrix);var intersection=matrix.normalize(matrix.mvMultiply(inverseProjection,[x,y,z,1]));var _intersection=_slicedToArray(intersection,2),sx=_intersection[0],sy=_intersection[1];return{z:z,intersection:intersection,inside:Math.abs(sx)<=a&&Math.abs(sy)<=b,shape:shape,index:index}})};var shapesAt=function shapesAt(shapes,_ref){var x=_ref.x,y=_ref.y;return shapesAtPoint(shapes,x,y).filter(function(shape){return shape.inside}).sort(function(shape1,shape2){return shape2.z-shape1.z||shape2.index-shape1.index}).map(function(shape){return shape.shape})};var getExtremum=function getExtremum(transformMatrix,a,b){return matrix.normalize(matrix.mvMultiply(transformMatrix,[a,b,0,1]))};var landmarkPoint=function landmarkPoint(a,b,transformMatrix,k,l){return getExtremum(transformMatrix,k*a,l*b)};module.exports={landmarkPoint:landmarkPoint,shapesAt:shapesAt}},1148:function(module,exports,__webpack_require__){"use strict";var _require=__webpack_require__(699),select=_require.select,selectReduce=_require.selectReduce;var appleKeyboard=Boolean(window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.match("Macintosh|iPhone|iPad"));var primaryUpdate=function primaryUpdate(state){return state.primaryUpdate};var rawCursorPosition=select(function(action){return action.type==="cursorPosition"?action.payload:null})(primaryUpdate);var mouseButtonEvent=select(function(action){return action.type==="mouseEvent"?action.payload:null})(primaryUpdate);var keyFromMouse=select(function(_ref){var type=_ref.type,_ref$payload=_ref.payload,altKey=_ref$payload.altKey,metaKey=_ref$payload.metaKey,shiftKey=_ref$payload.shiftKey,ctrlKey=_ref$payload.ctrlKey;return type==="cursorPosition"||type==="mouseEvent"?{altKey:altKey,metaKey:metaKey,shiftKey:shiftKey,ctrlKey:ctrlKey}:{}})(primaryUpdate);var metaHeld=select(appleKeyboard?function(e){return e.metaKey}:function(e){return e.altKey})(keyFromMouse);var optionHeld=select(appleKeyboard?function(e){return e.altKey}:function(e){return e.ctrlKey})(keyFromMouse);var shiftHeld=select(function(e){return e.shiftKey})(keyFromMouse);var cursorPosition=selectReduce(function(previous,position){return position||previous},{x:0,y:0})(rawCursorPosition);var mouseButton=selectReduce(function(prev,next){if(!next){return prev}var event=next.event,uid=next.uid;if(event==="mouseDown"){return{down:true,uid:uid}}else{return event==="mouseUp"?{down:false,uid:uid}:prev}},{down:false,uid:null})(mouseButtonEvent);var mouseIsDown=selectReduce(function(previous,next){return next?next.event==="mouseDown":previous},false)(mouseButtonEvent);var gestureEnd=select(function(action){return action&&(action.type==="actionEvent"||action.type==="mouseEvent"&&action.payload.event==="mouseUp")})(primaryUpdate);var mouseButtonStateTransitions=function mouseButtonStateTransitions(state,mouseIsDown,movedAlready){switch(state){case"up":return mouseIsDown?"downed":"up";case"downed":if(mouseIsDown){return movedAlready?"dragging":"downed"}else{return"up"}case"dragging":return mouseIsDown?"dragging":"up"}};var mouseButtonState=selectReduce(function(_ref2,mouseIsDown,_ref3){var buttonState=_ref2.buttonState,downX=_ref2.downX,downY=_ref2.downY;var x=_ref3.x,y=_ref3.y;var movedAlready=x!==downX||y!==downY;var newButtonState=mouseButtonStateTransitions(buttonState,mouseIsDown,movedAlready);return{buttonState:newButtonState,downX:newButtonState==="downed"?x:downX,downY:newButtonState==="downed"?y:downY}},{buttonState:"up",downX:null,downY:null})(mouseIsDown,cursorPosition);var mouseDowned=select(function(state){return state.buttonState==="downed"})(mouseButtonState);var dragging=select(function(state){return state.buttonState==="dragging"})(mouseButtonState);var dragVector=select(function(_ref4,_ref5){var buttonState=_ref4.buttonState,downX=_ref4.downX,downY=_ref4.downY;var x=_ref5.x,y=_ref5.y;return{down:buttonState!=="up",x0:downX,y0:downY,x1:x,y1:y}})(mouseButtonState,cursorPosition);var actionEvent=select(function(action){return action.type==="actionEvent"?action.payload:null})(primaryUpdate);module.exports={actionEvent:actionEvent,dragging:dragging,dragVector:dragVector,cursorPosition:cursorPosition,gestureEnd:gestureEnd,metaHeld:metaHeld,mouseButton:mouseButton,mouseDowned:mouseDowned,mouseIsDown:mouseIsDown,optionHeld:optionHeld,shiftHeld:shiftHeld}},1150:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.typesRegistry=undefined;var _common=__webpack_require__(41);var typesRegistry=exports.typesRegistry=new _common.TypesRegistry},1151:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2113)},1152:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getState=getState;exports.getValue=getValue;exports.getError=getError;var _lodash=__webpack_require__(1);function getState(resolvedArg){return(0,_lodash.get)(resolvedArg,"state",null)}function getValue(resolvedArg){return(0,_lodash.get)(resolvedArg,"value",null)}function getError(resolvedArg){if(getState(resolvedArg)!=="error"){return null}return(0,_lodash.get)(resolvedArg,"error",null)}},1153:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.apps=exports.routes=undefined;var _home=__webpack_require__(3220);var home=_interopRequireWildcard(_home);var _workpad=__webpack_require__(3239);var workpad=_interopRequireWildcard(_workpad);var _export=__webpack_require__(3386);var exp=_interopRequireWildcard(_export);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}var routes=exports.routes=[].concat(workpad.routes,home.routes,exp.routes);var apps=exports.apps=[workpad.WorkpadApp,home.HomeApp,exp.ExportApp]},1154:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.HomeApp=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _eui=__webpack_require__(2);var _workpad_manager=__webpack_require__(1155);var _doc_title=__webpack_require__(1159);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HomeApp=exports.HomeApp=function HomeApp(){(0,_doc_title.setDocTitle)("Canvas");return _react2.default.createElement(_eui.EuiPage,{className:"canvasHomeApp",restrictWidth:true},_react2.default.createElement(_eui.EuiPageBody,null,_react2.default.createElement(_eui.EuiPageContent,{className:"canvasHomeApp__content",panelPaddingSize:"none",horizontalPosition:"center"},_react2.default.createElement(_workpad_manager.WorkpadManager,{onClose:function onClose(){}}))))}},1155:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _workpad_manager=__webpack_require__(3222);Object.defineProperty(exports,"WorkpadManager",{enumerable:true,get:function get(){return _workpad_manager.WorkpadManager}})},1156:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(3318)},1157:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.uploadWorkpad=undefined;var _lodash=__webpack_require__(1);var _get_id=__webpack_require__(228);var _notify=__webpack_require__(199);var uploadWorkpad=exports.uploadWorkpad=function uploadWorkpad(file,onUpload){if(!file){return}if((0,_lodash.get)(file,"type")!=="application/json"){return _notify.notify.warning("Only JSON files are accepted",{title:"Couldn't upload '"+(file.name||"file")+"'"})}var reader=new FileReader;reader.onload=function(){try{var workpad=JSON.parse(reader.result);workpad.id=(0,_get_id.getId)("workpad");if(!Array.isArray(workpad.pages)||workpad.pages.length===0||!workpad.assets){throw new Error("Some properties required for a Canvas workpad are missing.  Edit your JSON file to provide the correct property values and try again.")}onUpload(workpad)}catch(e){_notify.notify.error(e,{title:"Couldn't upload '"+(file.name||"file")+"'"})}};reader.readAsText(file)}},1158:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.templatesRegistry=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _common=__webpack_require__(41);var _template=__webpack_require__(3235);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var TemplateRegistry=function(_Registry){_inherits(TemplateRegistry,_Registry);function TemplateRegistry(){_classCallCheck(this,TemplateRegistry);return _possibleConstructorReturn(this,(TemplateRegistry.__proto__||Object.getPrototypeOf(TemplateRegistry)).apply(this,arguments))}_createClass(TemplateRegistry,[{key:"wrapper",value:function wrapper(obj){return new _template.Template(obj)}}]);return TemplateRegistry}(_common.Registry);var templatesRegistry=exports.templatesRegistry=new TemplateRegistry},1159:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var setDocTitle=exports.setDocTitle=function setDocTitle(title){return document.title=title+" - Kibana"}},1160:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadApp=undefined;var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _workpad=__webpack_require__(180);var _transient=__webpack_require__(230);var _app=__webpack_require__(72);var _workpad2=__webpack_require__(33);var _load_workpad=__webpack_require__(3241);var _workpad_app=__webpack_require__(3242);var mapStateToProps=function mapStateToProps(state){var appReady=(0,_app.getAppReady)(state);return{isWriteable:(0,_workpad2.isWriteable)(state)&&(0,_app.canUserWrite)(state),appReady:(typeof appReady==="undefined"?"undefined":_typeof(appReady))==="object"?appReady:{ready:appReady},workpad:(0,_workpad2.getWorkpad)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{initializeWorkpad:function initializeWorkpad(){dispatch((0,_workpad.initializeWorkpad)())},deselectElement:function deselectElement(ev){ev&&ev.stopPropagation();dispatch((0,_transient.selectElement)(null))}}};var branches=[(0,_recompose.branch)(function(_ref){var workpad=_ref.workpad;return workpad==null},(0,_recompose.renderComponent)(_load_workpad.LoadWorkpad))];var WorkpadApp=exports.WorkpadApp=_recompose.compose.apply(undefined,[(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)].concat(branches))(_workpad_app.WorkpadApp)},1161:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.datasourceRegistry=exports.Datasource=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _common=__webpack_require__(41);var _render_to_dom=__webpack_require__(707);var _expression_form_handlers=__webpack_require__(1162);var _base_form=__webpack_require__(708);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var defaultTemplate=function defaultTemplate(){return _react2.default.createElement("div",null,_react2.default.createElement("p",null,"This datasource has no interface. Use the expression editor to make changes."))};var DatasourceWrapper=function(_React$PureComponent){_inherits(DatasourceWrapper,_React$PureComponent);function DatasourceWrapper(){var _ref;var _temp,_this,_ret;_classCallCheck(this,DatasourceWrapper);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=DatasourceWrapper.__proto__||Object.getPrototypeOf(DatasourceWrapper)).call.apply(_ref,[this].concat(args))),_this),_this.callRenderFn=function(){var _this$props=_this.props,spec=_this$props.spec,datasourceProps=_this$props.datasourceProps,handlers=_this$props.handlers;var template=spec.template;template(_this.domNode,datasourceProps,handlers)},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(DatasourceWrapper,[{key:"componentDidUpdate",value:function componentDidUpdate(){this.callRenderFn()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.handlers.destroy()}},{key:"render",value:function render(){var _this2=this;return _react2.default.createElement(_render_to_dom.RenderToDom,{render:function render(domNode){_this2.domNode=domNode;_this2.callRenderFn()}})}}]);return DatasourceWrapper}(_react2.default.PureComponent);DatasourceWrapper.propTypes={spec:_propTypes2.default.object.isRequired,datasourceProps:_propTypes2.default.object.isRequired,handlers:_propTypes2.default.object.isRequired};var Datasource=exports.Datasource=function(_BaseForm){_inherits(Datasource,_BaseForm);function Datasource(props){_classCallCheck(this,Datasource);var _this3=_possibleConstructorReturn(this,(Datasource.__proto__||Object.getPrototypeOf(Datasource)).call(this,props));_this3.template=props.template||defaultTemplate;_this3.image=props.image;return _this3}_createClass(Datasource,[{key:"render",value:function render(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var expressionFormHandlers=new _expression_form_handlers.ExpressionFormHandlers;return _react2.default.createElement(DatasourceWrapper,{spec:this,handlers:expressionFormHandlers,datasourceProps:props})}}]);return Datasource}(_base_form.BaseForm);var DatasourceRegistry=function(_Registry){_inherits(DatasourceRegistry,_Registry);function DatasourceRegistry(){_classCallCheck(this,DatasourceRegistry);return _possibleConstructorReturn(this,(DatasourceRegistry.__proto__||Object.getPrototypeOf(DatasourceRegistry)).apply(this,arguments))}_createClass(DatasourceRegistry,[{key:"wrapper",value:function wrapper(obj){return new Datasource(obj)}}]);return DatasourceRegistry}(_common.Registry);var datasourceRegistry=exports.datasourceRegistry=new DatasourceRegistry},1162:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ExpressionFormHandlers=exports.ExpressionFormHandlers=function(){function ExpressionFormHandlers(){_classCallCheck(this,ExpressionFormHandlers);this.destroy=function(){};this.done=function(){}}_createClass(ExpressionFormHandlers,[{key:"onDestroy",value:function onDestroy(fn){this.destroy=fn}}]);return ExpressionFormHandlers}()},1163:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.transformRegistry=exports.Transform=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);var _function_form=__webpack_require__(709);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Transform=exports.Transform=function(_FunctionForm){_inherits(Transform,_FunctionForm);function Transform(props){_classCallCheck(this,Transform);var _this=_possibleConstructorReturn(this,(Transform.__proto__||Object.getPrototypeOf(Transform)).call(this,props));var propNames=["requiresContext"];var defaultProps={requiresContext:true};Object.assign(_this,defaultProps,(0,_lodash.pick)(props,propNames));return _this}return Transform}(_function_form.FunctionForm);var TransformRegistry=function(_Registry){_inherits(TransformRegistry,_Registry);function TransformRegistry(){_classCallCheck(this,TransformRegistry);return _possibleConstructorReturn(this,(TransformRegistry.__proto__||Object.getPrototypeOf(TransformRegistry)).apply(this,arguments))}_createClass(TransformRegistry,[{key:"wrapper",value:function wrapper(obj){return new Transform(obj)}}]);return TransformRegistry}(_common.Registry);var transformRegistry=exports.transformRegistry=new TransformRegistry},1164:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SidebarSection=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SidebarSection=exports.SidebarSection=function SidebarSection(_ref){var children=_ref.children;return _react2.default.createElement(_eui.EuiPanel,{className:"canvasSidebar__panel"},children)};SidebarSection.propTypes={children:_propTypes2.default.node,title:_propTypes2.default.string,tip:_propTypes2.default.string}},1165:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Arg=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _lodash=__webpack_require__(1);var _arg_form=__webpack_require__(3254);var _arg_type=__webpack_require__(1168);function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Arg=exports.Arg=function(){function Arg(props){_classCallCheck(this,Arg);var argType=_arg_type.argTypeRegistry.get(props.argType);if(!argType){throw new Error("Invalid arg type: "+props.argType)}if(!props.name){throw new Error("Args must have a name property")}var defaultProps={multi:false,required:false,types:[],default:argType.default!=null?argType.default:null,options:{},resolve:function resolve(){return{}}};var viewOverrides=_extends({argType:argType},(0,_lodash.pick)(props,["name","displayName","help","multi","required","types","default","resolve","options"]));Object.assign(this,defaultProps,argType,viewOverrides)}_createClass(Arg,[{key:"render",value:function render(_ref){var onValueChange=_ref.onValueChange,onValueRemove=_ref.onValueRemove,argValue=_ref.argValue,key=_ref.key,label=_ref.label,otherProps=_objectWithoutProperties(_ref,["onValueChange","onValueRemove","argValue","key","label"]);var templateProps=_extends({},otherProps,this.resolve(otherProps),{onValueChange:onValueChange,argValue:argValue,typeInstance:this});var formProps={key:key,argTypeInstance:this,valueMissing:this.required&&argValue==null,label:label,onValueChange:onValueChange,onValueRemove:onValueRemove,templateProps:templateProps,argId:key};return(0,_react.createElement)(_arg_form.ArgForm,formProps)}}]);return Arg}()},1166:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ErrorBoundary=exports.errorBoundaryHoc=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _recompose=__webpack_require__(19);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _lodash=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var errorBoundaryHoc=exports.errorBoundaryHoc=(0,_recompose.compose)((0,_recompose.withState)("error","setError",null),(0,_recompose.withState)("errorInfo","setErrorInfo",null),(0,_recompose.withHandlers)({resetErrorState:function resetErrorState(_ref){var setError=_ref.setError,setErrorInfo=_ref.setErrorInfo;return function(){setError(null);setErrorInfo(null)}}}),(0,_recompose.lifecycle)({componentDidCatch:function componentDidCatch(error,errorInfo){this.props.setError(error);this.props.setErrorInfo(errorInfo)}}),(0,_recompose.mapProps)(function(props){return(0,_lodash.omit)(props,["setError","setErrorInfo"])}));var ErrorBoundaryComponent=function ErrorBoundaryComponent(props){return _react2.default.createElement(_react.Fragment,null,props.children({error:props.error,errorInfo:props.errorInfo,resetErrorState:props.resetErrorState}))};ErrorBoundaryComponent.propTypes={children:_propTypes2.default.func.isRequired,error:_propTypes2.default.object,errorInfo:_propTypes2.default.object,resetErrorState:_propTypes2.default.func.isRequired};var ErrorBoundary=exports.ErrorBoundary=errorBoundaryHoc(ErrorBoundaryComponent)},1167:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgLabel=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ArgLabel=exports.ArgLabel=function ArgLabel(props){var argId=props.argId,className=props.className,label=props.label,help=props.help,expandable=props.expandable,children=props.children,simpleArg=props.simpleArg,initialIsOpen=props.initialIsOpen;return _react2.default.createElement("div",{className:"canvasArg--header"+(className&&" "+className)},expandable?_react2.default.createElement(_eui.EuiAccordion,{id:"accordion-"+argId,className:"canvasArg__accordion",buttonContent:_react2.default.createElement(_eui.EuiToolTip,{content:help,position:"left",className:"canvasArg__tooltip"},_react2.default.createElement(_eui.EuiText,{size:"s",color:"subdued",htmlFor:"accordion-"+argId},label)),extraAction:simpleArg,initialIsOpen:initialIsOpen},_react2.default.createElement("div",{className:"canvasArg__content"},children)):simpleArg&&_react2.default.createElement(_eui.EuiFormRow,{label:label,helpText:help,id:argId},simpleArg))};ArgLabel.propTypes={argId:_propTypes2.default.string,label:_propTypes2.default.string,help:_propTypes2.default.string,expandable:_propTypes2.default.bool,initialIsOpen:_propTypes2.default.bool,simpleArg:_propTypes2.default.object,children:_propTypes2.default.oneOfType([_propTypes2.default.node,_propTypes2.default.element]).isRequired,className:_propTypes2.default.string}},1168:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.argTypeRegistry=exports.ArgType=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _common=__webpack_require__(41);var _base_form=__webpack_require__(708);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ArgType=exports.ArgType=function(_BaseForm){_inherits(ArgType,_BaseForm);function ArgType(props){_classCallCheck(this,ArgType);var _this=_possibleConstructorReturn(this,(ArgType.__proto__||Object.getPrototypeOf(ArgType)).call(this,props));_this.simpleTemplate=props.simpleTemplate;_this.template=props.template;_this.default=props.default;_this.resolveArgValue=Boolean(props.resolveArgValue);return _this}return ArgType}(_base_form.BaseForm);var ArgTypeRegistry=function(_Registry){_inherits(ArgTypeRegistry,_Registry);function ArgTypeRegistry(){_classCallCheck(this,ArgTypeRegistry);return _possibleConstructorReturn(this,(ArgTypeRegistry.__proto__||Object.getPrototypeOf(ArgTypeRegistry)).apply(this,arguments))}_createClass(ArgTypeRegistry,[{key:"wrapper",value:function wrapper(obj){return new ArgType(obj)}}]);return ArgTypeRegistry}(_common.Registry);var argTypeRegistry=exports.argTypeRegistry=new ArgTypeRegistry},1169:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.modelRegistry=exports.Model=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);var _function_form=__webpack_require__(709);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var NO_NEXT_EXP="no next expression";var MISSING_MODEL_ARGS="missing model args";function getModelArgs(expressionType){if(!expressionType){return NO_NEXT_EXP}if(!expressionType.modelArgs){return MISSING_MODEL_ARGS}return expressionType.modelArgs.length>0?expressionType.modelArgs:MISSING_MODEL_ARGS}var Model=exports.Model=function(_FunctionForm){_inherits(Model,_FunctionForm);function Model(props){_classCallCheck(this,Model);var _this=_possibleConstructorReturn(this,(Model.__proto__||Object.getPrototypeOf(Model)).call(this,props));var propNames=["requiresContext"];var defaultProps={requiresContext:true};Object.assign(_this,defaultProps,(0,_lodash.pick)(props,propNames));return _this}_createClass(Model,[{key:"resolveArg",value:function resolveArg(dataArg,props){var nextExpressionType=props.nextExpressionType;var modelArgs=getModelArgs(nextExpressionType);if(modelArgs===MISSING_MODEL_ARGS){throw new Error(nextExpressionType.displayName+" modelArgs Error:\n        The modelArgs value is empty. Either it should contain an arg,\n        or a model should not be used in the expression.\n      ")}if(modelArgs===NO_NEXT_EXP){return{skipRender:true}}var argName=(0,_lodash.get)(dataArg,"arg.name");var modelArg=modelArgs.find(function(modelArg){if(Array.isArray(modelArg)){return modelArg[0]===argName}return modelArg===argName});return{label:Array.isArray(modelArg)?(0,_lodash.get)(modelArg[1],"label"):null,skipRender:!modelArg}}}]);return Model}(_function_form.FunctionForm);var ModelRegistry=function(_Registry){_inherits(ModelRegistry,_Registry);function ModelRegistry(){_classCallCheck(this,ModelRegistry);return _possibleConstructorReturn(this,(ModelRegistry.__proto__||Object.getPrototypeOf(ModelRegistry)).apply(this,arguments))}_createClass(ModelRegistry,[{key:"wrapper",value:function wrapper(obj){return new Model(obj)}}]);return ModelRegistry}(_common.Registry);var modelRegistry=exports.modelRegistry=new ModelRegistry},1170:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.viewRegistry=exports.View=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);var _function_form=__webpack_require__(709);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var View=exports.View=function(_FunctionForm){_inherits(View,_FunctionForm);function View(props){_classCallCheck(this,View);var _this=_possibleConstructorReturn(this,(View.__proto__||Object.getPrototypeOf(View)).call(this,props));var propNames=["help","modelArgs","requiresContext"];var defaultProps={help:"Element: "+props.name,requiresContext:true};Object.assign(_this,defaultProps,(0,_lodash.pick)(props,propNames));_this.modelArgs=_this.modelArgs||[];if(!Array.isArray(_this.modelArgs)){throw new Error(_this.name+" element is invalid, modelArgs must be an array")}return _this}return View}(_function_form.FunctionForm);var ViewRegistry=function(_Registry){_inherits(ViewRegistry,_Registry);function ViewRegistry(){_classCallCheck(this,ViewRegistry);return _possibleConstructorReturn(this,(ViewRegistry.__proto__||Object.getPrototypeOf(ViewRegistry)).apply(this,arguments))}_createClass(ViewRegistry,[{key:"wrapper",value:function wrapper(obj){return new View(obj)}}]);return ViewRegistry}(_common.Registry);var viewRegistry=exports.viewRegistry=new ViewRegistry},1171:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorPicker=undefined;var _recompose=__webpack_require__(19);var _color_picker=__webpack_require__(3292);var ColorPicker=exports.ColorPicker=(0,_recompose.pure)(_color_picker.ColorPicker)},1172:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorDot=undefined;var _recompose=__webpack_require__(19);var _color_dot=__webpack_require__(1173);var ColorDot=exports.ColorDot=(0,_recompose.pure)(_color_dot.ColorDot)},1173:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorDot=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ColorDot=exports.ColorDot=function ColorDot(_ref){var value=_ref.value,children=_ref.children;return _react2.default.createElement("div",{className:"canvasColorDot"},_react2.default.createElement("div",{className:"canvasColorDot__background canvasCheckered"}),_react2.default.createElement("div",{className:"canvasColorDot__foreground",style:{background:value}},children))};ColorDot.propTypes={value:_propTypes2.default.string,children:_propTypes2.default.node,handleClick:_propTypes2.default.func}},1174:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadPage=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _reactRedux=__webpack_require__(14);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _notify=__webpack_require__(199);var _aeroelastic_kibana=__webpack_require__(1146);var _clipboard=__webpack_require__(3333);var _clone_subgraphs=__webpack_require__(706);var _elements=__webpack_require__(61);var _app=__webpack_require__(72);var _workpad=__webpack_require__(33);var _functional=__webpack_require__(351);var _event_handlers=__webpack_require__(3334);var _workpad_page=__webpack_require__(3335);var _transient=__webpack_require__(230);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var mapStateToProps=function mapStateToProps(state,ownProps){return{isEditable:!(0,_app.getFullscreen)(state)&&(0,_workpad.isWriteable)(state)&&(0,_app.canUserWrite)(state),elements:(0,_workpad.getNodes)(state,ownProps.page.id)}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{insertNodes:function insertNodes(pageId){return function(selectedElements){return dispatch((0,_elements.insertNodes)(selectedElements,pageId))}},removeElements:function removeElements(pageId){return function(elementIds){return dispatch((0,_elements.removeElements)(elementIds,pageId))}},selectElement:function selectElement(selectedElement){return dispatch((0,_transient.selectElement)(selectedElement))}}};var getRootElementId=function getRootElementId(lookup,id){if(!lookup.has(id)){return null}var element=lookup.get(id);return element.parent&&element.parent.subtype!=="adHocGroup"?getRootElementId(lookup,element.parent):element.id};var WorkpadPage=exports.WorkpadPage=(0,_recompose.compose)((0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps),(0,_recompose.withProps)(function(_ref){var isSelected=_ref.isSelected,animation=_ref.animation;function getClassName(){if(animation){return animation.name}return isSelected?"canvasPage--isActive":"canvasPage--isInactive"}function getAnimationStyle(){if(!animation){return{}}return{animationDirection:animation.direction,animationDuration:"1s"}}return{className:getClassName(),animationStyle:getAnimationStyle()}}),(0,_recompose.withState)("updateCount","setUpdateCount",0),(0,_recompose.withProps)(function(_ref2){var updateCount=_ref2.updateCount,setUpdateCount=_ref2.setUpdateCount,page=_ref2.page,pageElements=_ref2.elements,insertNodes=_ref2.insertNodes,removeElements=_ref2.removeElements,selectElement=_ref2.selectElement;var _aeroelastic$getStore=_aeroelastic_kibana.aeroelastic.getStore(page.id).currentScene,shapes=_aeroelastic$getStore.shapes,_aeroelastic$getStore2=_aeroelastic$getStore.selectedPrimaryShapes,selectedPrimaryShapes=_aeroelastic$getStore2===undefined?[]:_aeroelastic$getStore2,cursor=_aeroelastic$getStore.cursor;var elementLookup=new Map(pageElements.map(function(element){return[element.id,element]}));var recurseGroupTree=function recurseGroupTree(shapeId){return[shapeId].concat(_toConsumableArray((0,_functional.flatten)(shapes.filter(function(s){return s.parent===shapeId&&s.type!=="annotation"}).map(function(s){return s.id}).map(recurseGroupTree))))};var selectedPrimaryShapeObjects=selectedPrimaryShapes.map(function(id){return shapes.find(function(s){return s.id===id})});var selectedPersistentPrimaryShapes=(0,_functional.flatten)(selectedPrimaryShapeObjects.map(function(shape){return shape.subtype==="adHocGroup"?shapes.filter(function(s){return s.parent===shape.id&&s.type!=="annotation"}).map(function(s){return s.id}):[shape.id]}));var selectedElementIds=(0,_functional.flatten)(selectedPersistentPrimaryShapes.map(recurseGroupTree));var selectedElements=[];var elements=shapes.map(function(shape){var element=null;if(elementLookup.has(shape.id)){element=elementLookup.get(shape.id);if(selectedElementIds.indexOf(shape.id)>-1){selectedElements.push(_extends({},element,{id:shape.id}))}}return element?_extends({},shape,{filter:element.filter}):shape});return{elements:elements,cursor:cursor,commit:function commit(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_aeroelastic_kibana.aeroelastic.commit.apply(_aeroelastic_kibana.aeroelastic,[page.id].concat(args));setUpdateCount(updateCount+1)},remove:function remove(){if(selectedElementIds.length){removeElements(page.id)(selectedElementIds)}},copyElements:function copyElements(){if(selectedElements.length){(0,_clipboard.setClipboardData)({selectedElements:selectedElements,rootShapes:selectedPrimaryShapes});_notify.notify.success("Copied element to clipboard")}},cutElements:function cutElements(){if(selectedElements.length){(0,_clipboard.setClipboardData)({selectedElements:selectedElements,rootShapes:selectedPrimaryShapes});removeElements(page.id)(selectedElementIds);_notify.notify.success("Copied element to clipboard")}},pasteElements:function pasteElements(){var _ref3=JSON.parse((0,_clipboard.getClipboardData)())||{},selectedElements=_ref3.selectedElements,rootShapes=_ref3.rootShapes;var clonedElements=selectedElements&&(0,_clone_subgraphs.cloneSubgraphs)(selectedElements);if(clonedElements){insertNodes(page.id)(clonedElements);if(rootShapes.length){if(selectedElements.length>1){selectElement(clonedElements[0].id)}else{selectElement(clonedElements[selectedElements.findIndex(function(s){return s.id===rootShapes[0]})].id)}}}}}}),_event_handlers.withEventHandlers)(_workpad_page.WorkpadPage);WorkpadPage.propTypes={page:_propTypes2.default.shape({id:_propTypes2.default.string.isRequired}).isRequired}},1175:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderFunctionsRegistry=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _common=__webpack_require__(41);var _render_function=__webpack_require__(3341);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var RenderFunctionsRegistry=function(_Registry){_inherits(RenderFunctionsRegistry,_Registry);function RenderFunctionsRegistry(){_classCallCheck(this,RenderFunctionsRegistry);return _possibleConstructorReturn(this,(RenderFunctionsRegistry.__proto__||Object.getPrototypeOf(RenderFunctionsRegistry)).apply(this,arguments))}_createClass(RenderFunctionsRegistry,[{key:"wrapper",value:function wrapper(obj){return new _render_function.RenderFunction(obj)}}]);return RenderFunctionsRegistry}(_common.Registry);var renderFunctionsRegistry=exports.renderFunctionsRegistry=new RenderFunctionsRegistry},1176:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Clipboard=undefined;var _clipboard=__webpack_require__(3369);var Clipboard=exports.Clipboard=_clipboard.Clipboard},1177:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2432)},1179:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExportApp=undefined;var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _workpad=__webpack_require__(180);var _workpad2=__webpack_require__(33);var _load_workpad=__webpack_require__(3388);var _export_app=__webpack_require__(3389);var mapStateToProps=function mapStateToProps(state){return{workpad:(0,_workpad2.getWorkpad)(state),selectedPageId:(0,_workpad2.getSelectedPage)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{initializeWorkpad:function initializeWorkpad(){dispatch((0,_workpad.initializeWorkpad)())}}};var branches=[(0,_recompose.branch)(function(_ref){var workpad=_ref.workpad;return workpad==null},(0,_recompose.renderComponent)(_load_workpad.LoadWorkpad))];var ExportApp=exports.ExportApp=_recompose.compose.apply(undefined,[(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)].concat(branches))(_export_app.ExportApp)},1180:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.historyProvider=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _lzString=__webpack_require__(5019);var _lzString2=_interopRequireDefault(_lzString);var _history=__webpack_require__(421);var _historyExtra=__webpack_require__(5020);var _historyExtra2=_interopRequireDefault(_historyExtra);var _get_window=__webpack_require__(245);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function wrapHistoryInstance(history){var historyState={onChange:[],prevLocation:{},changeUnlisten:null};var locationFormat=function locationFormat(location,action,parser){return{pathname:location.pathname,hash:location.hash,state:parser(location.state),action:action.toLowerCase()}};var wrappedHistory={undo:function undo(){history.goBack()},redo:function redo(){history.goForward()},go:function go(idx){history.go(idx)},parse:function parse(payload){try{var stateJSON=_lzString2.default.decompress(payload);return JSON.parse(stateJSON)}catch(e){return null}},encode:function encode(state){try{var stateJSON=JSON.stringify(state);return _lzString2.default.compress(stateJSON)}catch(e){throw new Error("Could not encode state: ",e.message)}},getLocation:function getLocation(){var location=history.location;return _extends({},location,{state:this.parse(location.state)})},getPath:function getPath(path){if(path!=null){return(0,_history.createPath)((0,_history.parsePath)(path))}return(0,_history.createPath)(this.getLocation())},getFullPath:function getFullPath(path){if(path!=null){return history.createHref((0,_history.parsePath)(path))}return history.createHref(this.getLocation())},push:function push(state,path){history.push(path||this.getPath(),this.encode(state))},replace:function replace(state,path){history.replace(path||this.getPath(),this.encode(state))},onChange:function onChange(fn){if(fn==null){return}var pushedIndex=historyState.onChange.push(fn)-1;return function(){var called=false;return function(){if(called){return}historyState.onChange.splice(pushedIndex,1);called=true}}()},resetOnChange:function resetOnChange(){historyState.onChange.splice(0)},get historyInstance(){return history}};historyState.prevLocation=wrappedHistory.getLocation();historyState.changeUnlisten=history.listen(function(location,action){var prevLocation=historyState.prevLocation;var locationObj=locationFormat(location,action,wrappedHistory.parse);var prevLocationObj=locationFormat(prevLocation,action,wrappedHistory.parse);historyState.onChange.forEach(function(fn){return fn.call(null,locationObj,prevLocationObj)});historyState.prevLocation=wrappedHistory.getLocation()});return wrappedHistory}var instances=new WeakMap;var getHistoryInstance=function getHistoryInstance(win){if(typeof win==="undefined"||!win.history){return(0,_history.createMemoryHistory)()}return(0,_historyExtra2.default)()};var historyProvider=exports.historyProvider=function historyProvider(){var win=arguments.length>0&&arguments[0]!==undefined?arguments[0]:(0,_get_window.getWindow)();var instance=instances.get(win);if(instance){return instance}var historyInstance=getHistoryInstance(win);var wrappedInstance=wrapHistoryInstance(historyInstance);instances.set(win,wrappedInstance);return wrappedInstance}},1181:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var americanTypewriter=exports.americanTypewriter={label:"American Typewriter",value:"'American Typewriter', 'Courier New', Courier, Monaco, mono"};var arial=exports.arial={label:"Arial",value:"Arial, sans-serif"};var baskerville=exports.baskerville={label:"Baskerville",value:"Baskerville, Georgia, Garamond, 'Times New Roman', Times, serif"};var bookAntiqua=exports.bookAntiqua={label:"Book Antiqua",value:"'Book Antiqua', Georgia, Garamond, 'Times New Roman', Times, serif"};var brushScript=exports.brushScript={label:"Brush Script",value:"'Brush Script MT', 'Comic Sans', sans-serif"};var chalkboard=exports.chalkboard={label:"Chalkboard",value:"Chalkboard, 'Comic Sans', sans-serif"};var didot=exports.didot={label:"Didot",value:"Didot, Georgia, Garamond, 'Times New Roman', Times, serif"};var futura=exports.futura={label:"Futura",value:"Futura, Impact, Helvetica, Arial, sans-serif"};var gillSans=exports.gillSans={label:"Gill Sans",value:"'Gill Sans', 'Lucida Grande', 'Lucida Sans Unicode', Verdana, Helvetica, Arial, sans-serif"};var helveticaNeue=exports.helveticaNeue={label:"Helvetica Neue",value:"'Helvetica Neue', Helvetica, Arial, sans-serif"};var hoeflerText=exports.hoeflerText={label:"Hoefler Text",value:"'Hoefler Text', Garamond, Georgia, 'Times New Roman', Times, serif"};var lucidaGrande=exports.lucidaGrande={label:"Lucida Grande",value:"'Lucida Grande', 'Lucida Sans Unicode', Lucida, Verdana, Helvetica, Arial, sans-serif"};var myriad=exports.myriad={label:"Myriad",value:"Myriad, Helvetica, Arial, sans-serif"};var openSans=exports.openSans={label:"Open Sans",value:"'Open Sans', Helvetica, Arial, sans-serif"};var optima=exports.optima={label:"Optima",value:"Optima, 'Lucida Grande', 'Lucida Sans Unicode', Verdana, Helvetica, Arial, sans-serif"};var palatino=exports.palatino={label:"Palatino",value:"Palatino, 'Book Antiqua', Georgia, Garamond, 'Times New Roman', Times, serif"};var fonts=exports.fonts=[americanTypewriter,arial,baskerville,bookAntiqua,brushScript,chalkboard,didot,futura,gillSans,helveticaNeue,hoeflerText,lucidaGrande,myriad,openSans,optima,palatino]},1182:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(3367)},180:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setWorkpad=exports.removeColor=exports.addColor=exports.initializeWorkpad=exports.setWorkpadCSS=exports.setRefreshInterval=exports.setColors=exports.setWriteable=exports.setName=exports.sizeWorkpad=undefined;var _reduxActions=__webpack_require__(25);var _reduxThunks=__webpack_require__(1156);var _lodash=__webpack_require__(1);var _workpad=__webpack_require__(33);var _elements=__webpack_require__(61);var sizeWorkpad=exports.sizeWorkpad=(0,_reduxActions.createAction)("sizeWorkpad");var setName=exports.setName=(0,_reduxActions.createAction)("setName");var setWriteable=exports.setWriteable=(0,_reduxActions.createAction)("setWriteable");var setColors=exports.setColors=(0,_reduxActions.createAction)("setColors");var setRefreshInterval=exports.setRefreshInterval=(0,_reduxActions.createAction)("setRefreshInterval");var setWorkpadCSS=exports.setWorkpadCSS=(0,_reduxActions.createAction)("setWorkpadCSS");var initializeWorkpad=exports.initializeWorkpad=(0,_reduxThunks.createThunk)("initializeWorkpad",function(_ref){var dispatch=_ref.dispatch;dispatch((0,_elements.fetchAllRenderables)())});var addColor=exports.addColor=(0,_reduxThunks.createThunk)("addColor",function(_ref2,color){var dispatch=_ref2.dispatch,getState=_ref2.getState;var colors=(0,_workpad.getWorkpadColors)(getState()).slice(0);if(!(0,_lodash.includes)(colors,color)){colors.push(color)}dispatch(setColors(colors))});var removeColor=exports.removeColor=(0,_reduxThunks.createThunk)("removeColor",function(_ref3,color){var dispatch=_ref3.dispatch,getState=_ref3.getState;dispatch(setColors((0,_lodash.without)((0,_workpad.getWorkpadColors)(getState()),color)))});var setWorkpad=exports.setWorkpad=(0,_reduxThunks.createThunk)("setWorkpad",function(_ref4,workpad){var dispatch=_ref4.dispatch,type=_ref4.type;var _ref5=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref5$loadPages=_ref5.loadPages,loadPages=_ref5$loadPages===undefined?true:_ref5$loadPages;dispatch(setRefreshInterval(0));dispatch((0,_reduxActions.createAction)(type)(workpad));if(loadPages){dispatch(initializeWorkpad())}})},19:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(3154)},199:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.notify=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _notify=__webpack_require__(10);var _format_msg=__webpack_require__(829);var _lodash=__webpack_require__(1);function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}var getToast=function getToast(err){var opts=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var errData=(0,_lodash.get)(err,"response")||err;var errMsg=(0,_format_msg.formatMsg)(errData);var title=opts.title,rest=_objectWithoutProperties(opts,["title"]);var text=null;if(title){text=errMsg}return _extends({},rest,{title:title||errMsg,text:text})};var notify=exports.notify={error:function error(err,opts){_notify.toastNotifications.addDanger(getToast(err,opts))},warning:function warning(err,opts){_notify.toastNotifications.addWarning(getToast(err,opts))},info:function info(err,opts){_notify.toastNotifications.add(getToast(err,opts))},success:function success(err,opts){_notify.toastNotifications.addSuccess(getToast(err,opts))}}},228:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getId=getId;var _v=__webpack_require__(1053);var _v2=_interopRequireDefault(_v);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getId(type){return type+"-"+(0,_v2.default)()}},229:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var CANVAS_TYPE=exports.CANVAS_TYPE="canvas-workpad";var CANVAS_APP=exports.CANVAS_APP="canvas";var APP_ROUTE=exports.APP_ROUTE="/app/canvas";var APP_ROUTE_WORKPAD=exports.APP_ROUTE_WORKPAD=APP_ROUTE+"#/workpad";var API_ROUTE=exports.API_ROUTE="/api/canvas";var API_ROUTE_WORKPAD=exports.API_ROUTE_WORKPAD=API_ROUTE+"/workpad";var LOCALSTORAGE_PREFIX=exports.LOCALSTORAGE_PREFIX="kibana.canvas";var LOCALSTORAGE_CLIPBOARD=exports.LOCALSTORAGE_CLIPBOARD=LOCALSTORAGE_PREFIX+".clipboard";var LOCALSTORAGE_AUTOCOMPLETE_ENABLED=exports.LOCALSTORAGE_AUTOCOMPLETE_ENABLED=LOCALSTORAGE_PREFIX+".isAutocompleteEnabled";var LOCALSTORAGE_LASTPAGE=exports.LOCALSTORAGE_LASTPAGE="canvas:lastpage";var FETCH_TIMEOUT=exports.FETCH_TIMEOUT=3e4;var CANVAS_USAGE_TYPE=exports.CANVAS_USAGE_TYPE="canvas";var SECURITY_AUTH_MESSAGE=exports.SECURITY_AUTH_MESSAGE="Authentication failed";var DEFAULT_WORKPAD_CSS=exports.DEFAULT_WORKPAD_CSS=".canvasPage {\n\n}"},230:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.selectElement=exports.setFullscreen=exports.setCanUserWrite=undefined;var _reduxActions=__webpack_require__(25);var setCanUserWrite=exports.setCanUserWrite=(0,_reduxActions.createAction)("setCanUserWrite");var setFullscreen=exports.setFullscreen=(0,_reduxActions.createAction)("setFullscreen");var selectElement=exports.selectElement=(0,_reduxActions.createAction)("selectElement")},245:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var windowObj={};var getWindow=exports.getWindow=function getWindow(){return typeof window==="undefined"?windowObj:window}},265:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2666)},303:function(module,exports,__webpack_require__){"use strict";var dom=__webpack_require__(3210);var geometry=__webpack_require__(1147);var gestures=__webpack_require__(1148);var layout=__webpack_require__(3211);var matrix=__webpack_require__(498);var state=__webpack_require__(699);module.exports={dom:dom,geometry:geometry,gestures:gestures,layout:layout,matrix:matrix,state:state}},304:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getAssets=getAssets;exports.getAssetIds=getAssetIds;exports.getAssetById=getAssetById;var _lodash=__webpack_require__(1);var assetRoot="assets";function getAssets(state){return(0,_lodash.get)(state,assetRoot,{})}function getAssetIds(state){return Object.keys(getAssets(state))}function getAssetById(state,id){return(0,_lodash.get)(state,[assetRoot,id])}},305:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setPageTransition=exports.setPage=exports.stylePage=exports.removePage=exports.movePage=exports.gotoPage=exports.duplicatePage=exports.addPage=undefined;var _reduxActions=__webpack_require__(25);var addPage=exports.addPage=(0,_reduxActions.createAction)("addPage");var duplicatePage=exports.duplicatePage=(0,_reduxActions.createAction)("duplicatePage");var gotoPage=exports.gotoPage=(0,_reduxActions.createAction)("gotoPage");var movePage=exports.movePage=(0,_reduxActions.createAction)("movePage",function(id,position){return{id:id,position:position}});var removePage=exports.removePage=(0,_reduxActions.createAction)("removePage");var stylePage=exports.stylePage=(0,_reduxActions.createAction)("stylePage",function(pageId,style){return{pageId:pageId,style:style}});var setPage=exports.setPage=(0,_reduxActions.createAction)("setPage");var setPageTransition=exports.setPageTransition=(0,_reduxActions.createAction)("setPageTransition",function(pageId,transition){return{pageId:pageId,transition:transition}})},306:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.resetAssets=exports.setAssets=exports.removeAsset=exports.setAssetValue=exports.createAsset=undefined;var _reduxActions=__webpack_require__(25);var createAsset=exports.createAsset=(0,_reduxActions.createAction)("createAsset",function(type,value,id){return{type:type,value:value,id:id}});var setAssetValue=exports.setAssetValue=(0,_reduxActions.createAction)("setAssetContent",function(id,value){return{id:id,value:value}});var removeAsset=exports.removeAsset=(0,_reduxActions.createAction)("removeAsset");var setAssets=exports.setAssets=(0,_reduxActions.createAction)("setAssets");var resetAssets=exports.resetAssets=(0,_reduxActions.createAction)("resetAssets")},3201:function(module,exports,__webpack_require__){"use strict";__webpack_require__(75);__webpack_require__(76);__webpack_require__(77);__webpack_require__(78);__webpack_require__(79);__webpack_require__(80);__webpack_require__(81);__webpack_require__(82);__webpack_require__(83);__webpack_require__(84);__webpack_require__(85);__webpack_require__(86);__webpack_require__(87);__webpack_require__(88);__webpack_require__(89);__webpack_require__(90);__webpack_require__(91);__webpack_require__(92);__webpack_require__(93);__webpack_require__(94);__webpack_require__(95);__webpack_require__(96);__webpack_require__(97);__webpack_require__(98);__webpack_require__(99);__webpack_require__(100);__webpack_require__(101);__webpack_require__(102);__webpack_require__(103);__webpack_require__(104);__webpack_require__(105);__webpack_require__(106);__webpack_require__(107);__webpack_require__(108);__webpack_require__(109);__webpack_require__(110);__webpack_require__(111);__webpack_require__(112);__webpack_require__(113);__webpack_require__(114);__webpack_require__(115);__webpack_require__(116);__webpack_require__(117);__webpack_require__(118);__webpack_require__(119);__webpack_require__(120);__webpack_require__(121);__webpack_require__(122);__webpack_require__(123);__webpack_require__(124);__webpack_require__(125);__webpack_require__(126);__webpack_require__(127);__webpack_require__(128);__webpack_require__(129);__webpack_require__(130);__webpack_require__(131);__webpack_require__(132);__webpack_require__(133);__webpack_require__(134);__webpack_require__(135);__webpack_require__(136);__webpack_require__(137);__webpack_require__(138);__webpack_require__(139);__webpack_require__(140);__webpack_require__(141);__webpack_require__(142);__webpack_require__(143);__webpack_require__(144);__webpack_require__(145);__webpack_require__(146);__webpack_require__(147);__webpack_require__(148);__webpack_require__(149);__webpack_require__(150);__webpack_require__(151);__webpack_require__(152);__webpack_require__(153);__webpack_require__(154);__webpack_require__(155);__webpack_require__(156);__webpack_require__(157);__webpack_require__(158);__webpack_require__(159);__webpack_require__(160);__webpack_require__(161);__webpack_require__(162);__webpack_require__(163);__webpack_require__(164);__webpack_require__(165);__webpack_require__(166);__webpack_require__(167);__webpack_require__(168);__webpack_require__(169);__webpack_require__(170);__webpack_require__(171);__webpack_require__(172);__webpack_require__(173);__webpack_require__(185);var _i18n=__webpack_require__(9);var _kibanaCore__=__webpack_require__(174);var injectedMetadata=JSON.parse(document.querySelector("kbn-injected-metadata").getAttribute("data"));_i18n.i18n.init(injectedMetadata.legacyMetadata.translations);new _kibanaCore__.CoreSystem({injectedMetadata:injectedMetadata,rootDomElement:document.body,requireLegacyFiles:function requireLegacyFiles(){__webpack_require__(3202)}}).start()},3202:function(module,exports,__webpack_require__){"use strict";__webpack_require__(207);var _chrome=__webpack_require__(8);var _chrome2=_interopRequireDefault(_chrome);__webpack_require__(3203);__webpack_require__(3206);var _controllers=__webpack_require__(3407);__webpack_require__(647);__webpack_require__(670);__webpack_require__(671);__webpack_require__(673);__webpack_require__(328);__webpack_require__(3427);__webpack_require__(327);__webpack_require__(3428);__webpack_require__(3454);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_chrome2.default.setRootController("canvas",_controllers.CanvasRootController)},3203:function(module,exports,__webpack_require__){"use strict";__webpack_require__(3204);__webpack_require__(3205)},3204:function(module,exports,__webpack_require__){"use strict";var _modules=__webpack_require__(4);var app=_modules.uiModules.get("apps/canvas");app.config(function(stateManagementConfigProvider){stateManagementConfigProvider.disable()})},3205:function(module,exports,__webpack_require__){"use strict";var _modules=__webpack_require__(4);var app=_modules.uiModules.get("apps/canvas");app.config(function($locationProvider){$locationProvider.html5Mode({enabled:false,requireBase:false,rewriteLinks:false})})},3206:function(module,exports,__webpack_require__){"use strict";__webpack_require__(3207)},3207:function(module,exports,__webpack_require__){"use strict";var _modules=__webpack_require__(4);var _store=__webpack_require__(698);var _initial_state=__webpack_require__(3406);var app=_modules.uiModules.get("apps/canvas");app.service("canvasStore",function(kbnVersion,basePath,reportingBrowserType,serverFunctions){var initialState=(0,_initial_state.getInitialState)();initialState.app={kbnVersion:kbnVersion,basePath:basePath,reportingBrowserType:reportingBrowserType,serverFunctions:serverFunctions,ready:false};var store=(0,_store.createStore)(initialState);window.canvasStore=store;return store})},3208:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.middleware=undefined;var _redux=__webpack_require__(28);var _reduxThunk=__webpack_require__(264);var _reduxThunk2=_interopRequireDefault(_reduxThunk);var _get_window=__webpack_require__(245);var _aeroelastic=__webpack_require__(3209);var _es_persist=__webpack_require__(3216);var _fullscreen=__webpack_require__(3217);var _history=__webpack_require__(3219);var _in_flight=__webpack_require__(3393);var _workpad_update=__webpack_require__(3394);var _workpad_refresh=__webpack_require__(3395);var _app_ready=__webpack_require__(3396);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var middlewares=[(0,_redux.applyMiddleware)(_reduxThunk2.default,_es_persist.esPersistMiddleware,_history.historyMiddleware,_aeroelastic.aeroelastic,_fullscreen.fullscreen,_in_flight.inFlight,_app_ready.appReady,_workpad_update.workpadUpdate,_workpad_refresh.workpadRefresh)];if((0,_get_window.getWindow)().__REDUX_DEVTOOLS_EXTENSION__){middlewares.push((0,_get_window.getWindow)().__REDUX_DEVTOOLS_EXTENSION__())}var middleware=exports.middleware=_redux.compose.apply(undefined,middlewares)},3209:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.aeroelastic=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _recompose=__webpack_require__(19);var _aeroelastic_kibana=__webpack_require__(1146);var _matrix=__webpack_require__(498);var _functional=__webpack_require__(351);var _config=__webpack_require__(3213);var _config2=_interopRequireDefault(_config);var _elements=__webpack_require__(61);var _history=__webpack_require__(417);var _transient=__webpack_require__(230);var _pages2=__webpack_require__(305);var _app=__webpack_require__(500);var _workpad=__webpack_require__(180);var _workpad2=__webpack_require__(33);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var isGroupId=function isGroupId(id){return id.startsWith(_config2.default.groupName)};var elementToShape=function elementToShape(element,i){var position=element.position;var a=position.width/2;var b=position.height/2;var cx=position.left+a;var cy=position.top+b;var z=i;var angleRadians=-position.angle/180*Math.PI;var transformMatrix=_aeroelastic_kibana.aeroelastic.matrix.multiply(_aeroelastic_kibana.aeroelastic.matrix.translate(cx,cy,z),_aeroelastic_kibana.aeroelastic.matrix.rotateZ(angleRadians));var isGroup=isGroupId(element.id);var parent=element.position&&element.position.parent||null;return{id:element.id,type:isGroup?"group":"rectangleElement",subtype:isGroup?"persistentGroup":"",parent:parent,transformMatrix:transformMatrix,a:a,b:b}};var shapeToElement=function shapeToElement(shape){return{left:shape.transformMatrix[12]-shape.a,top:shape.transformMatrix[13]-shape.b,width:shape.a*2,height:shape.b*2,angle:Math.round((0,_matrix.matrixToAngle)(shape.transformMatrix)*180/Math.PI),parent:shape.parent||null,type:shape.type==="group"?"group":"element"}};var updateGlobalPositions=function updateGlobalPositions(setMultiplePositions,_ref,unsortedElements){var shapes=_ref.shapes,gestureEnd=_ref.gestureEnd;var ascending=function ascending(a,b){return a.id<b.id?-1:1};var relevant=function relevant(s){return s.type!=="annotation"&&s.subtype!=="adHocGroup"};var elements=unsortedElements.filter(relevant).sort(ascending);var repositionings=shapes.filter(relevant).sort(ascending).map(function(shape,i){var element=elements[i];var elemPos=element&&element.position;if(elemPos&&gestureEnd){var oldProps={left:elemPos.left,top:elemPos.top,width:elemPos.width,height:elemPos.height,angle:Math.round(elemPos.angle),type:elemPos.type,parent:elemPos.parent||null};var newProps=shapeToElement(shape);if(1/newProps.angle===-Infinity){newProps.angle=0}return(0,_recompose.shallowEqual)(oldProps,newProps)?null:{position:newProps,elementId:shape.id}}}).filter(_functional.identity);if(repositionings.length){setMultiplePositions(repositionings)}};var id=function id(element){return element.id};var deduped=function deduped(a){return a.filter(function(d,i){return a.indexOf(d)===i})};var idDuplicateCheck=function idDuplicateCheck(groups){if(deduped(groups.map(function(g){return g.id})).length!==groups.length){throw new Error("Duplicate element encountered")}};var missingParentCheck=function missingParentCheck(groups){var idMap=(0,_functional.arrayToMap)(groups.map(function(g){return g.id}));groups.forEach(function(g){if(g.parent&&!idMap[g.parent]){g.parent=null}})};var aeroelastic=exports.aeroelastic=function aeroelastic(_ref2){var dispatch=_ref2.dispatch,getState=_ref2.getState;var onChangeCallback=function onChangeCallback(_ref3){var state=_ref3.state;var nextScene=state.currentScene;if(!nextScene.gestureEnd){return}var page=(0,_workpad2.getSelectedPage)(getState());var elements=(0,_workpad2.getNodes)(getState(),page);var selectedElement=(0,_workpad2.getSelectedElement)(getState());var shapes=nextScene.shapes;var persistableGroups=shapes.filter(function(s){return s.subtype==="persistentGroup"});var persistedGroups=elements.filter(function(e){return isGroupId(e.id)});idDuplicateCheck(persistableGroups);idDuplicateCheck(persistedGroups);persistableGroups.forEach(function(g){if(!persistedGroups.find(function(p){if(!p.id){throw new Error("Element has no id")}return p.id===g.id})){var partialElement={id:g.id,filter:undefined,expression:'shape fill="rgba(255,255,255,0)" | render',position:_extends({},shapeToElement(g))};dispatch((0,_elements.addElement)(page,partialElement))}});var elementsToRemove=persistedGroups.filter(function(p){return!persistableGroups.find(function(g){return p.id===g.id})||!elements.find(function(e){return e.position.parent===p.id})});updateGlobalPositions(function(positions){return dispatch((0,_elements.setMultiplePositions)(positions.map(function(p){return _extends({},p,{pageId:page})})))},nextScene,elements);if(elementsToRemove.length){dispatch((0,_elements.removeElements)(elementsToRemove.map(function(e){return e.id}),page))}var selectedShape=nextScene.selectedPrimaryShapes[0];if(nextScene.selectedShapes.length===1&&!isGroupId(selectedShape)){if(selectedShape!==(selectedElement&&selectedElement.id)){dispatch((0,_transient.selectElement)(selectedShape))}}else{if(selectedElement){var shape=shapes.find(function(s){return s.id===selectedShape});if(!shape||shape.subtype!=="adHocGroup"){dispatch((0,_transient.selectElement)(null))}}}};var createStore=function createStore(page){return _aeroelastic_kibana.aeroelastic.createStore({shapeAdditions:[],primaryUpdate:null,currentScene:{shapes:[]},configuration:_config2.default},onChangeCallback,page)};var populateWithElements=function populateWithElements(page){var newShapes=(0,_workpad2.getNodes)(getState(),page).map(elementToShape).filter(function(d,i,a){return!isGroupId(d.id)||a.find(function(s){return s.parent===d.id})});idDuplicateCheck(newShapes);missingParentCheck(newShapes);return _aeroelastic_kibana.aeroelastic.commit(page,"restateShapesEvent",{newShapes:newShapes},{silent:true})};var selectShape=function selectShape(page,id){_aeroelastic_kibana.aeroelastic.commit(page,"shapeSelect",{shapes:[id]})};var unselectShape=function unselectShape(page){_aeroelastic_kibana.aeroelastic.commit(page,"shapeSelect",{shapes:[]})};return function(next){return function(action){var prevPage=(0,_workpad2.getSelectedPage)(getState());var prevElements=(0,_workpad2.getNodes)(getState(),prevPage);if(action.type===_workpad.setWorkpad.toString()){var pages=action.payload.pages;_aeroelastic_kibana.aeroelastic.clearStores();pages.map(function(p){return p.id}).forEach(createStore)}if(action.type===_history.restoreHistory.toString()){_aeroelastic_kibana.aeroelastic.clearStores();action.payload.workpad.pages.map(function(p){return p.id}).forEach(createStore)}if(action.type===_app.appReady.toString()){var _pages=(0,_workpad2.getPages)(getState());_aeroelastic_kibana.aeroelastic.clearStores();_pages.map(function(p){return p.id}).forEach(createStore)}var lastPageRemoved=false;if(action.type===_pages2.removePage.toString()){var preRemoveState=getState();if((0,_workpad2.getPages)(preRemoveState).length<=1){lastPageRemoved=true}_aeroelastic_kibana.aeroelastic.removeStore(action.payload)}next(action);switch(action.type){case _app.appReady.toString():case _history.restoreHistory.toString():case _workpad.setWorkpad.toString():(0,_workpad2.getPages)(getState()).map(function(p){return p.id}).forEach(populateWithElements);break;case _pages2.addPage.toString():case _pages2.duplicatePage.toString():var newPage=(0,_workpad2.getSelectedPage)(getState());createStore(newPage);if(action.type===_pages2.duplicatePage.toString()){dispatch((0,_elements.fetchAllRenderables)())}populateWithElements(newPage);break;case _pages2.removePage.toString():var postRemoveState=getState();if(lastPageRemoved){var freshPage=(0,_workpad2.getSelectedPage)(postRemoveState);createStore(freshPage)}break;case _transient.selectElement.toString():if(action.payload){selectShape(prevPage,action.payload)}else{unselectShape(prevPage)}break;case _elements.removeElements.toString():case _elements.addElement.toString():case _elements.insertNodes.toString():case _elements.elementLayer.toString():case _elements.setMultiplePositions.toString():var page=(0,_workpad2.getSelectedPage)(getState());var elements=(0,_workpad2.getNodes)(getState(),page);var shouldResetState=prevPage!==page||!(0,_recompose.shallowEqual)(prevElements.map(id),elements.map(id));if(shouldResetState){populateWithElements(page)}if(action.type!==_elements.setMultiplePositions.toString()&&action.type!==_elements.elementLayer.toString()){unselectShape(prevPage)}break}}}}},3210:function(module,exports,__webpack_require__){"use strict";var matrixToCSS=function matrixToCSS(transformMatrix){return transformMatrix?"matrix3d("+transformMatrix.join(",")+")":"translate3d(0,0,0)"};var px=function px(value){return value===0?"0":value+"px"};module.exports={matrixToCSS:matrixToCSS,px:px}},3211:function(module,exports,__webpack_require__){"use strict";var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var _require=__webpack_require__(699),select=_require.select;var _require2=__webpack_require__(228),getId=_require2.getId;var _require3=__webpack_require__(1148),actionEvent=_require3.actionEvent,dragging=_require3.dragging,dragVector=_require3.dragVector,cursorPosition=_require3.cursorPosition,gestureEnd=_require3.gestureEnd,metaHeld=_require3.metaHeld,mouseButton=_require3.mouseButton,mouseDowned=_require3.mouseDowned,mouseIsDown=_require3.mouseIsDown,optionHeld=_require3.optionHeld,shiftHeld=_require3.shiftHeld;var _require4=__webpack_require__(1147),shapesAt=_require4.shapesAt,landmarkPoint=_require4.landmarkPoint;var matrix=__webpack_require__(498);var matrix2d=__webpack_require__(3212);var _require5=__webpack_require__(351),arrayToMap=_require5.arrayToMap,disjunctiveUnion=_require5.disjunctiveUnion,identity=_require5.identity,flatten=_require5.flatten,mean=_require5.mean,not=_require5.not,removeDuplicates=_require5.removeDuplicates,shallowEqual=_require5.shallowEqual;var primaryUpdate=function primaryUpdate(state){return state.primaryUpdate};var scene=function scene(state){return state.currentScene};var configuration=function configuration(state){return state.configuration};var draggingShape=function draggingShape(_ref,hoveredShape,down,mouseDowned){var draggedShape=_ref.draggedShape,shapes=_ref.shapes;var dragInProgress=down&&shapes.reduce(function(prev,next){return prev||draggedShape&&next.id===draggedShape.id},false);var result=dragInProgress&&draggedShape||down&&mouseDowned&&hoveredShape;return result};var shapes=select(function(scene){return scene.shapes})(scene);var hoveredShapes=select(function(configuration,shapes,cursorPosition){return shapesAt(shapes.filter(function(s){return(s.type!=="annotation"||s.interactive)&&(configuration.intraGroupManipulation||!s.parent||s.type==="annotation")}),cursorPosition)})(configuration,shapes,cursorPosition);var depthIndex=0;var hoveredShape=select(function(hoveredShapes){return hoveredShapes.length?hoveredShapes[depthIndex]:null})(hoveredShapes);var draggedShape=select(draggingShape)(scene,hoveredShape,mouseIsDown,mouseDowned);var focusedShape=select(function(draggedShape,hoveredShape){return draggedShape||hoveredShape})(draggedShape,hoveredShape);var focusedShapes=select(function(shapes,focusedShape){return shapes.filter(function(shape){return focusedShape&&shape.id===focusedShape.id})})(shapes,focusedShape);var alterSnapGesture=select(function(metaHeld){return metaHeld?["relax"]:[]})(metaHeld);var multiselectModifier=shiftHeld;var initialTransformTuple={deltaX:0,deltaY:0,transform:null,cumulativeTransform:null};var mouseTransformGesturePrev=select(function(_ref2){var mouseTransformState=_ref2.mouseTransformState;return mouseTransformState||initialTransformTuple})(scene);var mouseTransformState=select(function(prev,dragging,_ref3){var x0=_ref3.x0,y0=_ref3.y0,x1=_ref3.x1,y1=_ref3.y1;if(dragging){var deltaX=x1-x0;var deltaY=y1-y0;var transform=matrix.translate(deltaX-prev.deltaX,deltaY-prev.deltaY,0);var cumulativeTransform=matrix.translate(deltaX,deltaY,0);return{deltaX:deltaX,deltaY:deltaY,transform:transform,cumulativeTransform:cumulativeTransform}}else{return initialTransformTuple}})(mouseTransformGesturePrev,dragging,dragVector);var mouseTransformGesture=select(function(tuple){return[tuple].filter(function(tuple){return tuple.transform}).map(function(_ref4){var transform=_ref4.transform,cumulativeTransform=_ref4.cumulativeTransform;return{transform:transform,cumulativeTransform:cumulativeTransform}})})(mouseTransformState);var transformGestures=mouseTransformGesture;var restateShapesEvent=select(function(action){if(!action||action.type!=="restateShapesEvent"){return null}var shapes=action.payload.newShapes;var local=function local(shape){if(!shape.parent){return shape.transformMatrix}return matrix.multiply(matrix.invert(shapes.find(function(s){return s.id===shape.parent}).transformMatrix),shape.transformMatrix)};var newShapes=shapes.map(function(s){return _extends({},s,{localTransformMatrix:local(s)})});return{newShapes:newShapes,uid:action.payload.uid}})(primaryUpdate);var directSelect=select(function(action){return action&&action.type==="shapeSelect"?action.payload:null})(primaryUpdate);var selectedShapeObjects=select(function(scene){return scene.selectedShapeObjects||[]})(scene);var singleSelect=function singleSelect(prev,configuration,hoveredShapes,metaHeld,uid){var down=true;var depthIndex=configuration.depthSelect&&metaHeld?(prev.depthIndex+(down&&!prev.down?1:0))%hoveredShapes.length:0;return{shapes:hoveredShapes.length?[hoveredShapes[depthIndex]]:[],uid:uid,depthIndex:hoveredShapes.length?depthIndex:0,down:down}};var multiSelect=function multiSelect(prev,configuration,hoveredShapes,metaHeld,uid,selectedShapeObjects){var shapes=hoveredShapes.length>0?disjunctiveUnion(function(shape){return shape.id},selectedShapeObjects,hoveredShapes.slice(0,1)):[];return{shapes:shapes,uid:uid,depthIndex:0,down:false}};var selectedShapesPrev=select(function(scene){return scene.selectionState||{shapes:[],uid:null,depthIndex:0,down:false}})(scene);var reselectShapes=function reselectShapes(allShapes,shapes){return shapes.map(function(id){return allShapes.find(function(shape){return shape.id===id})})};var contentShape=function contentShape(allShapes){return function(shape){return shape.type==="annotation"?contentShape(allShapes)(allShapes.find(function(s){return s.id===shape.parent})):shape}};var contentShapes=function contentShapes(allShapes,shapes){var idMap=arrayToMap(allShapes.map(function(shape){return shape.id}));return shapes.filter(function(shape){return idMap[shape.id]}).map(contentShape(allShapes))};var selectionState=select(function(prev,configuration,selectedShapeObjects,hoveredShapes,_ref5,metaHeld,multiselect,directSelect,allShapes){var down=_ref5.down,uid=_ref5.uid;var uidUnchanged=uid===prev.uid;var mouseButtonUp=!down;var updateFromDirectSelect=directSelect&&directSelect.shapes&&!shallowEqual(directSelect.shapes,selectedShapeObjects.map(function(shape){return shape.id}));if(updateFromDirectSelect){return{shapes:reselectShapes(allShapes,directSelect.shapes),uid:directSelect.uid,depthIndex:prev.depthIndex,down:prev.down}}if(selectedShapeObjects){prev.shapes=selectedShapeObjects.slice()}if(mouseButtonUp||uidUnchanged&&!directSelect){return _extends({},prev,{down:down,uid:uid,metaHeld:metaHeld})}var selectFunction=configuration.singleSelect||!multiselect?singleSelect:multiSelect;return selectFunction(prev,configuration,hoveredShapes,metaHeld,uid,selectedShapeObjects)})(selectedShapesPrev,configuration,selectedShapeObjects,hoveredShapes,mouseButton,metaHeld,multiselectModifier,directSelect,shapes);var selectedShapes=select(function(selectionTuple){return selectionTuple.shapes})(selectionState);var selectedShapeIds=select(function(shapes){return shapes.map(function(shape){return shape.id})})(selectedShapes);var primaryShape=function primaryShape(shape){return shape.type==="annotation"?shape.parent:shape.id};var selectedPrimaryShapeIds=select(function(shapes){return shapes.map(primaryShape)})(selectedShapes);var rotationManipulation=function rotationManipulation(configuration){return function(_ref6){var shape=_ref6.shape,directShape=_ref6.directShape,_ref6$cursorPosition=_ref6.cursorPosition,x=_ref6$cursorPosition.x,y=_ref6$cursorPosition.y,alterSnapGesture=_ref6.alterSnapGesture;if(!shape||!directShape){return{transforms:[],shapes:[]}}var center=shape.transformMatrix;var centerPosition=matrix.mvMultiply(center,matrix.ORIGIN);var vector=matrix.mvMultiply(matrix.multiply(center,directShape.localTransformMatrix),matrix.ORIGIN);var oldAngle=Math.atan2(centerPosition[1]-vector[1],centerPosition[0]-vector[0]);var newAngle=Math.atan2(centerPosition[1]-y,centerPosition[0]-x);var closest45deg=Math.round(newAngle/(Math.PI/4))*Math.PI/4;var radius=Math.sqrt(Math.pow(centerPosition[0]-x,2)+Math.pow(centerPosition[1]-y,2));var closest45degPosition=[Math.cos(closest45deg)*radius,Math.sin(closest45deg)*radius];var pixelDifference=Math.sqrt(Math.pow(closest45degPosition[0]-(centerPosition[0]-x),2)+Math.pow(closest45degPosition[1]-(centerPosition[1]-y),2));var relaxed=alterSnapGesture.indexOf("relax")!==-1;var newSnappedAngle=pixelDifference<configuration.rotateSnapInPixels&&!relaxed?closest45deg:newAngle;var result=matrix.rotateZ(oldAngle-newSnappedAngle);return{transforms:[result],shapes:[shape.id]}}};var resizeMultiplierHorizontal={left:-1,center:0,right:1};var resizeMultiplierVertical={top:-1,center:0,bottom:1};var xNames={"-1":"left",0:"center",1:"right"};var yNames={"-1":"top",0:"center",1:"bottom"};var minimumSize=function minimumSize(min,_ref7,vector){var a=_ref7.a,b=_ref7.b,baseAB=_ref7.baseAB;return[Math.max(baseAB?min-baseAB[0]:min-a,vector[0]),Math.max(baseAB?min-baseAB[1]:min-b,vector[1])]};var centeredResizeManipulation=function centeredResizeManipulation(configuration){return function(_ref8){var gesture=_ref8.gesture,shape=_ref8.shape,directShape=_ref8.directShape;var transform=gesture.cumulativeTransform;if(!shape||!directShape){return{transforms:[],shapes:[]}}var vector=matrix.mvMultiply(matrix.multiply(matrix.invert(matrix.compositeComponent(shape.localTransformMatrix)),transform),matrix.ORIGIN);var orientationMask=[resizeMultiplierHorizontal[directShape.horizontalPosition],resizeMultiplierVertical[directShape.verticalPosition],0];var orientedVector=matrix2d.componentProduct(vector,orientationMask);var cappedOrientedVector=minimumSize(configuration.minimumElementSize,shape,orientedVector);return{cumulativeTransforms:[],cumulativeSizes:[gesture.sizes||matrix2d.translate.apply(matrix2d,_toConsumableArray(cappedOrientedVector))],shapes:[shape.id]}}};var asymmetricResizeManipulation=function asymmetricResizeManipulation(configuration){return function(_ref9){var gesture=_ref9.gesture,shape=_ref9.shape,directShape=_ref9.directShape;var transform=gesture.cumulativeTransform;if(!shape||!directShape){return{transforms:[],shapes:[]}}var compositeComponent=matrix.compositeComponent(shape.localTransformMatrix);var inv=matrix.invert(compositeComponent);var vector=matrix.mvMultiply(matrix.multiply(inv,transform),matrix.ORIGIN);var orientationMask=[resizeMultiplierHorizontal[directShape.horizontalPosition]/2,resizeMultiplierVertical[directShape.verticalPosition]/2,0];var orientedVector=matrix2d.componentProduct(vector,orientationMask);var cappedOrientedVector=minimumSize(configuration.minimumElementSize,shape,orientedVector);var antiRotatedVector=matrix.mvMultiply(matrix.multiply(compositeComponent,matrix.scale(resizeMultiplierHorizontal[directShape.horizontalPosition],resizeMultiplierVertical[directShape.verticalPosition],1),matrix.translate(cappedOrientedVector[0],cappedOrientedVector[1],0)),matrix.ORIGIN);var sizeMatrix=gesture.sizes||matrix2d.translate.apply(matrix2d,_toConsumableArray(cappedOrientedVector));return{cumulativeTransforms:[matrix.translate(antiRotatedVector[0],antiRotatedVector[1],0)],cumulativeSizes:[sizeMatrix],shapes:[shape.id]}}};var directShapeTranslateManipulation=function directShapeTranslateManipulation(cumulativeTransforms,directShapes){var shapes=directShapes.map(function(shape){return shape.type!=="annotation"&&shape.id}).filter(identity);return[{cumulativeTransforms:cumulativeTransforms,shapes:shapes}]};var rotationAnnotationManipulation=function rotationAnnotationManipulation(configuration,directTransforms,directShapes,allShapes,cursorPosition,alterSnapGesture){var shapeIds=directShapes.map(function(shape){return shape.type==="annotation"&&shape.subtype===configuration.rotationHandleName&&shape.parent});var shapes=shapeIds.map(function(id){return id&&allShapes.find(function(shape){return shape.id===id})});var tuples=flatten(shapes.map(function(shape,i){return directTransforms.map(function(transform){return{transform:transform,shape:shape,directShape:directShapes[i],cursorPosition:cursorPosition,alterSnapGesture:alterSnapGesture}})}));return tuples.map(rotationManipulation(configuration))};var resizeAnnotationManipulation=function resizeAnnotationManipulation(configuration,transformGestures,directShapes,allShapes,manipulator){var shapeIds=directShapes.map(function(shape){return shape.type==="annotation"&&shape.subtype===configuration.resizeHandleName&&shape.parent});var shapes=shapeIds.map(function(id){return id&&allShapes.find(function(shape){return shape.id===id})});var tuples=flatten(shapes.map(function(shape,i){return transformGestures.map(function(gesture){return{gesture:gesture,shape:shape,directShape:directShapes[i]}})}));return tuples.map(manipulator)};var symmetricManipulation=optionHeld;var resizeManipulator=select(function(configuration,toggle){return(toggle?centeredResizeManipulation:asymmetricResizeManipulation)(configuration)})(configuration,symmetricManipulation);var transformIntents=select(function(configuration,transformGestures,directShapes,shapes,cursorPosition,alterSnapGesture,manipulator){return[].concat(_toConsumableArray(directShapeTranslateManipulation(transformGestures.map(function(g){return g.cumulativeTransform}),directShapes)),_toConsumableArray(rotationAnnotationManipulation(configuration,transformGestures.map(function(g){return g.transform}),directShapes,shapes,cursorPosition,alterSnapGesture)),_toConsumableArray(resizeAnnotationManipulation(configuration,transformGestures,directShapes,shapes,manipulator)))})(configuration,transformGestures,selectedShapes,shapes,cursorPosition,alterSnapGesture,resizeManipulator);var fromScreen=function fromScreen(currentTransform){return function(transform){var isTranslate=transform[12]!==0||transform[13]!==0;if(isTranslate){var composite=matrix.compositeComponent(currentTransform);var inverse=matrix.invert(composite);var result=matrix.translateComponent(matrix.multiply(inverse,transform));return result}else{return transform}}};var shapeApplyLocalTransforms=function shapeApplyLocalTransforms(intents){return function(shape){var transformIntents=flatten(intents.map(function(intent){return intent.transforms&&intent.transforms.length&&intent.shapes.find(function(id){return id===shape.id})&&intent.transforms.map(fromScreen(shape.localTransformMatrix))}).filter(identity));var sizeIntents=flatten(intents.map(function(intent){return intent.sizes&&intent.sizes.length&&intent.shapes.find(function(id){return id===shape.id})&&intent.sizes}).filter(identity));var cumulativeTransformIntents=flatten(intents.map(function(intent){return intent.cumulativeTransforms&&intent.cumulativeTransforms.length&&intent.shapes.find(function(id){return id===shape.id})&&intent.cumulativeTransforms.map(fromScreen(shape.localTransformMatrix))}).filter(identity));var cumulativeSizeIntents=flatten(intents.map(function(intent){return intent.cumulativeSizes&&intent.cumulativeSizes.length&&intent.shapes.find(function(id){return id===shape.id})&&intent.cumulativeSizes}).filter(identity));var baselineLocalTransformMatrix=matrix.multiply.apply(matrix,[shape.baselineLocalTransformMatrix||shape.localTransformMatrix].concat(_toConsumableArray(transformIntents)));var cumulativeTransformIntentMatrix=matrix.multiply.apply(matrix,_toConsumableArray(cumulativeTransformIntents));var baselineSizeMatrix=matrix2d.multiply.apply(matrix2d,_toConsumableArray(sizeIntents))||matrix2d.UNITMATRIX;var localTransformMatrix=cumulativeTransformIntents.length?matrix.multiply(baselineLocalTransformMatrix,cumulativeTransformIntentMatrix):baselineLocalTransformMatrix;var cumulativeSizeIntentMatrix=matrix2d.multiply.apply(matrix2d,_toConsumableArray(cumulativeSizeIntents));var sizeVector=matrix2d.mvMultiply(cumulativeSizeIntents.length?matrix2d.multiply(baselineSizeMatrix,cumulativeSizeIntentMatrix):baselineSizeMatrix,shape.baseAB?[].concat(_toConsumableArray(shape.baseAB),[1]):[shape.a,shape.b,1]);var absorbChanges=!transformIntents.length&&!sizeIntents.length&&!cumulativeTransformIntents.length&&!cumulativeSizeIntents.length;return _extends({},shape,{baselineLocalTransformMatrix:absorbChanges?null:baselineLocalTransformMatrix,baselineSizeMatrix:absorbChanges?null:baselineSizeMatrix,localTransformMatrix:absorbChanges?shape.localTransformMatrix:localTransformMatrix,a:absorbChanges?shape.a:sizeVector[0],b:absorbChanges?shape.b:sizeVector[1],baseAB:absorbChanges?null:shape.baseAB||[shape.a,shape.b]})}};var applyLocalTransforms=function applyLocalTransforms(shapes,transformIntents){return shapes.map(shapeApplyLocalTransforms(transformIntents))};var getUpstreamTransforms=function getUpstreamTransforms(shapes,shape){return shape.parent?getUpstreamTransforms(shapes,shapes.find(function(s){return s.id===shape.parent})).concat([shape.localTransformMatrix]):[shape.localTransformMatrix]};var getUpstreams=function getUpstreams(shapes,shape){return shape.parent?getUpstreams(shapes,shapes.find(function(s){return s.id===shape.parent})).concat([shape]):[shape]};var snappedA=function snappedA(shape){return shape.a+(shape.snapResizeVector?shape.snapResizeVector[0]:0)};var snappedB=function snappedB(shape){return shape.b+(shape.snapResizeVector?shape.snapResizeVector[1]:0)};var cascadeUnsnappedTransforms=function cascadeUnsnappedTransforms(shapes,shape){if(!shape.parent){return shape.localTransformMatrix}var upstreams=getUpstreams(shapes,shape);var upstreamTransforms=upstreams.map(function(shape){return shape.localTransformMatrix});var cascadedTransforms=matrix.reduceTransforms(upstreamTransforms);return cascadedTransforms};var cascadeTransforms=function cascadeTransforms(shapes,shape){var cascade=function cascade(s){return s.snapDeltaMatrix?matrix.multiply(s.localTransformMatrix,s.snapDeltaMatrix):s.localTransformMatrix};if(!shape.parent){return cascade(shape)}var upstreams=getUpstreams(shapes,shape);var upstreamTransforms=upstreams.map(cascade);var cascadedTransforms=matrix.reduceTransforms(upstreamTransforms);return cascadedTransforms};var shapeCascadeProperties=function shapeCascadeProperties(shapes){return function(shape){return _extends({},shape,{transformMatrix:cascadeTransforms(shapes,shape),width:2*snappedA(shape),height:2*snappedB(shape)})}};var cascadeProperties=function cascadeProperties(shapes){return shapes.map(shapeCascadeProperties(shapes))};var nextShapes=select(function(preexistingShapes,restated){if(restated&&restated.newShapes){return restated.newShapes}return preexistingShapes})(shapes,restateShapesEvent);var transformedShapes=select(applyLocalTransforms)(nextShapes,transformIntents);var alignmentGuides=function alignmentGuides(configuration,shapes,guidedShapes,draggedShape){var result={};var counter=0;var extremeHorizontal=resizeMultiplierHorizontal[draggedShape.horizontalPosition];var extremeVertical=resizeMultiplierVertical[draggedShape.verticalPosition];for(var i=0;i<guidedShapes.length;i++){var d=guidedShapes[i];if(d.type==="annotation"){continue}for(var j=0;j<shapes.length;j++){var referenceShape=shapes[j];if(referenceShape.type==="annotation"){continue}if(!configuration.intraGroupManipulation&&referenceShape.parent){continue}if(configuration.intraGroupSnapOnly&&d.parent!==referenceShape.parent&&d.parent!==referenceShape.id){continue}var s=d.id===referenceShape.id?_extends({},d,{localTransformMatrix:d.baselineLocalTransformMatrix||d.localTransformMatrix,a:d.baseAB?d.baseAB[0]:d.a,b:d.baseAB?d.baseAB[1]:d.b}):referenceShape;for(var k=-1;k<2;k++){for(var l=-1;l<2;l++){if(k&&!l||!k&&l){continue}if(draggedShape.subtype===configuration.resizeHandleName&&!(extremeHorizontal===k&&extremeVertical===l||extremeHorizontal===0&&k!==0&&extremeVertical===l||extremeVertical===0&&l!==0&&extremeHorizontal===k)){continue}var D=landmarkPoint(d.a,d.b,cascadeUnsnappedTransforms(shapes,d),k,l);for(var m=-1;m<2;m++){for(var n=-1;n<2;n++){if(m&&!n||!m&&n){continue}var S=landmarkPoint(s.a,s.b,cascadeUnsnappedTransforms(shapes,s),m,n);for(var dim=0;dim<2;dim++){var orthogonalDimension=1-dim;var dd=D[dim];var ss=S[dim];var key=k+"|"+l+"|"+dim;var signedDistance=dd-ss;var distance=Math.abs(signedDistance);var currentClosest=result[key];if(Math.round(distance)<=configuration.guideDistance&&(!currentClosest||distance<=currentClosest.distance)){var orthogonalValues=[D[orthogonalDimension],S[orthogonalDimension]].concat(_toConsumableArray(currentClosest?[currentClosest.lowPoint,currentClosest.highPoint]:[]));var lowPoint=Math.min.apply(Math,_toConsumableArray(orthogonalValues));var highPoint=Math.max.apply(Math,_toConsumableArray(orthogonalValues));var midPoint=(lowPoint+highPoint)/2;var radius=midPoint-lowPoint;result[key]={id:counter++,localTransformMatrix:matrix.translate(dim?midPoint:ss,dim?ss:midPoint,configuration.atopZ),a:dim?radius:.5,b:dim?.5:radius,lowPoint:lowPoint,highPoint:highPoint,distance:distance,signedDistance:signedDistance,dimension:dim?"vertical":"horizontal",constrained:d.id,constrainer:s.id}}}}}}}}}return Object.values(result)};var isHorizontal=function isHorizontal(constraint){return constraint.dimension==="horizontal"};var isVertical=function isVertical(constraint){return constraint.dimension==="vertical"};var closestConstraint=function closestConstraint(){var prev=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{distance:Infinity};var next=arguments[1];return next.distance<prev.distance?{constraint:next,distance:next.distance}:prev};var directionalConstraint=function directionalConstraint(constraints,filterFun){var directionalConstraints=constraints.filter(filterFun);var closest=directionalConstraints.reduce(closestConstraint,undefined);return closest&&closest.constraint};var draggedPrimaryShape=select(function(shapes,draggedShape){return draggedShape&&shapes.find(function(shape){return shape.id===primaryShape(draggedShape)})})(shapes,draggedShape);var alignmentGuideAnnotations=select(function(configuration,shapes,draggedPrimaryShape,draggedShape){var guidedShapes=draggedPrimaryShape?[shapes.find(function(s){return s.id===draggedPrimaryShape.id})].filter(identity):[];return guidedShapes.length?alignmentGuides(configuration,shapes,guidedShapes,draggedShape).map(function(shape){return _extends({},shape,{id:configuration.alignmentGuideName+"_"+shape.id,type:"annotation",subtype:configuration.alignmentGuideName,interactive:false,backgroundColor:"magenta",parent:null})}):[]})(configuration,transformedShapes,draggedPrimaryShape,draggedShape);var hoverAnnotations=select(function(configuration,hoveredShape,selectedPrimaryShapeIds,draggedShape){return hoveredShape&&hoveredShape.type!=="annotation"&&selectedPrimaryShapeIds.indexOf(hoveredShape.id)===-1&&!draggedShape?[_extends({},hoveredShape,{id:configuration.hoverAnnotationName+"_"+hoveredShape.id,type:"annotation",subtype:configuration.hoverAnnotationName,interactive:false,localTransformMatrix:matrix.multiply(hoveredShape.localTransformMatrix,matrix.translate(0,0,configuration.hoverLift)),parent:null})]:[]})(configuration,hoveredShape,selectedPrimaryShapeIds,draggedShape);var rotationAnnotation=function rotationAnnotation(configuration,shapes,selectedShapes,shape,i){var foundShape=shapes.find(function(s){return shape.id===s.id});if(!foundShape){return false}if(foundShape.type==="annotation"){return rotationAnnotation(configuration,shapes,selectedShapes,shapes.find(function(s){return foundShape.parent===s.id}),i)}var b=snappedB(foundShape);var centerTop=matrix.translate(0,-b,0);var pixelOffset=matrix.translate(0,-configuration.rotateAnnotationOffset,configuration.atopZ);var transform=matrix.multiply(centerTop,pixelOffset);return{id:configuration.rotationHandleName+"_"+i,type:"annotation",subtype:configuration.rotationHandleName,interactive:true,parent:foundShape.id,localTransformMatrix:transform,backgroundColor:"rgb(0,0,255,0.3)",a:configuration.rotationHandleSize,b:configuration.rotationHandleSize}};var resizePointAnnotations=function resizePointAnnotations(configuration,parent,a,b){return function(_ref10){var _ref11=_slicedToArray(_ref10,3),x=_ref11[0],y=_ref11[1],cursorAngle=_ref11[2];var markerPlace=matrix.translate(x*a,y*b,configuration.resizeAnnotationOffsetZ);var pixelOffset=matrix.translate(-x*configuration.resizeAnnotationOffset,-y*configuration.resizeAnnotationOffset,configuration.atopZ+10);var transform=matrix.multiply(markerPlace,pixelOffset);var xName=xNames[x];var yName=yNames[y];return{id:[configuration.resizeHandleName,xName,yName,parent].join("_"),type:"annotation",subtype:configuration.resizeHandleName,horizontalPosition:xName,verticalPosition:yName,cursorAngle:cursorAngle,interactive:true,parent:parent.id,localTransformMatrix:transform,backgroundColor:"rgb(0,255,0,1)",a:configuration.resizeAnnotationSize,b:configuration.resizeAnnotationSize}}};var resizeEdgeAnnotations=function resizeEdgeAnnotations(configuration,parent,a,b){return function(_ref12){var _ref13=_slicedToArray(_ref12,2),_ref13$=_slicedToArray(_ref13[0],2),x0=_ref13$[0],y0=_ref13$[1],_ref13$2=_slicedToArray(_ref13[1],2),x1=_ref13$2[0],y1=_ref13$2[1];var x=a*mean(x0,x1);var y=b*mean(y0,y1);var markerPlace=matrix.translate(x,y,configuration.atopZ-10);var transform=markerPlace;var horizontal=y0===y1;var length=horizontal?a*Math.abs(x1-x0):b*Math.abs(y1-y0);var sectionHalfLength=Math.max(0,length/2-configuration.resizeAnnotationConnectorOffset);var width=.5;return{id:[configuration.resizeConnectorName,xNames[x0],yNames[y0],xNames[x1],yNames[y1],parent].join("_"),type:"annotation",subtype:configuration.resizeConnectorName,interactive:true,parent:parent.id,localTransformMatrix:transform,backgroundColor:configuration.devColor,a:horizontal?sectionHalfLength:width,b:horizontal?width:sectionHalfLength}}};var connectorVertices=[[[-1,-1],[0,-1]],[[0,-1],[1,-1]],[[1,-1],[1,0]],[[1,0],[1,1]],[[1,1],[0,1]],[[0,1],[-1,1]],[[-1,1],[-1,0]],[[-1,0],[-1,-1]]];var cornerVertices=[[-1,-1],[1,-1],[-1,1],[1,1]];var groupedShape=function groupedShape(properShape){return function(shape){return shape.parent===properShape.id}};var magic=function magic(configuration,shape,shapes){var epsilon=configuration.rotationEpsilon;var integralOf=Math.PI*2;var isIntegerMultiple=function isIntegerMultiple(shape){var zRotation=matrix.matrixToAngle(shape.localTransformMatrix);var ratio=zRotation/integralOf;return Math.abs(Math.round(ratio)-ratio)<epsilon};function recurse(shape){return shapes.filter(groupedShape(shape)).every(resizableChild)}function resizableChild(shape){return isIntegerMultiple(shape)&&recurse(shape)}return recurse(shape)};function resizeAnnotation(configuration,shapes,selectedShapes,shape){var foundShape=shapes.find(function(s){return shape.id===s.id});var properShape=foundShape&&(foundShape.subtype===configuration.resizeHandleName?shapes.find(function(s){return shape.parent===s.id}):foundShape);if(!foundShape){return[]}if(foundShape.subtype===configuration.resizeHandleName){var result=foundShape.interactive?resizeAnnotationsFunction(configuration,{shapes:shapes,selectedShapes:[shapes.find(function(s){return shape.parent===s.id})]}):[];return result}if(foundShape.type==="annotation"){return resizeAnnotation(configuration,shapes,selectedShapes,shapes.find(function(s){return foundShape.parent===s.id}))}var a=snappedA(properShape);var b=snappedB(properShape);var allowResize=properShape.type!=="group"||configuration.groupResize&&magic(configuration,properShape,shapes.filter(function(s){return s.type!=="annotation"}));var resizeVertices=allowResize?[[-1,-1,315],[1,-1,45],[1,1,135],[-1,1,225],[0,-1,0],[1,0,90],[0,1,180],[-1,0,270]]:[];var resizePoints=resizeVertices.map(resizePointAnnotations(configuration,shape,a,b));var connectors=connectorVertices.map(resizeEdgeAnnotations(configuration,shape,a,b));return[].concat(_toConsumableArray(resizePoints),_toConsumableArray(connectors))}function resizeAnnotationsFunction(configuration,_ref14){var shapes=_ref14.shapes,selectedShapes=_ref14.selectedShapes;var shapesToAnnotate=selectedShapes;return flatten(shapesToAnnotate.map(function(shape){return resizeAnnotation(configuration,shapes,selectedShapes,shape)}).filter(identity))}var crystallizeConstraint=function crystallizeConstraint(shape){var result=_extends({},shape);if(shape.snapDeltaMatrix){result.localTransformMatrix=matrix.multiply(shape.localTransformMatrix,shape.snapDeltaMatrix);result.snapDeltaMatrix=null}if(shape.snapResizeVector){result.a=snappedA(shape);result.b=snappedB(shape);result.snapResizeVector=null}return result};var translateShapeSnap=function translateShapeSnap(horizontalConstraint,verticalConstraint,draggedElement){return function(shape){var constrainedX=horizontalConstraint&&horizontalConstraint.constrained===shape.id;var constrainedY=verticalConstraint&&verticalConstraint.constrained===shape.id;var snapOffsetX=constrainedX?-horizontalConstraint.signedDistance:0;var snapOffsetY=constrainedY?-verticalConstraint.signedDistance:0;if(constrainedX||constrainedY){if(!snapOffsetX&&!snapOffsetY){return shape}var snapOffset=matrix.translateComponent(matrix.multiply(matrix.rotateZ(matrix.matrixToAngle(draggedElement.localTransformMatrix)),matrix.translate(snapOffsetX,snapOffsetY,0)));return _extends({},shape,{snapDeltaMatrix:snapOffset})}else if(shape.snapDeltaMatrix||shape.snapResizeVector){return crystallizeConstraint(shape)}else{return shape}}};var resizeShapeSnap=function resizeShapeSnap(horizontalConstraint,verticalConstraint,draggedElement,symmetric,horizontalPosition,verticalPosition){return function(shape){var constrainedShape=draggedElement&&shape.id===draggedElement.id;var constrainedX=horizontalConstraint&&horizontalConstraint.constrained===shape.id;var constrainedY=verticalConstraint&&verticalConstraint.constrained===shape.id;var snapOffsetX=constrainedX?horizontalConstraint.signedDistance:0;var snapOffsetY=constrainedY?-verticalConstraint.signedDistance:0;if(constrainedX||constrainedY){var multiplier=symmetric?1:.5;var angle=matrix.matrixToAngle(draggedElement.localTransformMatrix);var horizontalSign=-resizeMultiplierHorizontal[horizontalPosition];var verticalSign=resizeMultiplierVertical[verticalPosition];var sin=Math.sin(angle);var cos=Math.cos(angle);var snapOffsetA=horizontalSign*(cos*snapOffsetX-sin*snapOffsetY);var snapOffsetB=verticalSign*(sin*snapOffsetX+cos*snapOffsetY);var snapTranslateOffset=matrix.translateComponent(matrix.multiply(matrix.rotateZ(angle),matrix.translate((1-multiplier)*-snapOffsetX,(1-multiplier)*snapOffsetY,0)));var snapSizeOffset=[multiplier*snapOffsetA,multiplier*snapOffsetB];return _extends({},shape,{snapDeltaMatrix:snapTranslateOffset,snapResizeVector:snapSizeOffset})}else if(constrainedShape){return _extends({},shape,{snapDeltaMatrix:null,snapResizeVector:null})}else{return crystallizeConstraint(shape)}}};var snappedShapes=select(function(configuration,shapes,draggedShape,draggedElement,alignmentGuideAnnotations,alterSnapGesture,symmetricManipulation){var contentShapes=shapes.filter(function(shape){return shape.type!=="annotation"});var subtype=draggedShape&&draggedShape.subtype;if(subtype&&[configuration.resizeHandleName,configuration.adHocGroupName,configuration.persistentGroupName].indexOf(subtype)===-1){return contentShapes}var constraints=alignmentGuideAnnotations;var relaxed=alterSnapGesture.indexOf("relax")!==-1;var constrained=configuration.snapConstraint&&!relaxed;var horizontalConstraint=constrained&&directionalConstraint(constraints,isHorizontal);var verticalConstraint=constrained&&directionalConstraint(constraints,isVertical);var snapper=subtype===configuration.resizeHandleName?resizeShapeSnap(horizontalConstraint,verticalConstraint,draggedElement,symmetricManipulation,draggedShape.horizontalPosition,draggedShape.verticalPosition):translateShapeSnap(horizontalConstraint,verticalConstraint,draggedElement);return contentShapes.map(snapper)})(configuration,transformedShapes,draggedShape,draggedPrimaryShape,alignmentGuideAnnotations,alterSnapGesture,symmetricManipulation);var constrainedShapesWithPreexistingAnnotations=select(function(snapped,transformed){return snapped.concat(transformed.filter(function(s){return s.type==="annotation"}))})(snappedShapes,transformedShapes);var extend=function extend(_ref15,_ref16,_ref17){var _ref20=_slicedToArray(_ref15,2),_ref20$=_slicedToArray(_ref20[0],2),xMin=_ref20$[0],yMin=_ref20$[1],_ref20$2=_slicedToArray(_ref20[1],2),xMax=_ref20$2[0],yMax=_ref20$2[1];var _ref19=_slicedToArray(_ref16,2),x0=_ref19[0],y0=_ref19[1];var _ref18=_slicedToArray(_ref17,2),x1=_ref18[0],y1=_ref18[1];return[[Math.min(xMin,x0,x1),Math.min(yMin,y0,y1)],[Math.max(xMax,x0,x1),Math.max(yMax,y0,y1)]]};var getAABB=function getAABB(shapes){return shapes.reduce(function(prev,shape){var shapeBounds=cornerVertices.reduce(function(prev,xyVertex){var cornerPoint=matrix.normalize(matrix.mvMultiply(shape.transformMatrix,[shape.a*xyVertex[0],shape.b*xyVertex[1],0,1]));return extend(prev,cornerPoint,cornerPoint)},prev);return extend.apply(undefined,[prev].concat(_toConsumableArray(shapeBounds)))},[[Infinity,Infinity],[-Infinity,-Infinity]])};var projectAABB=function projectAABB(_ref21){var _ref22=_slicedToArray(_ref21,2),_ref22$=_slicedToArray(_ref22[0],2),xMin=_ref22$[0],yMin=_ref22$[1],_ref22$2=_slicedToArray(_ref22[1],2),xMax=_ref22$2[0],yMax=_ref22$2[1];var a=(xMax-xMin)/2;var b=(yMax-yMin)/2;var xTranslate=xMin+a;var yTranslate=yMin+b;var zTranslate=0;var localTransformMatrix=matrix.translate(xTranslate,yTranslate,zTranslate);var rigTransform=matrix.translate(-xTranslate,-yTranslate,-zTranslate);return{a:a,b:b,localTransformMatrix:localTransformMatrix,rigTransform:rigTransform}};var dissolveGroups=function dissolveGroups(groupsToDissolve,shapes,selectedShapes){return{shapes:shapes.filter(function(s){return!groupsToDissolve.find(function(g){return s.id===g.id})}).map(function(shape){var preexistingGroupParent=groupsToDissolve.find(function(groupShape){return groupShape.id===shape.parent});return preexistingGroupParent?_extends({},shape,{parent:null,localTransformMatrix:matrix.multiply(shapes.find(function(s){return s.id===preexistingGroupParent.id}).localTransformMatrix,shape.localTransformMatrix)}):shape}),selectedShapes:selectedShapes}};var hasNoParentWithin=function hasNoParentWithin(shapes){return function(shape){return!shapes.some(function(g){return shape.parent===g.id})}};var asYetUngroupedShapes=function asYetUngroupedShapes(preexistingAdHocGroups,selectedShapes){return selectedShapes.filter(hasNoParentWithin(preexistingAdHocGroups))};var idMatch=function idMatch(shape){return function(s){return s.id===shape.id}};var idsMatch=function idsMatch(selectedShapes){return function(shape){return selectedShapes.find(idMatch(shape))}};var axisAlignedBoundingBoxShape=function axisAlignedBoundingBoxShape(configuration,shapesToBox){var axisAlignedBoundingBox=getAABB(shapesToBox);var _projectAABB=projectAABB(axisAlignedBoundingBox),a=_projectAABB.a,b=_projectAABB.b,localTransformMatrix=_projectAABB.localTransformMatrix,rigTransform=_projectAABB.rigTransform;var id=getId(configuration.groupName);var aabbShape={id:id,type:configuration.groupName,subtype:configuration.adHocGroupName,a:a,b:b,localTransformMatrix:localTransformMatrix,rigTransform:rigTransform,parent:null};return aabbShape};var resetChild=function resetChild(s){if(s.childBaseAB){s.childBaseAB=null;s.baseLocalTransformMatrix=null}};var childScaler=function childScaler(_ref23,baseAB){var a=_ref23.a,b=_ref23.b;var epsilon=1e-6;var groupScaleX=Math.max(a/baseAB[0],epsilon);var groupScaleY=Math.max(b/baseAB[1],epsilon);var groupScale=matrix.scale(groupScaleX,groupScaleY,1);return groupScale};var resizeChild=function resizeChild(groupScale){return function(s){var childBaseAB=s.childBaseAB||[s.a,s.b];var impliedScale=matrix.scale.apply(matrix,_toConsumableArray(childBaseAB).concat([1]));var inverseImpliedScale=matrix.invert(impliedScale);var baseLocalTransformMatrix=s.baseLocalTransformMatrix||s.localTransformMatrix;var normalizedBaseLocalTransformMatrix=matrix.multiply(baseLocalTransformMatrix,impliedScale);var T=matrix.multiply(groupScale,normalizedBaseLocalTransformMatrix);var backScaler=groupScale.map(function(d){return Math.abs(d)});var inverseBackScaler=matrix.invert(backScaler);var abTuple=matrix.mvMultiply(matrix.multiply(backScaler,impliedScale),[1,1,1,1]);s.localTransformMatrix=matrix.multiply(T,matrix.multiply(inverseImpliedScale,inverseBackScaler));s.a=abTuple[0];s.b=abTuple[1];s.childBaseAB=childBaseAB;s.baseLocalTransformMatrix=baseLocalTransformMatrix}};var resizeGroup=function resizeGroup(shapes,rootElement){var idMap={};for(var i=0;i<shapes.length;i++){idMap[shapes[i].id]=shapes[i]}var depths={};var ancestorsLength=function ancestorsLength(shape){return shape.parent?ancestorsLength(idMap[shape.parent])+1:0};for(var _i=0;_i<shapes.length;_i++){depths[shapes[_i].id]=ancestorsLength(shapes[_i])}var resizedParents=_defineProperty({},rootElement.id,rootElement);var sortedShapes=shapes.slice().sort(function(a,b){return depths[a.id]-depths[b.id]});var parentResized=function parentResized(s){return Boolean(s.childBaseAB||s.baseAB)};for(var _i2=0;_i2<sortedShapes.length;_i2++){var shape=sortedShapes[_i2];var parent=resizedParents[shape.parent];if(parent){resizedParents[shape.id]=shape;if(parentResized(parent)){resizeChild(childScaler(parent,parent.childBaseAB||parent.baseAB))(shape)}else{resetChild(shape)}}}return sortedShapes};var getLeafs=function getLeafs(descendCondition,allShapes,shapes){return removeDuplicates(function(s){return s.id},flatten(shapes.map(function(shape){return descendCondition(shape)?allShapes.filter(function(s){return s.parent===shape.id}):shape})))};var preserveCurrentGroups=function preserveCurrentGroups(shapes,selectedShapes){return{shapes:shapes,selectedShapes:selectedShapes}};var groupAction=select(function(action){var event=action&&action.event;return event==="group"||event==="ungroup"?event:null})(actionEvent);var grouping=select(function(configuration,shapes,selectedShapes,groupAction){var childOfGroup=function childOfGroup(shape){return shape.parent&&shape.parent.startsWith(configuration.groupName)};var isAdHocGroup=function isAdHocGroup(shape){return shape.type===configuration.groupName&&shape.subtype===configuration.adHocGroupName};var preexistingAdHocGroups=shapes.filter(isAdHocGroup);var matcher=idsMatch(selectedShapes);var selectedFn=function selectedFn(shape){return matcher(shape)&&shape.type!=="annotation"};var freshSelectedShapes=shapes.filter(selectedFn);var freshNonSelectedShapes=shapes.filter(not(selectedFn));var isGroup=function isGroup(shape){return shape.type===configuration.groupName};var isOrBelongsToGroup=function isOrBelongsToGroup(shape){return isGroup(shape)||childOfGroup(shape)};var someSelectedShapesAreGrouped=selectedShapes.some(isOrBelongsToGroup);var selectionOutsideGroup=!someSelectedShapesAreGrouped;if(groupAction==="group"){var selectedAdHocGroupsToPersist=selectedShapes.filter(function(s){return s.subtype===configuration.adHocGroupName});return{shapes:shapes.map(function(s){return s.subtype===configuration.adHocGroupName?_extends({},s,{subtype:configuration.persistentGroupName}):s}),selectedShapes:selectedShapes.filter(function(selected){return selected.subtype!==configuration.adHocGroupName}).concat(selectedAdHocGroupsToPersist.map(function(shape){return _extends({},shape,{subtype:configuration.persistentGroupName})}))}}if(groupAction==="ungroup"){return dissolveGroups(selectedShapes.filter(function(s){return s.subtype===configuration.persistentGroupName}),shapes,asYetUngroupedShapes(preexistingAdHocGroups,freshSelectedShapes))}if(preexistingAdHocGroups.length&&selectionOutsideGroup){return dissolveGroups(preexistingAdHocGroups,shapes,asYetUngroupedShapes(preexistingAdHocGroups,freshSelectedShapes))}var elements=contentShapes(shapes,selectedShapes);if(elements.length===1&&elements[0].type==="group"){return configuration.groupResize?{shapes:[].concat(_toConsumableArray(resizeGroup(shapes.filter(function(s){return s.type!=="annotation"}),elements[0])),_toConsumableArray(shapes.filter(function(s){return s.type==="annotation"}))),selectedShapes:selectedShapes}:preserveCurrentGroups(shapes,selectedShapes)}if(selectedShapes.length<2){return preserveCurrentGroups(shapes,selectedShapes)}else{var group=axisAlignedBoundingBoxShape(configuration,freshSelectedShapes);var selectedLeafShapes=getLeafs(function(shape){return shape.subtype===configuration.adHocGroupName},shapes,freshSelectedShapes);var parentedSelectedShapes=selectedLeafShapes.map(function(shape){return _extends({},shape,{parent:group.id,localTransformMatrix:matrix.multiply(group.rigTransform,shape.transformMatrix)})});var nonGroupGraphConstituent=function nonGroupGraphConstituent(s){return s.subtype!==configuration.adHocGroupName&&!parentedSelectedShapes.find(function(ss){return s.id===ss.id})};var dissociateFromParentIfAny=function dissociateFromParentIfAny(s){return s.parent&&s.parent.startsWith(configuration.groupName)&&preexistingAdHocGroups.find(function(ahg){return ahg.id===s.parent})?_extends({},s,{parent:null}):s};var allTerminalShapes=parentedSelectedShapes.concat(freshNonSelectedShapes.filter(nonGroupGraphConstituent).map(dissociateFromParentIfAny));return{shapes:allTerminalShapes.concat([group]),selectedShapes:[group]}}})(configuration,constrainedShapesWithPreexistingAnnotations,selectedShapes,groupAction);var groupedSelectedShapes=select(function(_ref24){var selectedShapes=_ref24.selectedShapes;return selectedShapes})(grouping);var groupedSelectedShapeIds=select(function(selectedShapes){return selectedShapes.map(function(shape){return shape.id})})(groupedSelectedShapes);var groupedSelectedPrimaryShapeIds=select(function(selectedShapes){return selectedShapes.map(primaryShape)})(groupedSelectedShapes);var resizeAnnotations=select(resizeAnnotationsFunction)(configuration,grouping);var rotationAnnotations=select(function(configuration,_ref25){var shapes=_ref25.shapes,selectedShapes=_ref25.selectedShapes;var shapesToAnnotate=selectedShapes;return shapesToAnnotate.map(function(shape,i){return rotationAnnotation(configuration,shapes,selectedShapes,shape,i)}).filter(identity)})(configuration,grouping);var annotatedShapes=select(function(_ref26,alignmentGuideAnnotations,hoverAnnotations,rotationAnnotations,resizeAnnotations){var shapes=_ref26.shapes;var annotations=[].concat(alignmentGuideAnnotations,hoverAnnotations,rotationAnnotations,resizeAnnotations);var contentShapes=shapes.filter(function(shape){return shape.type!=="annotation"});return contentShapes.concat(annotations)})(grouping,alignmentGuideAnnotations,hoverAnnotations,rotationAnnotations,resizeAnnotations);var globalTransformShapes=select(cascadeProperties)(annotatedShapes);var bidirectionalCursors={0:"ns-resize",45:"nesw-resize",90:"ew-resize",135:"nwse-resize",180:"ns-resize",225:"nesw-resize",270:"ew-resize",315:"nwse-resize"};var cursor=select(function(configuration,shape,draggedPrimaryShape){if(!shape){return"auto"}switch(shape.subtype){case configuration.rotationHandleName:return"crosshair";case configuration.resizeHandleName:var angle=(matrix.matrixToAngle(shape.transformMatrix)*180/Math.PI+360)%360;var screenProjectedAngle=angle+shape.cursorAngle;var discretizedAngle=(Math.round(screenProjectedAngle/45)*45+360)%360;return bidirectionalCursors[discretizedAngle];default:return draggedPrimaryShape?"grabbing":"grab"}})(configuration,focusedShape,draggedPrimaryShape);var nextScene=select(function(configuration,hoveredShape,selectedShapeIds,selectedPrimaryShapes,shapes,gestureEnd,draggedShape,cursor,selectionState,mouseTransformState,selectedShapes){var selectedLeafShapes=getLeafs(function(shape){return shape.type===configuration.groupName},shapes,selectionState.shapes.map(function(s){return s.type==="annotation"?shapes.find(function(ss){return ss.id===s.parent}):s}).filter(identity)).filter(function(shape){return shape.type!=="annotation"}).map(function(s){return s.id});return{configuration:configuration,hoveredShape:hoveredShape,selectedShapes:selectedShapeIds,selectedLeafShapes:selectedLeafShapes,selectedPrimaryShapes:selectedPrimaryShapes,shapes:shapes,gestureEnd:gestureEnd,draggedShape:draggedShape,cursor:cursor,selectionState:selectionState,mouseTransformState:mouseTransformState,selectedShapeObjects:selectedShapes}})(configuration,hoveredShape,groupedSelectedShapeIds,groupedSelectedPrimaryShapeIds,globalTransformShapes,gestureEnd,draggedShape,cursor,selectionState,mouseTransformState,groupedSelectedShapes);module.exports={cursorPosition:cursorPosition,mouseIsDown:mouseIsDown,dragVector:dragVector,nextScene:nextScene,focusedShape:focusedShape,primaryUpdate:primaryUpdate,shapes:shapes,focusedShapes:focusedShapes,selectedShapes:selectedShapeIds}},3212:function(module,exports,__webpack_require__){"use strict";var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var transpose=function transpose(_ref){var _ref2=_slicedToArray(_ref,9),a=_ref2[0],d=_ref2[1],g=_ref2[2],b=_ref2[3],e=_ref2[4],h=_ref2[5],c=_ref2[6],f=_ref2[7],i=_ref2[8];return[a,b,c,d,e,f,g,h,i]};var ORIGIN=[0,0,1];var NULLVECTOR=[0,0,0];var NULLMATRIX=transpose([0,0,0,0,0,0,0,0,0]);var UNITMATRIX=transpose([1,0,0,0,1,0,0,0,1]);var translate=function translate(x,y){return transpose([1,0,x,0,1,y,0,0,1])};var scale=function scale(x,y){return transpose([x,0,0,0,y,0,0,0,1])};var shear=function shear(x,y){return transpose([1,x,0,y,1,0,0,0,1])};var mult=function mult(_ref3,_ref4){var _ref6=_slicedToArray(_ref3,9),a=_ref6[0],b=_ref6[1],c=_ref6[2],d=_ref6[3],e=_ref6[4],f=_ref6[5],g=_ref6[6],h=_ref6[7],i=_ref6[8];var _ref5=_slicedToArray(_ref4,9),A=_ref5[0],B=_ref5[1],C=_ref5[2],D=_ref5[3],E=_ref5[4],F=_ref5[5],G=_ref5[6],H=_ref5[7],I=_ref5[8];return[a*A+d*B+g*C,b*A+e*B+h*C,c*A+f*B+i*C,a*D+d*E+g*F,b*D+e*E+h*F,c*D+f*E+i*F,a*G+d*H+g*I,b*G+e*H+h*I,c*G+f*H+i*I]};var multiply=function multiply(){for(var _len=arguments.length,elements=Array(_len),_key=0;_key<_len;_key++){elements[_key]=arguments[_key]}return elements.slice(1).reduce(function(prev,next){return mult(prev,next)},elements[0])};var mvMultiply=function mvMultiply(_ref7,_ref8){var _ref10=_slicedToArray(_ref7,9),a=_ref10[0],b=_ref10[1],c=_ref10[2],d=_ref10[3],e=_ref10[4],f=_ref10[5],g=_ref10[6],h=_ref10[7],i=_ref10[8];var _ref9=_slicedToArray(_ref8,3),A=_ref9[0],B=_ref9[1],C=_ref9[2];return[a*A+d*B+g*C,b*A+e*B+h*C,c*A+f*B+i*C]};var normalize=function normalize(_ref11){var _ref12=_slicedToArray(_ref11,3),A=_ref12[0],B=_ref12[1],C=_ref12[2];return C===1?[A,B,C]:[A/C,B/C,1]};var add=function add(_ref13,_ref14){var _ref16=_slicedToArray(_ref13,9),a=_ref16[0],b=_ref16[1],c=_ref16[2],d=_ref16[3],e=_ref16[4],f=_ref16[5],g=_ref16[6],h=_ref16[7],i=_ref16[8];var _ref15=_slicedToArray(_ref14,9),A=_ref15[0],B=_ref15[1],C=_ref15[2],D=_ref15[3],E=_ref15[4],F=_ref15[5],G=_ref15[6],H=_ref15[7],I=_ref15[8];return[a+A,b+B,c+C,d+D,e+E,f+F,g+G,h+H,i+I]};var subtract=function subtract(_ref17,_ref18){var _ref20=_slicedToArray(_ref17,9),a=_ref20[0],b=_ref20[1],c=_ref20[2],d=_ref20[3],e=_ref20[4],f=_ref20[5],g=_ref20[6],h=_ref20[7],i=_ref20[8];var _ref19=_slicedToArray(_ref18,9),A=_ref19[0],B=_ref19[1],C=_ref19[2],D=_ref19[3],E=_ref19[4],F=_ref19[5],G=_ref19[6],H=_ref19[7],I=_ref19[8];return[a-A,b-B,c-C,d-D,e-E,f-F,g-G,h-H,i-I]};var reduceTransforms=function reduceTransforms(transforms){return transforms.length===1?transforms[0]:transforms.slice(1).reduce(function(prev,next){return multiply(prev,next)},transforms[0])};var applyTransforms=function applyTransforms(transforms,previousTransformMatrix){return transforms.reduce(function(prev,next){return multiply(prev,next)},previousTransformMatrix)};var componentProduct=function componentProduct(_ref21,_ref22){var _ref24=_slicedToArray(_ref21,3),a=_ref24[0],b=_ref24[1],c=_ref24[2];var _ref23=_slicedToArray(_ref22,3),A=_ref23[0],B=_ref23[1],C=_ref23[2];return[a*A,b*B,c*C]};module.exports={ORIGIN:ORIGIN,NULLVECTOR:NULLVECTOR,NULLMATRIX:NULLMATRIX,UNITMATRIX:UNITMATRIX,transpose:transpose,translate:translate,shear:shear,scale:scale,multiply:multiply,mvMultiply:mvMultiply,normalize:normalize,applyTransforms:applyTransforms,reduceTransforms:reduceTransforms,add:add,subtract:subtract,componentProduct:componentProduct}},3213:function(module,exports,__webpack_require__){"use strict";var adHocGroupName="adHocGroup";var alignmentGuideName="alignmentGuide";var atopZ=1e3;var depthSelect=true;var devColor="magenta";var groupName="group";var groupResize=true;var guideDistance=3;var hoverAnnotationName="hoverAnnotation";var hoverLift=100;var intraGroupManipulation=false;var intraGroupSnapOnly=false;var persistentGroupName="persistentGroup";var resizeAnnotationOffset=0;var resizeAnnotationOffsetZ=.1;var resizeAnnotationSize=10;var resizeAnnotationConnectorOffset=0;var resizeConnectorName="resizeConnector";var rotateAnnotationOffset=12;var rotationEpsilon=.001;var rotationHandleName="rotationHandle";var rotationHandleSize=14;var resizeHandleName="resizeHandle";var rotateSnapInPixels=10;var shortcuts=false;var singleSelect=false;var snapConstraint=true;var minimumElementSize=0;module.exports={adHocGroupName:adHocGroupName,alignmentGuideName:alignmentGuideName,atopZ:atopZ,depthSelect:depthSelect,devColor:devColor,groupName:groupName,groupResize:groupResize,guideDistance:guideDistance,hoverAnnotationName:hoverAnnotationName,hoverLift:hoverLift,intraGroupManipulation:intraGroupManipulation,intraGroupSnapOnly:intraGroupSnapOnly,minimumElementSize:minimumElementSize,persistentGroupName:persistentGroupName,resizeAnnotationOffset:resizeAnnotationOffset,resizeAnnotationOffsetZ:resizeAnnotationOffsetZ,resizeAnnotationSize:resizeAnnotationSize,resizeAnnotationConnectorOffset:resizeAnnotationConnectorOffset,resizeConnectorName:resizeConnectorName,resizeHandleName:resizeHandleName,rotateAnnotationOffset:rotateAnnotationOffset,rotationEpsilon:rotationEpsilon,rotateSnapInPixels:rotateSnapInPixels,rotationHandleName:rotationHandleName,rotationHandleSize:rotationHandleSize,shortcuts:shortcuts,singleSelect:singleSelect,snapConstraint:snapConstraint}},3215:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.runInterpreter=runInterpreter;var _interpreter=__webpack_require__(352);var _common=__webpack_require__(41);var _notify=__webpack_require__(199);function runInterpreter(ast){var context=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var options=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return(0,_interpreter.interpretAst)(ast,context).then(function(renderable){if((0,_common.getType)(renderable)==="render"){return renderable}if(options.castToRender){return runInterpreter((0,_common.fromExpression)("render"),renderable,{castToRender:false})}return new Error("Ack! I don't know how to render a '"+(0,_common.getType)(renderable)+"'")}).catch(function(err){_notify.notify.error(err);throw err})}},3216:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.esPersistMiddleware=undefined;var _lodash=__webpack_require__(1);var _workpad=__webpack_require__(33);var _assets=__webpack_require__(304);var _workpad2=__webpack_require__(180);var _assets2=__webpack_require__(306);var _transient=__webpack_require__(230);var transientActions=_interopRequireWildcard(_transient);var _resolved_args=__webpack_require__(416);var resolvedArgsActions=_interopRequireWildcard(_resolved_args);var _workpad_service=__webpack_require__(353);var _notify=__webpack_require__(199);var _app=__webpack_require__(72);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var workpadChanged=function workpadChanged(before,after){var workpad=(0,_workpad.getWorkpad)(before);return(0,_workpad.getWorkpad)(after)!==workpad};var assetsChanged=function assetsChanged(before,after){var assets=(0,_assets.getAssetIds)(before);return!(0,_lodash.isEqual)(assets,(0,_assets.getAssetIds)(after))};var esPersistMiddleware=exports.esPersistMiddleware=function esPersistMiddleware(_ref){var getState=_ref.getState;var skippedActions=[_workpad2.setWorkpad,_assets2.setAssets,_assets2.resetAssets].concat(_toConsumableArray(Object.values(resolvedArgsActions)),_toConsumableArray(Object.values(transientActions))).map(function(a){return a.toString()});return function(next){return function(action){if(skippedActions.indexOf(action.type)>=0){return next(action)}var curState=getState();next(action);var newState=getState();if(!(0,_app.canUserWrite)(newState)){return}if(workpadChanged(curState,newState)||assetsChanged(curState,newState)){var persistedWorkpad=(0,_workpad.getWorkpadPersisted)(getState());return(0,_workpad_service.update)(persistedWorkpad.id,persistedWorkpad).catch(function(err){var statusCode=err.response&&err.response.status;switch(statusCode){case 400:return _notify.notify.error(err.response,{title:"Couldn't save your changes to Elasticsearch"});case 413:return _notify.notify.error("The server gave a response that the workpad data was too large. This\n              usually means uploaded image assets that are too large for Kibana or\n              a proxy. Try removing some assets in the asset manager.",{title:"Couldn't save your changes to Elasticsearch"});default:return _notify.notify.error(err,{title:"Couldn't update workpad"})}})}}}}},3217:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fullscreen=undefined;var _fullscreen2=__webpack_require__(3218);var _transient=__webpack_require__(230);var _app=__webpack_require__(72);var fullscreen=exports.fullscreen=function fullscreen(_ref){var getState=_ref.getState;return function(next){return function(action){next(action);if(action.type===_transient.setFullscreen.toString()){var _fullscreen=(0,_app.getFullscreen)(getState());(0,_fullscreen2.setFullscreen)(_fullscreen)}}}}},3218:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.setFullscreen=setFullscreen;var fullscreenClass=exports.fullscreenClass="canvas-isFullscreen";function setFullscreen(fullscreen){var doc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:document;var enabled=Boolean(fullscreen);var body=doc.querySelector("body");var bodyClassList=body.classList;var isFullscreen=bodyClassList.contains(fullscreenClass);if(enabled&&!isFullscreen){bodyClassList.add(fullscreenClass)}else if(!enabled&&isFullscreen){bodyClassList.remove(fullscreenClass)}}},3219:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.historyMiddleware=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _lodash=__webpack_require__(1);var _apps=__webpack_require__(1153);var _history_provider=__webpack_require__(1180);var _router_provider=__webpack_require__(714);var _workpad_service=__webpack_require__(353);var _history=__webpack_require__(417);var _workpad=__webpack_require__(180);var _assets=__webpack_require__(306);var _app=__webpack_require__(72);var _workpad2=__webpack_require__(33);function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}function getHistoryState(state){return state.persistent}var historyMiddleware=exports.historyMiddleware=function historyMiddleware(_ref){var dispatch=_ref.dispatch,getState=_ref.getState;var reduxInject=function reduxInject(routes){return routes.map(function(route){if(route.children){return _extends({},route,{children:reduxInject(route.children)})}if(!route.action){return route}return _extends({},route,{action:route.action(dispatch,getState)})})};var handlerState={pendingCount:0};var router=(0,_router_provider.routerProvider)(reduxInject(_apps.routes));var history=(0,_history_provider.historyProvider)();var handleHistoryChanges=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee(location,prevLocation){var pathname,historyState,historyAction,isBrowserNav,isUrlChange,currentWorkpadId,newWorkpad;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:pathname=location.pathname,historyState=location.state,historyAction=location.action;isBrowserNav=historyAction==="pop"&&historyState!=null;isUrlChange=!isBrowserNav&&historyAction==="pop"||(historyAction==="push"||historyAction==="replace")&&prevLocation.pathname!==pathname;if(!isBrowserNav){_context.next=11;break}currentWorkpadId=(0,_workpad2.getWorkpad)(getState()).id;if(!(currentWorkpadId!==historyState.workpad.id)){_context.next=10;break}_context.next=8;return(0,_workpad_service.get)(historyState.workpad.id);case 8:newWorkpad=_context.sent;dispatch((0,_assets.setAssets)(newWorkpad.assets));case 10:return _context.abrupt("return",dispatch((0,_history.restoreHistory)(historyState)));case 11:if(!isUrlChange){_context.next=15;break}_context.next=14;return router.parse(pathname);case 14:return _context.abrupt("return",_context.sent);case 15:case"end":return _context.stop()}}},_callee,undefined)}));return function handleHistoryChanges(_x,_x2){return _ref2.apply(this,arguments)}}();history.onChange(_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var _args2=arguments;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:handlerState.pendingCount+=1;_context2.prev=1;_context2.next=4;return handleHistoryChanges.apply(undefined,_args2);case 4:_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2["catch"](1);case 8:_context2.prev=8;handlerState.pendingCount-=1;return _context2.finish(8);case 11:case"end":return _context2.stop()}}},_callee2,undefined,[[1,6,8,11]])})));return function(next){return function(action){var oldState=getState();switch(action.type){case _history.undoHistory.toString():return history.undo();case _history.redoHistory.toString():return history.redo();case _history.restoreHistory.toString():next(action);dispatch((0,_workpad.initializeWorkpad)());return}next(action);var newState=getState();if(!(0,_app.isAppReady)(newState)){return}if(!(0,_app.isAppReady)(oldState)&&(0,_app.isAppReady)(newState)){history.replace(getHistoryState(newState));return}var oldHistoryState=getHistoryState(oldState);var historyState=getHistoryState(newState);if(!(0,_lodash.isEqual)(historyState,oldHistoryState)){var useReplaceState=handlerState.pendingCount!==0;useReplaceState?history.replace(historyState):history.push(historyState)}}}}},3220:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _routes=__webpack_require__(3221);Object.defineProperty(exports,"routes",{enumerable:true,get:function get(){return _routes.routes}});var _home_app=__webpack_require__(1154);Object.defineProperty(exports,"HomeApp",{enumerable:true,get:function get(){return _home_app.HomeApp}})},3221:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.routes=undefined;var _home_app=__webpack_require__(1154);var routes=exports.routes=[{name:"home",path:"/",meta:{component:_home_app.HomeApp}}]},3222:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadManager=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _workpad_loader=__webpack_require__(3223);var _workpad_templates=__webpack_require__(3234);var _documentation_links=__webpack_require__(3238);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkpadManager=exports.WorkpadManager=function WorkpadManager(_ref){var onClose=_ref.onClose;var tabs=[{id:"workpadLoader",name:"My Workpads",content:_react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,null),_react2.default.createElement(_workpad_loader.WorkpadLoader,{onClose:onClose}))},{id:"workpadTemplates",name:"Templates",content:_react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiSpacer,null),_react2.default.createElement(_workpad_templates.WorkpadTemplates,{onClose:onClose}))}];return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiModalHeader,{className:"canvasHomeApp__modalHeader"},_react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiModalHeaderTitle,null,"Canvas workpads")),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiBetaBadge,{label:"Beta",tooltipContent:"Canvas is still in beta. Please help us improve by reporting issues or bugs in the Kibana repo."})),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiLink,{href:_documentation_links.documentationLinks.canvas,target:"_blank"},"Docs")))),_react2.default.createElement(_eui.EuiModalBody,null,_react2.default.createElement(_eui.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0]})))};WorkpadManager.propTypes={onClose:_propTypes2.default.func}},3223:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadLoader=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _fileSaver=__webpack_require__(1177);var _fileSaver2=_interopRequireDefault(_fileSaver);var _workpad_service=__webpack_require__(353);var workpadService=_interopRequireWildcard(_workpad_service);var _notify=__webpack_require__(199);var _app=__webpack_require__(72);var _workpad=__webpack_require__(33);var _get_id=__webpack_require__(228);var _transient=__webpack_require__(230);var _workpad_loader=__webpack_require__(3224);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}var mapStateToProps=function mapStateToProps(state){return{workpadId:(0,_workpad.getWorkpad)(state).id,canUserWrite:(0,_app.canUserWrite)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setCanUserWrite:function setCanUserWrite(canUserWrite){return dispatch((0,_transient.setCanUserWrite)(canUserWrite))}}};var WorkpadLoader=exports.WorkpadLoader=(0,_recompose.compose)((0,_recompose.getContext)({router:_propTypes2.default.object}),(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps),(0,_recompose.withState)("workpads","setWorkpads",null),(0,_recompose.withHandlers)({createWorkpad:function createWorkpad(props){return function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(workpad){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(workpad!=null)){_context.next=12;break}_context.prev=1;_context.next=4;return workpadService.create(workpad);case 4:props.router.navigateTo("loadWorkpad",{id:workpad.id,page:1});_context.next=11;break;case 7:_context.prev=7;_context.t0=_context["catch"](1);_notify.notify.error(_context.t0,{title:"Couldn't upload workpad"});if(_context.t0.response&&_context.t0.response.status===403){props.setCanUserWrite(false)}case 11:return _context.abrupt("return");case 12:props.router.navigateTo("createWorkpad");case 13:case"end":return _context.stop()}}},_callee,undefined,[[1,7]])}));return function(_x){return _ref.apply(this,arguments)}}()},findWorkpads:function findWorkpads(_ref2){var setWorkpads=_ref2.setWorkpads;return function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(text){var workpads;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return workpadService.find(text);case 3:workpads=_context2.sent;setWorkpads(workpads);_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2["catch"](0);_notify.notify.error(_context2.t0,{title:"Couldn't find workpads"});case 10:case"end":return _context2.stop()}}},_callee2,undefined,[[0,7]])}));return function(_x2){return _ref3.apply(this,arguments)}}()},downloadWorkpad:function downloadWorkpad(){return function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(workpadId){var workpad,jsonBlob;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return workpadService.get(workpadId);case 3:workpad=_context3.sent;jsonBlob=new Blob([JSON.stringify(workpad)],{type:"application/json"});_fileSaver2.default.saveAs(jsonBlob,"canvas-workpad-"+workpad.name+"-"+workpad.id+".json");_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3["catch"](0);_notify.notify.error(_context3.t0,{title:"Couldn't download workpad"});case 11:case"end":return _context3.stop()}}},_callee3,undefined,[[0,8]])}));return function(_x3){return _ref4.apply(this,arguments)}}()},cloneWorkpad:function cloneWorkpad(props){return function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(workpadId){var workpad;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return workpadService.get(workpadId);case 3:workpad=_context4.sent;workpad.name+=" - Copy";workpad.id=(0,_get_id.getId)("workpad");_context4.next=8;return workpadService.create(workpad);case 8:props.router.navigateTo("loadWorkpad",{id:workpad.id,page:1});_context4.next=15;break;case 11:_context4.prev=11;_context4.t0=_context4["catch"](0);_notify.notify.error(_context4.t0,{title:"Couldn't clone workpad"});if(_context4.t0.response&&_context4.t0.response.status===403){props.setCanUserWrite(false)}case 15:case"end":return _context4.stop()}}},_callee4,undefined,[[0,11]])}));return function(_x4){return _ref5.apply(this,arguments)}}()},removeWorkpads:function removeWorkpads(props){return function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(workpadIds){var setWorkpads,workpads,loadedWorkpad,removeWorkpads;return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setWorkpads=props.setWorkpads,workpads=props.workpads,loadedWorkpad=props.workpadId;removeWorkpads=workpadIds.map(function(id){return workpadService.remove(id).then(function(){return{id:id,err:null}}).catch(function(err){return{id:id,err:err}})});return _context5.abrupt("return",Promise.all(removeWorkpads).then(function(results){var redirectHome=false;var _results$reduce=results.reduce(function(_ref7,result){var _ref8=_slicedToArray(_ref7,2),passes=_ref8[0],errors=_ref8[1];if(result.id===loadedWorkpad&&!result.err){redirectHome=true}if(result.err){errors.push(result.id);if(result.err.response&&result.err.response.status===403){props.setCanUserWrite(false)}}else{passes.push(result.id)}return[passes,errors]},[[],[]]),_results$reduce2=_slicedToArray(_results$reduce,2),passes=_results$reduce2[0],errors=_results$reduce2[1];var remainingWorkpads=workpads.workpads.filter(function(_ref9){var id=_ref9.id;return!passes.includes(id)});var workpadState={total:remainingWorkpads.length,workpads:remainingWorkpads};if(errors.length>0){_notify.notify.error("Couldn't delete all workpads")}setWorkpads(workpadState);if(redirectHome){props.router.navigateTo("home")}return errors.map(function(_ref10){var id=_ref10.id;return id})}));case 3:case"end":return _context5.stop()}}},_callee5,undefined)}));return function(_x5){return _ref6.apply(this,arguments)}}()}}))(_workpad_loader.WorkpadLoader)},3224:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadLoader=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(1);var _moment=__webpack_require__(13);var _moment2=_interopRequireDefault(_moment);var _confirm_modal=__webpack_require__(702);var _link=__webpack_require__(703);var _paginate=__webpack_require__(704);var _workpad_dropzone=__webpack_require__(3228);var _workpad_create=__webpack_require__(3231);var _workpad_search=__webpack_require__(3232);var _workpad_upload=__webpack_require__(3233);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var formatDate=function formatDate(date){return date&&(0,_moment2.default)(date).format("MMM D, YYYY @ h:mma")};var WorkpadLoader=exports.WorkpadLoader=function(_React$PureComponent){_inherits(WorkpadLoader,_React$PureComponent);function WorkpadLoader(){var _ref,_this2=this;var _temp,_this,_ret;_classCallCheck(this,WorkpadLoader);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=WorkpadLoader.__proto__||Object.getPrototypeOf(WorkpadLoader)).call.apply(_ref,[this].concat(args))),_this),_this.state={createPending:false,deletingWorkpad:false,sortField:"@timestamp",sortDirection:"desc",selectedWorkpads:[],pageSize:10},_this.createWorkpad=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({createPending:true});_context.next=3;return _this.props.createWorkpad();case 3:_this._isMounted&&_this.setState({createPending:false});case 4:case"end":return _context.stop()}}},_callee,_this2)})),_this.uploadWorkpad=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(workpad){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this.setState({createPending:true});_context2.next=3;return _this.props.createWorkpad(workpad);case 3:_this._isMounted&&_this.setState({createPending:false});case 4:case"end":return _context2.stop()}}},_callee2,_this2)}));return function(_x){return _ref3.apply(this,arguments)}}(),_this.cloneWorkpad=function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(workpad){return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this.setState({createPending:true});_context3.next=3;return _this.props.cloneWorkpad(workpad.id);case 3:_this._isMounted&&_this.setState({createPending:false});case 4:case"end":return _context3.stop()}}},_callee3,_this2)}));return function(_x2){return _ref4.apply(this,arguments)}}(),_this.openRemoveConfirm=function(){return _this.setState({deletingWorkpad:true})},_this.closeRemoveConfirm=function(){return _this.setState({deletingWorkpad:false})},_this.removeWorkpads=function(){var selectedWorkpads=_this.state.selectedWorkpads;_this.props.removeWorkpads(selectedWorkpads.map(function(_ref5){var id=_ref5.id;return id})).then(function(remainingIds){var remainingWorkpads=remainingIds.length>0?selectedWorkpads.filter(function(_ref6){var id=_ref6.id;return remainingIds.includes(id)}):[];_this._isMounted&&_this.setState({deletingWorkpad:false,selectedWorkpads:remainingWorkpads})})},_this.downloadWorkpads=function(){_this.state.selectedWorkpads.forEach(function(_ref7){var id=_ref7.id;return _this.props.downloadWorkpad(id)})},_this.onSelectionChange=function(selectedWorkpads){_this.setState({selectedWorkpads:selectedWorkpads})},_this.onTableChange=function(_ref8){var _ref8$sort=_ref8.sort,sort=_ref8$sort===undefined?{}:_ref8$sort;var sortField=sort.field,sortDirection=sort.direction;_this.setState({sortField:sortField,sortDirection:sortDirection})},_this.renderWorkpadTable=function(_ref9){var rows=_ref9.rows,pageNumber=_ref9.pageNumber,totalPages=_ref9.totalPages,setPage=_ref9.setPage;var _this$state=_this.state,sortField=_this$state.sortField,sortDirection=_this$state.sortDirection;var _this$props=_this.props,canUserWrite=_this$props.canUserWrite,createPending=_this$props.createPending;var actions=[{render:function render(workpad){return _react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{content:"Download"},_react2.default.createElement(_eui.EuiButtonIcon,{iconType:"sortDown",onClick:function onClick(){return _this.props.downloadWorkpad(workpad.id)},"aria-label":"Download Workpad"}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{content:canUserWrite?"Clone":"You don't have permission to clone workpads"},_react2.default.createElement(_eui.EuiButtonIcon,{iconType:"copy",onClick:function onClick(){return _this.cloneWorkpad(workpad)},"aria-label":"Clone Workpad",disabled:!canUserWrite}))))}}];var columns=[{field:"name",name:"Workpad Name",sortable:true,dataType:"string",render:function render(name,workpad){var workpadName=workpad.name.length?workpad.name:_react2.default.createElement("em",null,workpad.id);return _react2.default.createElement(_link.Link,{"data-test-subj":"canvasWorkpadLoaderWorkpad",name:"loadWorkpad",params:{id:workpad.id},"aria-label":"Load workpad "+workpadName},workpadName)}},{field:"@created",name:"Created",sortable:true,dataType:"date",width:"20%",render:function render(date){return formatDate(date)}},{field:"@timestamp",name:"Updated",sortable:true,dataType:"date",width:"20%",render:function render(date){return formatDate(date)}},{name:"",actions:actions,width:"5%"}];var sorting={sort:{field:sortField,direction:sortDirection}};var selection={itemId:"id",onSelectionChange:_this.onSelectionChange};var emptyTable=_react2.default.createElement(_eui.EuiEmptyPrompt,{iconType:"importAction",title:_react2.default.createElement("h2",null,"Add your first workpad"),titleSize:"s",body:_react2.default.createElement(_react.Fragment,null,_react2.default.createElement("p",null,"Create a new workpad or drag and drop previously built workpad JSON files here."))});return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_workpad_dropzone.WorkpadDropzone,{onUpload:_this.uploadWorkpad,disabled:createPending||!canUserWrite},_react2.default.createElement(_eui.EuiBasicTable,{compressed:true,items:rows,itemId:"id",columns:columns,sorting:sorting,noItemsMessage:emptyTable,onChange:_this.onTableChange,isSelectable:true,selection:selection,className:"canvasWorkpad__dropzoneTable","data-test-subj":"canvasWorkpadLoaderTable"}),_react2.default.createElement(_eui.EuiSpacer,null),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"none",justifyContent:"flexEnd"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiPagination,{activePage:pageNumber,onPageClick:setPage,pageCount:totalPages})))))},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(WorkpadLoader,[{key:"componentDidMount",value:function(){var _ref10=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:this.props.findWorkpads();this._isMounted=true;case 2:case"end":return _context4.stop()}}},_callee4,this)}));function componentDidMount(){return _ref10.apply(this,arguments)}return componentDidMount}()},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(newProps){var _props=this.props,workpadId=_props.workpadId,onClose=_props.onClose;if(workpadId!==newProps.workpadId){onClose()}}},{key:"componentWillUnmount",value:function componentWillUnmount(){this._isMounted=false}},{key:"render",value:function render(){var _this3=this;var _state=this.state,deletingWorkpad=_state.deletingWorkpad,createPending=_state.createPending,selectedWorkpads=_state.selectedWorkpads,sortField=_state.sortField,sortDirection=_state.sortDirection;var canUserWrite=this.props.canUserWrite;var isLoading=this.props.workpads==null;var createButton=_react2.default.createElement(_workpad_create.WorkpadCreate,{createPending:createPending,onCreate:this.createWorkpad,disabled:!canUserWrite});var deleteButton=_react2.default.createElement(_eui.EuiButton,{color:"danger",iconType:"trash",onClick:this.openRemoveConfirm,disabled:!canUserWrite},"Delete ("+selectedWorkpads.length+")");var downloadButton=_react2.default.createElement(_eui.EuiButton,{color:"secondary",onClick:this.downloadWorkpads,iconType:"sortDown"},"Download ("+selectedWorkpads.length+")");var uploadButton=_react2.default.createElement(_workpad_upload.WorkpadUpload,{onUpload:this.uploadWorkpad,disabled:createPending||!canUserWrite});if(!canUserWrite){createButton=_react2.default.createElement(_eui.EuiToolTip,{content:"You don't have permission to create workpads"},createButton);deleteButton=_react2.default.createElement(_eui.EuiToolTip,{content:"You don't have permission to delete workpads"},deleteButton);uploadButton=_react2.default.createElement(_eui.EuiToolTip,{content:"You don't have permission to upload workpads"},uploadButton)}var modalTitle=selectedWorkpads.length===1?"Delete workpad '"+selectedWorkpads[0].name+"'?":"Delete "+selectedWorkpads.length+" workpads?";var confirmModal=_react2.default.createElement(_confirm_modal.ConfirmModal,{isOpen:deletingWorkpad,title:modalTitle,message:"You can't recover deleted workpads.",confirmButtonText:"Delete",onConfirm:this.removeWorkpads,onCancel:this.closeRemoveConfirm});var sortedWorkpads=[];if(!createPending&&!isLoading){var workpads=this.props.workpads.workpads;sortedWorkpads=(0,_lodash.sortByOrder)(workpads,[sortField,"@timestamp"],[sortDirection,"desc"])}return _react2.default.createElement(_paginate.Paginate,{rows:sortedWorkpads},function(pagination){return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween"},_react2.default.createElement(_eui.EuiFlexItem,{grow:2},_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},selectedWorkpads.length>0&&_react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiFlexItem,{grow:false},downloadButton),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},deleteButton)),_react2.default.createElement(_eui.EuiFlexItem,{grow:1},_react2.default.createElement(_workpad_search.WorkpadSearch,{onChange:function onChange(text){pagination.setPage(0);_this3.props.findWorkpads(text)}})))),_react2.default.createElement(_eui.EuiFlexItem,{grow:2},_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd",wrap:true},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},uploadButton),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},createButton)))),_react2.default.createElement(_eui.EuiSpacer,null),createPending&&_react2.default.createElement("div",{style:{width:"100%"}},"Creating Workpad..."),!createPending&&isLoading&&_react2.default.createElement("div",{style:{width:"100%"}},"Fetching Workpads..."),!createPending&&!isLoading&&_this3.renderWorkpadTable(pagination),confirmModal)})}}]);return WorkpadLoader}(_react2.default.PureComponent);WorkpadLoader.propTypes={workpadId:_propTypes2.default.string.isRequired,canUserWrite:_propTypes2.default.bool.isRequired,createWorkpad:_propTypes2.default.func.isRequired,findWorkpads:_propTypes2.default.func.isRequired,downloadWorkpad:_propTypes2.default.func.isRequired,cloneWorkpad:_propTypes2.default.func.isRequired,removeWorkpads:_propTypes2.default.func.isRequired,onClose:_propTypes2.default.func.isRequired,workpads:_propTypes2.default.object}},3225:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ConfirmModal=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}var ConfirmModal=function ConfirmModal(props){var isOpen=props.isOpen,title=props.title,message=props.message,onConfirm=props.onConfirm,onCancel=props.onCancel,confirmButtonText=props.confirmButtonText,cancelButtonText=props.cancelButtonText,className=props.className,rest=_objectWithoutProperties(props,["isOpen","title","message","onConfirm","onCancel","confirmButtonText","cancelButtonText","className"]);var confirm=function confirm(ev){onConfirm&&onConfirm(ev)};var cancel=function cancel(ev){onCancel&&onCancel(ev)};if(!isOpen){return null}return _react2.default.createElement(_eui.EuiOverlayMask,null,_react2.default.createElement(_eui.EuiConfirmModal,_extends({},rest,{className:"canvasConfirmModal "+(className||""),title:title,onCancel:cancel,onConfirm:confirm,confirmButtonText:confirmButtonText,cancelButtonText:cancelButtonText,defaultFocusedButton:"confirm",buttonColor:"danger"}),message))};exports.ConfirmModal=ConfirmModal;ConfirmModal.propTypes={isOpen:_propTypes2.default.bool,title:_propTypes2.default.string,message:_propTypes2.default.string.isRequired,onConfirm:_propTypes2.default.func.isRequired,onCancel:_propTypes2.default.func.isRequired,cancelButtonText:_propTypes2.default.string,confirmButtonText:_propTypes2.default.string,className:_propTypes2.default.string};ConfirmModal.defaultProps={title:"Confirm",confirmButtonText:"Confirm",cancelButtonText:"Cancel"}},3226:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Link=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var isModifiedEvent=function isModifiedEvent(ev){return!!(ev.metaKey||ev.altKey||ev.ctrlKey||ev.shiftKey)};var Link=exports.Link=function(_React$PureComponent){_inherits(Link,_React$PureComponent);function Link(){var _ref;var _temp,_this,_ret;_classCallCheck(this,Link);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=Link.__proto__||Object.getPrototypeOf(Link)).call.apply(_ref,[this].concat(args))),_this),_this.navigateTo=function(name,params){return function(ev){if(_this.props.onClick){_this.props.onClick(ev)}if(!ev.defaultPrevented&&ev.button===0&&!_this.props.target&&!isModifiedEvent(ev)){ev.preventDefault();_this.context.router.navigateTo(name,params)}}},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(Link,[{key:"render",value:function render(){try{var _props=this.props,name=_props.name,params=_props.params,children=_props.children,linkArgs=_objectWithoutProperties(_props,["name","params","children"]);var router=this.context.router;var href=router.getFullPath(router.create(name,params));var props=_extends({},linkArgs,{href:href,onClick:this.navigateTo(name,params)});return _react2.default.createElement(_eui.EuiLink,props,children)}catch(e){console.error(e);return _react2.default.createElement("div",null,"LINK ERROR: ",e.message)}}}]);return Link}(_react2.default.PureComponent);Link.propTypes={target:_propTypes2.default.string,onClick:_propTypes2.default.func,name:_propTypes2.default.string.isRequired,params:_propTypes2.default.object,children:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.number,_propTypes2.default.node]).isRequired};Link.contextTypes={router:_propTypes2.default.object}},3227:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Paginate=undefined;var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Paginate=exports.Paginate=function Paginate(props){return props.children({rows:props.partialRows,perPage:props.perPage,pageNumber:props.pageNumber,totalPages:props.totalPages,nextPageEnabled:props.nextPageEnabled,prevPageEnabled:props.prevPageEnabled,setPage:function setPage(num){return props.setPage(num)},nextPage:props.nextPage,prevPage:props.prevPage})};Paginate.propTypes={children:_propTypes2.default.func.isRequired,partialRows:_propTypes2.default.array.isRequired,perPage:_propTypes2.default.number.isRequired,pageNumber:_propTypes2.default.number.isRequired,totalPages:_propTypes2.default.number.isRequired,nextPageEnabled:_propTypes2.default.bool.isRequired,prevPageEnabled:_propTypes2.default.bool.isRequired,setPage:_propTypes2.default.func.isRequired,nextPage:_propTypes2.default.func.isRequired,prevPage:_propTypes2.default.func.isRequired}},3228:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadDropzone=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _notify=__webpack_require__(199);var _upload_workpad=__webpack_require__(1157);var _workpad_dropzone=__webpack_require__(3229);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkpadDropzone=exports.WorkpadDropzone=(0,_recompose.compose)((0,_recompose.withHandlers)({onDropAccepted:function onDropAccepted(_ref){var onUpload=_ref.onUpload;return function(_ref2){var _ref3=_slicedToArray(_ref2,1),file=_ref3[0];return(0,_upload_workpad.uploadWorkpad)(file,onUpload)}},onDropRejected:function onDropRejected(){return function(_ref4){var _ref5=_slicedToArray(_ref4,1),file=_ref5[0];_notify.notify.warning("Only JSON files are accepted",{title:"Couldn't upload '"+(file.name||"file")+"'"})}}}))(_workpad_dropzone.WorkpadDropzone);WorkpadDropzone.propTypes={onUpload:_propTypes2.default.func.isRequired}},3229:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadDropzone=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactDropzone=__webpack_require__(5013);var _reactDropzone2=_interopRequireDefault(_reactDropzone);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkpadDropzone=exports.WorkpadDropzone=function WorkpadDropzone(_ref){var onDropAccepted=_ref.onDropAccepted,onDropRejected=_ref.onDropRejected,disabled=_ref.disabled,children=_ref.children;return _react2.default.createElement(_reactDropzone2.default,{accept:"application/json",onDropAccepted:onDropAccepted,onDropRejected:onDropRejected,disableClick:true,disabled:disabled,className:"canvasWorkpad__dropzone",activeClassName:"canvasWorkpad__dropzone--active"},children)};WorkpadDropzone.propTypes={onDropAccepted:_propTypes2.default.func.isRequired,onDropRejected:_propTypes2.default.func.isRequired,disabled:_propTypes2.default.bool.isRequired,children:_propTypes2.default.node.isRequired}},3231:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadCreate=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}var WorkpadCreate=function WorkpadCreate(_ref){var createPending=_ref.createPending,onCreate=_ref.onCreate,rest=_objectWithoutProperties(_ref,["createPending","onCreate"]);return _react2.default.createElement(_eui.EuiButton,_extends({},rest,{iconType:"plusInCircle",fill:true,onClick:onCreate,isLoading:createPending}),"Create workpad")};exports.WorkpadCreate=WorkpadCreate;WorkpadCreate.propTypes={onCreate:_propTypes2.default.func.isRequired,createPending:_propTypes2.default.bool}},3232:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadSearch=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var WorkpadSearch=exports.WorkpadSearch=function(_React$PureComponent){_inherits(WorkpadSearch,_React$PureComponent);function WorkpadSearch(){var _ref;var _temp,_this,_ret;_classCallCheck(this,WorkpadSearch);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=WorkpadSearch.__proto__||Object.getPrototypeOf(WorkpadSearch)).call.apply(_ref,[this].concat(args))),_this),_this.state={searchText:_this.props.initialText||""},_this.triggerChange=(0,_lodash.debounce)(_this.props.onChange,150),_this.setSearchText=function(ev){var text=ev.target.value;_this.setState({searchText:text});_this.triggerChange(text)},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(WorkpadSearch,[{key:"render",value:function render(){return _react2.default.createElement(_eui.EuiFieldSearch,{placeholder:"Find workpad",value:this.state.searchText,onChange:this.setSearchText,fullWidth:true,incremental:true})}}]);return WorkpadSearch}(_react2.default.PureComponent);WorkpadSearch.propTypes={onChange:_propTypes2.default.func.isRequired,initialText:_propTypes2.default.string}},3233:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadUpload=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _upload_workpad=__webpack_require__(1157);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}var WorkpadUpload=function WorkpadUpload(_ref){var onUpload=_ref.onUpload,rest=_objectWithoutProperties(_ref,["onUpload"]);return _react2.default.createElement(_eui.EuiFilePicker,_extends({},rest,{compressed:true,className:"canvasWorkpad__upload--compressed",initialPromptText:"Import workpad JSON file",onChange:function onChange(_ref2){var _ref3=_slicedToArray(_ref2,1),file=_ref3[0];return(0,_upload_workpad.uploadWorkpad)(file,onUpload)}}))};exports.WorkpadUpload=WorkpadUpload;WorkpadUpload.propTypes={onUpload:_propTypes2.default.func.isRequired}},3234:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadTemplates=undefined;var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _workpad_service=__webpack_require__(353);var workpadService=_interopRequireWildcard(_workpad_service);var _notify=__webpack_require__(199);var _get_id=__webpack_require__(228);var _templates_registry=__webpack_require__(1158);var _tags_registry=__webpack_require__(705);var _workpad_templates=__webpack_require__(3237);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkpadTemplates=exports.WorkpadTemplates=(0,_recompose.compose)((0,_recompose.getContext)({router:_propTypes2.default.object}),(0,_recompose.withProps)(function(){return{templates:_templates_registry.templatesRegistry.toJS(),uniqueTags:_tags_registry.tagsRegistry.toJS()}}),(0,_recompose.withHandlers)({cloneWorkpad:function cloneWorkpad(props){return function(workpad){workpad.id=(0,_get_id.getId)("workpad");workpad.name="Untitled Workpad - "+workpad.name;workpad.tags=undefined;return workpadService.create(workpad).then(function(){return props.router.navigateTo("loadWorkpad",{id:workpad.id,page:1})}).catch(function(err){return _notify.notify.error(err,{title:"Couldn't clone workpad template"})})}}}))(_workpad_templates.WorkpadTemplates)},3235:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Template=Template;var _tags_registry=__webpack_require__(705);var _defaults=__webpack_require__(415);var _get_id=__webpack_require__(228);var defaultWorkpad=(0,_defaults.getDefaultWorkpad)();function Template(config){this.name=config.name;this.displayName=config.displayName||this.name;this.id=config.id||(0,_get_id.getId)("workpad");this.help=config.help||"";this.tags=config.tags||[];this.tags.forEach(function(tag){if(!_tags_registry.tagsRegistry.get(tag)){_tags_registry.tagsRegistry.register(function(){return{name:tag,color:"#666666"}})}});this.width=config.width||defaultWorkpad.width;this.height=config.height||defaultWorkpad.height;this.page=config.page||defaultWorkpad.page;this.pages=config.pages||defaultWorkpad.pages;this.colors=config.colors||defaultWorkpad.colors;this["@timestamp"]=config["@timestamp"]||defaultWorkpad["@timestamp"];this["@created"]=config["@created"]||defaultWorkpad["@created"];this.assets=config.assets||{};this.css=config.css||defaultWorkpad.css}},3236:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Tag=Tag;function Tag(config){this.name=config.name;this.color=config.color}},3237:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadTemplates=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(1);var _get_id=__webpack_require__(228);var _paginate=__webpack_require__(704);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var WorkpadTemplates=exports.WorkpadTemplates=function(_React$PureComponent){_inherits(WorkpadTemplates,_React$PureComponent);function WorkpadTemplates(){var _ref;var _temp,_this,_ret;_classCallCheck(this,WorkpadTemplates);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=WorkpadTemplates.__proto__||Object.getPrototypeOf(WorkpadTemplates)).call.apply(_ref,[this].concat(args))),_this),_this.state={sortField:"name",sortDirection:"asc",pageSize:10,searchTerm:"",filterTags:[]},_this.onTableChange=function(_ref2){var _ref2$sort=_ref2.sort,sort=_ref2$sort===undefined?{}:_ref2$sort;var sortField=sort.field,sortDirection=sort.direction;_this.setState({sortField:sortField,sortDirection:sortDirection})},_this.onSearch=function(_ref3){var query=_ref3.query;var clauses=(0,_lodash.get)(query,"ast._clauses",[]);var filterTags=[];var searchTerms=[];clauses.forEach(function(clause){var type=clause.type,field=clause.field,value=clause.value;if(type==="term"){searchTerms.push(value)}else if(field==="tags"){filterTags.push(value)}});_this.setState({searchTerm:searchTerms.join(" "),filterTags:filterTags})},_this.cloneTemplate=function(template){return _this.props.cloneWorkpad(template).then(function(){return _this.props.onClose()})},_this.renderWorkpadTable=function(_ref4){var rows=_ref4.rows,pageNumber=_ref4.pageNumber,totalPages=_ref4.totalPages,setPage=_ref4.setPage;var uniqueTags=_this.props.uniqueTags;var _this$state=_this.state,sortField=_this$state.sortField,sortDirection=_this$state.sortDirection;var columns=[{field:"name",name:"Template Name",sortable:true,width:"30%",dataType:"string",render:function render(name,template){var templateName=template.name.length?template.name:_react2.default.createElement("em",null,template.id);return _react2.default.createElement(_eui.EuiButtonEmpty,{onClick:function onClick(){return _this.cloneTemplate(template)},"aria-label":'Clone workpad template "'+templateName+'"',type:"link"},templateName)}},{field:"help",name:"Description",sortable:false,dataType:"string",width:"30%"},{field:"tags",name:"Tags",sortable:false,dataType:"string",width:"30%",render:function render(tags){if(!tags){return"No tags"}return tags.map(function(tag){return _react2.default.createElement(_eui.EuiHealth,{key:(0,_get_id.getId)("tag"),color:(0,_lodash.get)(uniqueTags,tag+".color","#666666")},tag)})}}];var sorting={sort:{field:sortField,direction:sortDirection}};return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiBasicTable,{compressed:true,items:rows,itemId:"id",columns:columns,sorting:sorting,onChange:_this.onTableChange,className:"canvasWorkpad__dropzoneTable canvasWorkpad__dropzoneTable--tags"}),_react2.default.createElement(_eui.EuiSpacer,null),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"none",justifyContent:"flexEnd"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiPagination,{activePage:pageNumber,onPageClick:setPage,pageCount:totalPages}))))},_this.renderSearch=function(){var uniqueTags=_this.props.uniqueTags;var searchTerm=_this.state.searchTerm;uniqueTags=Object.values(uniqueTags);var filters=[{type:"field_value_selection",field:"tags",name:"Tags",multiSelect:true,options:uniqueTags.map(function(_ref5){var name=_ref5.name,color=_ref5.color;return{value:name,name:name,view:_react2.default.createElement(_eui.EuiHealth,{key:(0,_get_id.getId)("tag"),color:color},name)}})}];return _react2.default.createElement(_eui.EuiSearchBar,{defaultQuery:searchTerm,box:{placeholder:"Find template",incremental:true},filters:filters,onChange:_this.onSearch})},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(WorkpadTemplates,[{key:"render",value:function render(){var _this2=this;var templates=this.props.templates;var _state=this.state,sortField=_state.sortField,sortDirection=_state.sortDirection,searchTerm=_state.searchTerm,filterTags=_state.filterTags;var sortedTemplates=(0,_lodash.sortByOrder)(templates,[sortField,"name"],[sortDirection,"asc"]);var filteredTemplates=sortedTemplates.filter(function(_ref6){var _ref6$name=_ref6.name,name=_ref6$name===undefined?"":_ref6$name,_ref6$help=_ref6.help,help=_ref6$help===undefined?"":_ref6$help,_ref6$tags=_ref6.tags,tags=_ref6$tags===undefined?[]:_ref6$tags;var tagMatch=filterTags.length?filterTags.every(function(filterTag){return tags.indexOf(filterTag)>-1}):true;var lowercaseSearch=searchTerm.toLowerCase();var textMatch=lowercaseSearch?name.toLowerCase().indexOf(lowercaseSearch)>-1||help.toLowerCase().indexOf(lowercaseSearch)>-1:true;return tagMatch&&textMatch});return _react2.default.createElement(_paginate.Paginate,{rows:filteredTemplates},function(pagination){return _react2.default.createElement(_react.Fragment,null,_this2.renderSearch(),_react2.default.createElement(_eui.EuiSpacer,null),_this2.renderWorkpadTable(pagination))})}}]);return WorkpadTemplates}(_react2.default.PureComponent);WorkpadTemplates.propTypes={cloneWorkpad:_propTypes2.default.func.isRequired,templates:_propTypes2.default.object,uniqueTags:_propTypes2.default.object}},3238:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.documentationLinks=undefined;var _documentation_links=__webpack_require__(65);var documentationLinks=exports.documentationLinks={canvas:_documentation_links.ELASTIC_WEBSITE_URL+"guide/en/kibana/"+_documentation_links.DOC_LINK_VERSION+"/canvas.html"}},3239:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _routes=__webpack_require__(3240);Object.defineProperty(exports,"routes",{enumerable:true,get:function get(){return _routes.routes}});var _workpad_app=__webpack_require__(1160);Object.defineProperty(exports,"WorkpadApp",{enumerable:true,get:function get(){return _workpad_app.WorkpadApp}})},3240:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.routes=undefined;var _workpad_service=__webpack_require__(353);var workpadService=_interopRequireWildcard(_workpad_service);var _notify=__webpack_require__(199);var _defaults=__webpack_require__(415);var _workpad2=__webpack_require__(180);var _assets=__webpack_require__(306);var _pages=__webpack_require__(305);var _workpad3=__webpack_require__(33);var _transient=__webpack_require__(230);var _workpad_app=__webpack_require__(1160);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}var routes=[{path:"/workpad",children:[{name:"createWorkpad",path:"/create",action:function action(dispatch){return function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee(_ref){var router=_ref.router;var newWorkpad;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:newWorkpad=(0,_defaults.getDefaultWorkpad)();_context.prev=1;_context.next=4;return workpadService.create(newWorkpad);case 4:dispatch((0,_workpad2.setWorkpad)(newWorkpad));dispatch((0,_assets.resetAssets)());router.redirectTo("loadWorkpad",{id:newWorkpad.id,page:1});_context.next=14;break;case 9:_context.prev=9;_context.t0=_context["catch"](1);_notify.notify.error(_context.t0,{title:"Couldn't create workpad"});if(_context.t0.response&&_context.t0.response.status===403){dispatch((0,_transient.setCanUserWrite)(false))}router.redirectTo("home");case 14:case"end":return _context.stop()}}},_callee,undefined,[[1,9]])}));return function(_x){return _ref2.apply(this,arguments)}}()},meta:{component:_workpad_app.WorkpadApp}},{name:"loadWorkpad",path:"/:id(/page/:page)",action:function action(dispatch,getState){return function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(_ref3){var params=_ref3.params,router=_ref3.router;var currentWorkpad,fetchedWorkpad,assets,_workpad,workpad,pageNumber,pageIndex;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:currentWorkpad=(0,_workpad3.getWorkpad)(getState());if(!(params.id!==currentWorkpad.id)){_context2.next=16;break}_context2.prev=2;_context2.next=5;return workpadService.get(params.id);case 5:fetchedWorkpad=_context2.sent;assets=fetchedWorkpad.assets,_workpad=_objectWithoutProperties(fetchedWorkpad,["assets"]);dispatch((0,_workpad2.setWorkpad)(_workpad));dispatch((0,_assets.setAssets)(assets));workpadService.update(params.id,fetchedWorkpad).catch(function(err){if(err.response&&err.response.status===403){dispatch((0,_transient.setCanUserWrite)(false))}});_context2.next=16;break;case 12:_context2.prev=12;_context2.t0=_context2["catch"](2);_notify.notify.error(_context2.t0,{title:"Couldn't load workpad with ID"});return _context2.abrupt("return",router.redirectTo("home"));case 16:workpad=(0,_workpad3.getWorkpad)(getState());pageNumber=parseInt(params.page,10);if(!isNaN(pageNumber)){_context2.next=20;break}return _context2.abrupt("return",router.redirectTo("loadWorkpad",{id:workpad.id,page:workpad.page+1}));case 20:pageIndex=pageNumber-1;if(pageIndex!==workpad.page){dispatch((0,_pages.gotoPage)(pageIndex))}case 22:case"end":return _context2.stop()}}},_callee2,undefined,[[2,12]])}));return function(_x2){return _ref4.apply(this,arguments)}}()},meta:{component:_workpad_app.WorkpadApp}}]}];exports.routes=routes},3241:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoadWorkpad=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LoadWorkpad=exports.LoadWorkpad=function LoadWorkpad(){return _react2.default.createElement("div",null,"Load a workpad...")}},3242:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadApp=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _sidebar=__webpack_require__(3243);var _toolbar=__webpack_require__(3305);var _workpad=__webpack_require__(3331);var _workpad_header=__webpack_require__(3363);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var WorkpadApp=exports.WorkpadApp=function(_React$PureComponent){_inherits(WorkpadApp,_React$PureComponent);function WorkpadApp(){_classCallCheck(this,WorkpadApp);return _possibleConstructorReturn(this,(WorkpadApp.__proto__||Object.getPrototypeOf(WorkpadApp)).apply(this,arguments))}_createClass(WorkpadApp,[{key:"componentDidMount",value:function componentDidMount(){this.props.initializeWorkpad()}},{key:"render",value:function render(){var _props=this.props,isWriteable=_props.isWriteable,deselectElement=_props.deselectElement;return _react2.default.createElement("div",{className:"canvasLayout"},_react2.default.createElement("div",{className:"canvasLayout__rows"},_react2.default.createElement("div",{className:"canvasLayout__cols"},_react2.default.createElement("div",{className:"canvasLayout__stage"},_react2.default.createElement("div",{className:"canvasLayout__stageHeader"},_react2.default.createElement(_workpad_header.WorkpadHeader,null)),_react2.default.createElement("div",{className:"canvasLayout__stageContent",onMouseDown:deselectElement},_react2.default.createElement("div",{className:"canvasWorkpadContainer canvasLayout__stageContentOverflow"},_react2.default.createElement(_workpad.Workpad,null)))),isWriteable&&_react2.default.createElement("div",{className:"canvasLayout__sidebar hide-for-sharing"},_react2.default.createElement(_sidebar.Sidebar,null))),_react2.default.createElement("div",{className:"canvasLayout__footer hide-for-sharing"},_react2.default.createElement(_toolbar.Toolbar,null))))}}]);return WorkpadApp}(_react2.default.PureComponent);WorkpadApp.propTypes={isWriteable:_propTypes2.default.bool.isRequired,deselectElement:_propTypes2.default.func,initializeWorkpad:_propTypes2.default.func.isRequired}},3243:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Sidebar=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _reactRedux=__webpack_require__(14);var _clone_subgraphs=__webpack_require__(706);var _elements=__webpack_require__(61);var _workpad=__webpack_require__(33);var _transient=__webpack_require__(230);var _sidebar=__webpack_require__(3244);var mapStateToProps=function mapStateToProps(state){return{selectedPage:(0,_workpad.getSelectedPage)(state),selectedElement:(0,_workpad.getSelectedElement)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{duplicateElement:function duplicateElement(pageId,selectedElement){return function(){var newElements=(0,_clone_subgraphs.cloneSubgraphs)([selectedElement]);dispatch((0,_elements.insertNodes)(newElements,pageId));dispatch((0,_transient.selectElement)(newElements[0].id))}},elementLayer:function elementLayer(pageId,selectedElement){return function(movement){return dispatch((0,_elements.elementLayer)({pageId:pageId,elementId:selectedElement.id,movement:movement}))}}}};var mergeProps=function mergeProps(stateProps,dispatchProps,ownProps){var selectedElement=stateProps.selectedElement,selectedPage=stateProps.selectedPage;return _extends({},stateProps,dispatchProps,ownProps,{elementIsSelected:Boolean(selectedElement),duplicateElement:dispatchProps.duplicateElement(selectedPage,selectedElement),elementLayer:dispatchProps.elementLayer(selectedPage,selectedElement)})};var Sidebar=exports.Sidebar=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,mergeProps)(_sidebar.Sidebar)},3244:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Sidebar=undefined;var _recompose=__webpack_require__(19);var _sidebar_component=__webpack_require__(3245);var _global_config=__webpack_require__(3287);var branches=[(0,_recompose.branch)(function(props){return!props.selectedElement},(0,_recompose.renderComponent)(_global_config.GlobalConfig))];var Sidebar=exports.Sidebar=_recompose.compose.apply(undefined,branches)(_sidebar_component.SidebarComponent)},3245:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SidebarComponent=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _datasource=__webpack_require__(3246);var _function_form_list=__webpack_require__(3278);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SidebarComponent=exports.SidebarComponent=function SidebarComponent(_ref){var selectedElement=_ref.selectedElement,duplicateElement=_ref.duplicateElement,elementLayer=_ref.elementLayer,elementIsSelected=_ref.elementIsSelected;var tabs=[{id:"edit",name:"Display",content:_react2.default.createElement("div",{className:"canvasSidebar__pop"},_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement("div",{className:"canvasSidebar--args"},_react2.default.createElement(_function_form_list.FunctionFormList,{element:selectedElement})))},{id:"data",name:"Data",content:_react2.default.createElement("div",{className:"canvasSidebar__pop"},_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_datasource.Datasource,null))}];return _react2.default.createElement("div",{className:"canvasSidebar"},elementIsSelected&&_react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"spaceBetween"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiTitle,{size:"s"},_react2.default.createElement("h3",null,"Selected layer"))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{position:"bottom",content:"Move element to top layer"},_react2.default.createElement(_eui.EuiButtonIcon,{color:"text",iconType:"sortUp",onClick:function onClick(){return elementLayer(Infinity)},"aria-label":"Move element to top layer"}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{position:"bottom",content:"Move element up one layer"},_react2.default.createElement(_eui.EuiButtonIcon,{color:"text",iconType:"arrowUp",onClick:function onClick(){return elementLayer(1)},"aria-label":"Move element up one layer"}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{position:"bottom",content:"Move element down one layer"},_react2.default.createElement(_eui.EuiButtonIcon,{color:"text",iconType:"arrowDown",onClick:function onClick(){return elementLayer(-1)},"aria-label":"Move element down one layer"}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{position:"bottom",content:"Move element to bottom layer"},_react2.default.createElement(_eui.EuiButtonIcon,{color:"text",iconType:"sortDown",onClick:function onClick(){return elementLayer(-Infinity)},"aria-label":"Move element to bottom layer"}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{position:"bottom",content:"Duplicate this element into a new layer"},_react2.default.createElement(_eui.EuiButtonIcon,{color:"text",iconType:"copy",onClick:function onClick(){return duplicateElement()},"aria-label":"Duplicate this element into a new layer"})))))))),_react2.default.createElement(_eui.EuiTabbedContent,{tabs:tabs,initialSelectedTab:tabs[0]})))};SidebarComponent.propTypes={selectedElement:_propTypes2.default.object,duplicateElement:_propTypes2.default.func.isRequired,elementLayer:_propTypes2.default.func,elementIsSelected:_propTypes2.default.bool.isRequired}},3246:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Datasource=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _propTypes=__webpack_require__(6);var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _lodash=__webpack_require__(1);var _expression_types=__webpack_require__(503);var _app=__webpack_require__(72);var _workpad=__webpack_require__(33);var _elements=__webpack_require__(61);var _datasource=__webpack_require__(3265);var mapStateToProps=function mapStateToProps(state){return{element:(0,_workpad.getSelectedElement)(state),pageId:(0,_workpad.getSelectedPage)(state),functionDefinitions:(0,_app.getServerFunctions)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{dispatchArgumentAtIndex:function dispatchArgumentAtIndex(props){return function(arg){return dispatch((0,_elements.setArgumentAtIndex)(_extends({},props,{arg:arg})))}},dispatchAstAtIndex:function dispatchAstAtIndex(_ref){var index=_ref.index,element=_ref.element,pageId=_ref.pageId;return function(ast){dispatch((0,_elements.flushContext)(element.id));dispatch((0,_elements.setAstAtIndex)(index,ast,element,pageId))}}}};var mergeProps=function mergeProps(stateProps,dispatchProps,ownProps){var element=stateProps.element,pageId=stateProps.pageId,functionDefinitions=stateProps.functionDefinitions;var dispatchArgumentAtIndex=dispatchProps.dispatchArgumentAtIndex,dispatchAstAtIndex=dispatchProps.dispatchAstAtIndex;var getDataTableFunctionsByName=function getDataTableFunctionsByName(name){return functionDefinitions.find(function(fn){return fn.name===name&&fn.type==="datatable"})};var datasourceAst=(0,_lodash.get)(element,"ast.chain",[]).map(function(astDef,i){if(astDef.type!=="function"){return}var args=astDef.arguments;var datasource=_expression_types.datasourceRegistry.get(astDef.function);if(!datasource){return}var datasourceDef=getDataTableFunctionsByName(datasource.name);return{datasource:datasource,datasourceDef:datasourceDef,args:args,expressionIndex:i}}).filter(Boolean)[0];return _extends({},ownProps,stateProps,dispatchProps,datasourceAst,{datasources:_expression_types.datasourceRegistry.toArray(),setDatasourceAst:dispatchAstAtIndex({pageId:pageId,element:element,index:datasourceAst&&datasourceAst.expressionIndex}),setDatasourceArgs:dispatchArgumentAtIndex({pageId:pageId,element:element,index:datasourceAst&&datasourceAst.expressionIndex})})};var Datasource=exports.Datasource=(0,_recompose.compose)((0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,mergeProps),(0,_recompose.withState)("stateArgs","updateArgs",function(_ref2){var args=_ref2.args;return args}),(0,_recompose.withState)("selecting","setSelecting",false),(0,_recompose.withState)("previewing","setPreviewing",false),(0,_recompose.withState)("isInvalid","setInvalid",false),(0,_recompose.withState)("stateDatasource","selectDatasource",function(_ref3){var datasource=_ref3.datasource;return datasource}),(0,_recompose.withHandlers)({resetArgs:function resetArgs(_ref4){var updateArgs=_ref4.updateArgs,args=_ref4.args;return function(){return updateArgs(args)}}}))(_datasource.Datasource);Datasource.propTypes={done:_propTypes.PropTypes.func}},3247:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RenderToDom=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var RenderToDom=exports.RenderToDom=function(_React$Component){_inherits(RenderToDom,_React$Component);function RenderToDom(){_classCallCheck(this,RenderToDom);return _possibleConstructorReturn(this,(RenderToDom.__proto__||Object.getPrototypeOf(RenderToDom)).apply(this,arguments))}_createClass(RenderToDom,[{key:"shouldComponentUpdate",value:function shouldComponentUpdate(nextProps){return this.props.domNode!==nextProps.domNode}},{key:"componentDidUpdate",value:function componentDidUpdate(){if(this.props.domNode){this.props.render(this.props.domNode)}}},{key:"render",value:function render(){var _props=this.props,domNode=_props.domNode,setDomNode=_props.setDomNode,style=_props.style;var linkRef=function linkRef(refNode){if(!domNode&&refNode){setDomNode(refNode)}};return _react2.default.createElement("div",{className:"render_to_dom",ref:linkRef,style:style})}}]);return RenderToDom}(_react2.default.Component);RenderToDom.propTypes={domNode:_propTypes2.default.object,setDomNode:_propTypes2.default.func.isRequired,render:_propTypes2.default.func.isRequired,style:_propTypes2.default.object}},3248:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgAddPopover=undefined;var _recompose=__webpack_require__(19);var _arg_add_popover=__webpack_require__(3249);var ArgAddPopover=exports.ArgAddPopover=(0,_recompose.pure)(_arg_add_popover.ArgAddPopover)},3249:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgAddPopover=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(2);var _popover=__webpack_require__(504);var _arg_add=__webpack_require__(3251);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ArgAddPopover=exports.ArgAddPopover=function ArgAddPopover(_ref){var options=_ref.options;var button=function button(handleClick){return _react2.default.createElement(_eui.EuiButtonIcon,{iconType:"plusInCircle","aria-label":"Add Argument",onClick:handleClick})};return _react2.default.createElement(_popover.Popover,{id:"arg-add-popover",panelClassName:"canvasArg__addPopover",panelPaddingSize:"none",button:button},function(_ref2){var closePopover=_ref2.closePopover;return options.map(function(opt){return _react2.default.createElement(_arg_add.ArgAdd,{key:opt.arg.name+"-add",displayName:opt.arg.displayName,help:opt.arg.help,onValueAdd:function onValueAdd(){opt.onValueAdd();closePopover()}})})})};ArgAddPopover.propTypes={options:_propTypes.PropTypes.array.isRequired}},3250:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Popover=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Popover=exports.Popover=function(_Component){_inherits(Popover,_Component);function Popover(){var _ref;var _temp,_this,_ret;_classCallCheck(this,Popover);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=Popover.__proto__||Object.getPrototypeOf(Popover)).call.apply(_ref,[this].concat(args))),_this),_this.state={isPopoverOpen:false},_this.handleClick=function(){_this.setState(function(state){return{isPopoverOpen:!state.isPopoverOpen}})},_this.closePopover=function(){_this.setState({isPopoverOpen:false})},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(Popover,[{key:"componentDidMount",value:function componentDidMount(){if(this.props.isOpen){this.setState({isPopoverOpen:true})}}},{key:"render",value:function render(){var _this2=this;var _props=this.props,button=_props.button,children=_props.children,tooltip=_props.tooltip,tooltipPosition=_props.tooltipPosition,rest=_objectWithoutProperties(_props,["button","children","tooltip","tooltipPosition"]);var wrappedButton=function wrappedButton(handleClick){if(!_this2.state.isPopoverOpen&&tooltip.length){return _react2.default.createElement(_eui.EuiToolTip,{position:tooltipPosition,content:tooltip},button(handleClick))}return button(handleClick)};var appWrapper=document.querySelector(".app-wrapper");return _react2.default.createElement(_eui.EuiPopover,_extends({},rest,{button:wrappedButton(this.handleClick),isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,container:appWrapper}),children({closePopover:this.closePopover}))}}]);return Popover}(_react.Component);Popover.propTypes={isOpen:_propTypes2.default.bool,ownFocus:_propTypes2.default.bool,button:_propTypes2.default.func.isRequired,children:_propTypes2.default.func.isRequired,tooltip:_propTypes2.default.string,tooltipPosition:_propTypes2.default.oneOf(["top","bottom","left","right"])};Popover.defaultProps={isOpen:false,ownFocus:true,tooltip:"",tooltipPosition:"top"}},3251:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgAdd=undefined;var _recompose=__webpack_require__(19);var _arg_add=__webpack_require__(3252);var ArgAdd=exports.ArgAdd=(0,_recompose.pure)(_arg_add.ArgAdd)},3252:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgAdd=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ArgAdd=exports.ArgAdd=function ArgAdd(_ref){var onValueAdd=_ref.onValueAdd,displayName=_ref.displayName,help=_ref.help;return _react2.default.createElement("button",{className:"canvasArg__add",onClick:onValueAdd},_react2.default.createElement(_eui.EuiDescriptionList,{compressed:true},_react2.default.createElement(_eui.EuiDescriptionListTitle,null,displayName),_react2.default.createElement(_eui.EuiDescriptionListDescription,null,_react2.default.createElement("small",null,help))))};ArgAdd.propTypes={displayName:_propTypes2.default.string,help:_propTypes2.default.string,onValueAdd:_propTypes2.default.func}},3253:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SidebarSectionTitle=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SidebarSectionTitle=exports.SidebarSectionTitle=function SidebarSectionTitle(_ref){var title=_ref.title,tip=_ref.tip,children=_ref.children;var formattedTitle=_react2.default.createElement(_eui.EuiTitle,{size:"xs"},_react2.default.createElement("h4",null,title));var renderTitle=function renderTitle(){if(tip){return _react2.default.createElement(_eui.EuiToolTip,{position:"left",content:tip},formattedTitle)}return formattedTitle};return _react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},renderTitle(tip)),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},children))};SidebarSectionTitle.propTypes={children:_propTypes2.default.node,title:_propTypes2.default.string,tip:_propTypes2.default.string}},3254:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgForm=undefined;var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _assets=__webpack_require__(304);var _workpad=__webpack_require__(33);var _arg_form=__webpack_require__(3255);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ArgForm=exports.ArgForm=(0,_recompose.compose)((0,_recompose.withState)("label","setLabel",function(_ref){var label=_ref.label,argTypeInstance=_ref.argTypeInstance;return label||argTypeInstance.displayName||argTypeInstance.name}),(0,_recompose.withState)("resolvedArgValue","setResolvedArgValue"),(0,_recompose.withState)("renderError","setRenderError",false),(0,_recompose.lifecycle)({componentDidUpdate:function componentDidUpdate(prevProps){if(prevProps.templateProps.argValue!==this.props.templateProps.argValue){this.props.setRenderError(false);this.props.setResolvedArgValue()}}}),(0,_reactRedux.connect)(function(state){return{workpad:(0,_workpad.getWorkpadInfo)(state),assets:(0,_assets.getAssets)(state)}}))(_arg_form.ArgForm);ArgForm.propTypes={label:_propTypes2.default.string,argTypeInstance:_propTypes2.default.shape({name:_propTypes2.default.string.isRequired,displayName:_propTypes2.default.string,expanded:_propTypes2.default.bool}).isRequired}},3255:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgForm=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _error_boundary=__webpack_require__(1166);var _arg_simple_form=__webpack_require__(3256);var _arg_template_form=__webpack_require__(3258);var _simple_failure=__webpack_require__(3259);var _advanced_failure=__webpack_require__(3260);var _arg_label=__webpack_require__(1167);var _pending_arg_value=__webpack_require__(3262);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var branches=[(0,_recompose.branch)(function(_ref){var argTypeInstance=_ref.argTypeInstance,resolvedArgValue=_ref.resolvedArgValue;var argType=argTypeInstance.argType;if(!argType.resolveArgValue){return false}return typeof resolvedArgValue==="undefined"},(0,_recompose.renderComponent)(_pending_arg_value.PendingArgValue))];var ArgFormComponent=function(_PureComponent){_inherits(ArgFormComponent,_PureComponent);function ArgFormComponent(){_classCallCheck(this,ArgFormComponent);return _possibleConstructorReturn(this,(ArgFormComponent.__proto__||Object.getPrototypeOf(ArgFormComponent)).apply(this,arguments))}_createClass(ArgFormComponent,[{key:"componentDidMount",value:function componentDidMount(){this._isMounted=true}},{key:"componentWillUnmount",value:function componentWillUnmount(){this._isMounted=false}},{key:"render",value:function render(){var _this2=this;var _props=this.props,argId=_props.argId,argTypeInstance=_props.argTypeInstance,templateProps=_props.templateProps,valueMissing=_props.valueMissing,label=_props.label,_setLabel=_props.setLabel,onValueRemove=_props.onValueRemove,workpad=_props.workpad,assets=_props.assets,renderError=_props.renderError,setRenderError=_props.setRenderError,resolvedArgValue=_props.resolvedArgValue;return _react2.default.createElement(_error_boundary.ErrorBoundary,null,function(_ref2){var error=_ref2.error,_resetErrorState=_ref2.resetErrorState;var _argTypeInstance$argT=argTypeInstance.argType,template=_argTypeInstance$argT.template,simpleTemplate=_argTypeInstance$argT.simpleTemplate;var hasError=Boolean(error)||renderError;var argumentProps=_extends({},templateProps,{resolvedArgValue:resolvedArgValue,defaultValue:argTypeInstance.default,renderError:function renderError(){Promise.resolve().then(function(){_this2._isMounted&&setRenderError(true)})},error:hasError,setLabel:function setLabel(label){return _this2._isMounted&&_setLabel(label)},resetErrorState:function resetErrorState(){_resetErrorState();_this2._isMounted&&setRenderError(false)},label:label,workpad:workpad,argId:argId,assets:assets});var expandableLabel=Boolean(hasError||template);var simpleArg=_react2.default.createElement(_arg_simple_form.ArgSimpleForm,{required:argTypeInstance.required,valueMissing:valueMissing,onRemove:onValueRemove},_react2.default.createElement(_arg_template_form.ArgTemplateForm,{template:simpleTemplate,errorTemplate:_simple_failure.SimpleFailure,error:hasError,argumentProps:argumentProps}));var extendedArg=_react2.default.createElement("div",{className:"canvasArg--controls"},_react2.default.createElement(_arg_template_form.ArgTemplateForm,{template:template,errorTemplate:_advanced_failure.AdvancedFailure,error:hasError,argumentProps:argumentProps}));return _react2.default.createElement("div",{className:"canvasArg "+(expandableLabel?"canvasArg--expandable":null)},_react2.default.createElement(_arg_label.ArgLabel,{className:"resolved",argId:argId,label:label,help:argTypeInstance.help,expandable:expandableLabel,simpleArg:simpleArg,initialIsOpen:!simpleTemplate},extendedArg))})}}]);return ArgFormComponent}(_react.PureComponent);ArgFormComponent.propTypes={argId:_propTypes2.default.string.isRequired,workpad:_propTypes2.default.object.isRequired,argTypeInstance:_propTypes2.default.shape({argType:_propTypes2.default.object.isRequired,help:_propTypes2.default.string.isRequired,required:_propTypes2.default.bool,default:_propTypes2.default.any}).isRequired,templateProps:_propTypes2.default.object,valueMissing:_propTypes2.default.bool,label:_propTypes2.default.string,setLabel:_propTypes2.default.func.isRequired,expand:_propTypes2.default.bool,setExpand:_propTypes2.default.func,onValueRemove:_propTypes2.default.func,renderError:_propTypes2.default.bool.isRequired,setRenderError:_propTypes2.default.func.isRequired,resolvedArgValue:_propTypes2.default.any};var ArgForm=exports.ArgForm=_recompose.compose.apply(undefined,branches)(ArgFormComponent)},3256:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgSimpleForm=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _tooltip_icon=__webpack_require__(710);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ArgSimpleForm=exports.ArgSimpleForm=function ArgSimpleForm(_ref){var children=_ref.children,required=_ref.required,valueMissing=_ref.valueMissing,onRemove=_ref.onRemove;return _react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s",className:"canvasArg__form"},_react2.default.createElement(_eui.EuiFlexItem,null,children),valueMissing&&_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_tooltip_icon.TooltipIcon,{position:"left",icon:"error",content:"This argument is required, you should specify a value."})),!required&&_react2.default.createElement(_eui.EuiButtonIcon,{color:"danger",onClick:onRemove,iconType:"trash","aria-label":"Remove",className:"canvasArg__remove"}))};ArgSimpleForm.propTypes={children:_propTypes2.default.node,required:_propTypes2.default.bool,valueMissing:_propTypes2.default.bool,onRemove:_propTypes2.default.func.isRequired}},3257:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TooltipIcon=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}var TooltipIcon=function TooltipIcon(_ref){var _ref$icon=_ref.icon,icon=_ref$icon===undefined?"info":_ref$icon,rest=_objectWithoutProperties(_ref,["icon"]);var icons={error:{type:"alert",color:"danger"},warning:{type:"alert",color:"warning"},info:{type:"iInCircle",color:"default"}};if(!Object.keys(icons).includes(icon)){throw new Error("Unsupported icon type: "+icon)}return _react2.default.createElement(_eui.EuiIconTip,_extends({},rest,{type:icons[icon].type,color:icons[icon].color}))};exports.TooltipIcon=TooltipIcon;TooltipIcon.propTypes={icon:_propTypes.PropTypes.string}},3258:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgTemplateForm=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _render_to_dom=__webpack_require__(707);var _expression_form_handlers=__webpack_require__(1162);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ArgTemplateFormComponent=function(_React$Component){_inherits(ArgTemplateFormComponent,_React$Component);function ArgTemplateFormComponent(){var _ref;var _temp,_this,_ret;_classCallCheck(this,ArgTemplateFormComponent);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=ArgTemplateFormComponent.__proto__||Object.getPrototypeOf(ArgTemplateFormComponent)).call.apply(_ref,[this].concat(args))),_this),_this.renderTemplate=function(domNode){var _this$props=_this.props,template=_this$props.template,argumentProps=_this$props.argumentProps,handlers=_this$props.handlers;if(template){return template(domNode,argumentProps,handlers)}},_this.renderErrorTemplate=function(){var _this$props2=_this.props,errorTemplate=_this$props2.errorTemplate,argumentProps=_this$props2.argumentProps;return _react2.default.createElement(errorTemplate,argumentProps)},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(ArgTemplateFormComponent,[{key:"componentWillUpdate",value:function componentWillUpdate(prevProps){if(this.props.error!==prevProps.error){this.props.handlers.destroy()}}},{key:"componentDidUpdate",value:function componentDidUpdate(){if(this.props.error){return this.renderErrorTemplate()}this.renderTemplate(this.domNode)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.handlers.destroy()}},{key:"render",value:function render(){var _this2=this;var _props=this.props,template=_props.template,error=_props.error;if(error){return this.renderErrorTemplate()}if(!template){return null}return _react2.default.createElement(_render_to_dom.RenderToDom,{render:function render(domNode){_this2.domNode=domNode;_this2.renderTemplate(domNode)}})}}]);return ArgTemplateFormComponent}(_react2.default.Component);ArgTemplateFormComponent.propTypes={template:_propTypes2.default.func,argumentProps:_propTypes2.default.shape({valueMissing:_propTypes2.default.bool,label:_propTypes2.default.string,setLabel:_propTypes2.default.func.isRequired,expand:_propTypes2.default.bool,setExpand:_propTypes2.default.func,onValueRemove:_propTypes2.default.func,resetErrorState:_propTypes2.default.func.isRequired,renderError:_propTypes2.default.func.isRequired}),handlers:_propTypes2.default.object.isRequired,error:_propTypes2.default.oneOfType([_propTypes2.default.object,_propTypes2.default.bool]).isRequired,errorTemplate:_propTypes2.default.oneOfType([_propTypes2.default.element,_propTypes2.default.func]).isRequired};ArgTemplateFormComponent.domNode=null;var ArgTemplateForm=exports.ArgTemplateForm=(0,_recompose.compose)((0,_recompose.withPropsOnChange)(function(){return false},function(){return{expressionFormHandlers:new _expression_form_handlers.ExpressionFormHandlers}}),(0,_recompose.withProps)(function(_ref2){var handlers=_ref2.handlers,expressionFormHandlers=_ref2.expressionFormHandlers;return{handlers:Object.assign(expressionFormHandlers,handlers)}}))(ArgTemplateFormComponent)},3259:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SimpleFailure=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _tooltip_icon=__webpack_require__(710);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SimpleFailure=exports.SimpleFailure=function SimpleFailure(){return _react2.default.createElement("div",{className:"canvasArg--error canvasArg--error-simple"},_react2.default.createElement(_tooltip_icon.TooltipIcon,{position:"left",icon:"warning",content:"The interface for this argument could not parse the value, so a fallback input is being used"}))}},3260:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AdvancedFailure=exports.AdvancedFailureComponent=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _eui=__webpack_require__(2);var _common=__webpack_require__(41);var _stateful_prop=__webpack_require__(3261);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AdvancedFailureComponent=exports.AdvancedFailureComponent=function AdvancedFailureComponent(props){var onValueChange=props.onValueChange,defaultValue=props.defaultValue,argExpression=props.argExpression,updateArgExpression=props.updateArgExpression,resetErrorState=props.resetErrorState,valid=props.valid,argId=props.argId;var valueChange=function valueChange(ev){ev.preventDefault();resetErrorState();if(valid){return onValueChange((0,_common.fromExpression)(argExpression.trim(),"argument"))}};var confirmReset=function confirmReset(ev){ev.preventDefault();resetErrorState();onValueChange((0,_common.fromExpression)(defaultValue,"argument"))};return _react2.default.createElement(_eui.EuiForm,null,_react2.default.createElement(_eui.EuiFormRow,{id:argId,isInvalid:!valid,error:"Invalid Expression"},_react2.default.createElement(_eui.EuiTextArea,{id:argId,isInvalid:!valid,value:argExpression,onChange:updateArgExpression,rows:3})),_react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiButton,{disabled:!valid,onClick:function onClick(e){return valueChange(e)},size:"s",type:"submit"},"Apply"),defaultValue&&defaultValue.length&&_react2.default.createElement(_eui.EuiButtonEmpty,{size:"s",color:"danger",onClick:confirmReset},"Reset")))};AdvancedFailureComponent.propTypes={defaultValue:_propTypes2.default.string,onValueChange:_propTypes2.default.func.isRequired,argExpression:_propTypes2.default.string.isRequired,updateArgExpression:_propTypes2.default.func.isRequired,resetErrorState:_propTypes2.default.func.isRequired,valid:_propTypes2.default.bool.isRequired,argId:_propTypes2.default.string.isRequired};var AdvancedFailure=exports.AdvancedFailure=(0,_recompose.compose)((0,_recompose.withProps)(function(_ref){var argValue=_ref.argValue;return{argExpression:(0,_common.toExpression)(argValue,"argument")}}),(0,_stateful_prop.createStatefulPropHoc)("argExpression","updateArgExpression"),(0,_recompose.withPropsOnChange)(["argExpression"],function(_ref2){var argExpression=_ref2.argExpression;return{valid:function(){try{(0,_common.fromExpression)(argExpression,"argument");return true}catch(e){return false}}()}}))(AdvancedFailureComponent);AdvancedFailure.propTypes={argValue:_propTypes2.default.any.isRequired}},3261:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();exports.createStatefulPropHoc=createStatefulPropHoc;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var getDisplayName=function getDisplayName(Comp){return Comp.displayName||Comp.name||"UnnamedComponent"};function createStatefulPropHoc(fieldname){var updater=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"updateValue";return function(Comp){var WrappedControlledInput=function(_React$PureComponent){_inherits(WrappedControlledInput,_React$PureComponent);function WrappedControlledInput(props){_classCallCheck(this,WrappedControlledInput);var _this=_possibleConstructorReturn(this,(WrappedControlledInput.__proto__||Object.getPrototypeOf(WrappedControlledInput)).call(this,props));_this.handleChange=function(ev){if(ev.target){_this.setState({value:ev.target.value})}else{_this.setState({value:ev})}};_this.state={value:props[fieldname]};return _this}_createClass(WrappedControlledInput,[{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){this.setState({value:nextProps[fieldname]})}},{key:"render",value:function render(){var _extends2;var passedProps=_extends({},this.props,(_extends2={},_defineProperty(_extends2,fieldname,this.state.value),_defineProperty(_extends2,updater,this.handleChange),_extends2));return _react2.default.createElement(Comp,passedProps)}}]);return WrappedControlledInput}(_react2.default.PureComponent);WrappedControlledInput.propTypes=_defineProperty({},fieldname,_propTypes2.default.any);WrappedControlledInput.displayName="statefulProp("+getDisplayName(Comp)+")";return WrappedControlledInput}}},3262:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PendingArgValue=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _loading=__webpack_require__(505);var _arg_label=__webpack_require__(1167);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var PendingArgValue=exports.PendingArgValue=function(_React$PureComponent){_inherits(PendingArgValue,_React$PureComponent);function PendingArgValue(){_classCallCheck(this,PendingArgValue);return _possibleConstructorReturn(this,(PendingArgValue.__proto__||Object.getPrototypeOf(PendingArgValue)).apply(this,arguments))}_createClass(PendingArgValue,[{key:"componentDidMount",value:function componentDidMount(){var _props=this.props,setResolvedArgValue=_props.setResolvedArgValue,templateProps=_props.templateProps;var argResolver=templateProps.argResolver,argValue=templateProps.argValue;if(argValue==null){setResolvedArgValue(null)}else{argResolver(argValue).then(function(val){return setResolvedArgValue(val!=null?val:null)}).catch(function(){return setResolvedArgValue(null)})}}},{key:"render",value:function render(){var _props2=this.props,label=_props2.label,argTypeInstance=_props2.argTypeInstance;return _react2.default.createElement("div",{className:"canvasArg"},_react2.default.createElement(_arg_label.ArgLabel,{className:"resolve-pending",label:label,help:argTypeInstance.help,expandable:false},_react2.default.createElement("div",{className:"canvasArg--pending"},_react2.default.createElement(_loading.Loading,{animated:true,text:"Loading"}))))}}]);return PendingArgValue}(_react2.default.PureComponent);PendingArgValue.propTypes={label:_propTypes2.default.string,argTypeInstance:_propTypes2.default.shape({help:_propTypes2.default.string.isRequired}).isRequired,setResolvedArgValue:_propTypes2.default.func.isRequired,templateProps:_propTypes2.default.shape({argResolver:_propTypes2.default.func.isRequired,argValue:_propTypes2.default.any})}},3263:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Loading=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _hex_to_rgb=__webpack_require__(3264);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var Loading=exports.Loading=function Loading(_ref){var animated=_ref.animated,text=_ref.text,backgroundColor=_ref.backgroundColor;if(animated){return _react2.default.createElement("div",{className:"canvasLoading"},text&&_react2.default.createElement("span",null,text,""),_react2.default.createElement(_eui.EuiLoadingSpinner,{size:"m"}))}var rgb=(0,_hex_to_rgb.hexToRgb)(backgroundColor);return _react2.default.createElement("div",{className:"canvasLoading"},text&&_react2.default.createElement("span",null,text,""),_react2.default.createElement(_eui.EuiIcon,{color:rgb&&_eui.isColorDark.apply(undefined,_toConsumableArray(rgb))?"ghost":"text",type:"clock"}))};Loading.propTypes={animated:_propTypes2.default.bool,backgroundColor:_propTypes2.default.string,text:_propTypes2.default.string};Loading.defaultProps={animated:false,backgroundColor:"#000000",text:""}},3264:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var hexToRgb=exports.hexToRgb=function hexToRgb(hex){var shorthandHexColor=/^#?([a-f\d]{1})([a-f\d]{1})([a-f\d]{1})$/i;var hexColor=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;var shorthandMatches=shorthandHexColor.exec(hex);if(shorthandMatches){return shorthandMatches.slice(1,4).map(function(hex){return parseInt(hex+hex,16)})}var hexMatches=hexColor.exec(hex);if(hexMatches){return hexMatches.slice(1,4).map(function(hex){return parseInt(hex,16)})}return null}},3265:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Datasource=undefined;var _recompose=__webpack_require__(19);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _no_datasource=__webpack_require__(3266);var _datasource_component=__webpack_require__(3267);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var branches=[(0,_recompose.branch)(function(_ref){var datasource=_ref.datasource,stateDatasource=_ref.stateDatasource;return!datasource||!stateDatasource},(0,_recompose.renderComponent)(_no_datasource.NoDatasource))];var Datasource=exports.Datasource=_recompose.compose.apply(undefined,branches)(_datasource_component.DatasourceComponent);Datasource.propTypes={args:_propTypes2.default.object,datasource:_propTypes2.default.object,unknownArgs:_propTypes2.default.array}},3266:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NoDatasource=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var NoDatasource=exports.NoDatasource=function NoDatasource(){return _react2.default.createElement(_eui.EuiPanel,null,_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("h4",null,"No data source present"),_react2.default.createElement("p",null,"This element does not have an attached data source. This is usually because the element is an image or other static asset. If that's not the case you might want to check your expression to make sure it is not malformed.")))};NoDatasource.propTypes={done:_propTypes2.default.func}},3267:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatasourceComponent=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(1);var _datasource_selector=__webpack_require__(3268);var _datasource_preview=__webpack_require__(3269);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DatasourceComponent=exports.DatasourceComponent=function(_PureComponent){_inherits(DatasourceComponent,_PureComponent);function DatasourceComponent(){var _ref;var _temp,_this,_ret;_classCallCheck(this,DatasourceComponent);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=DatasourceComponent.__proto__||Object.getPrototypeOf(DatasourceComponent)).call.apply(_ref,[this].concat(args))),_this),_initialiseProps.call(_this),_temp),_possibleConstructorReturn(_this,_ret)}_createClass(DatasourceComponent,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var _props=this.props,args=_props.args,resetArgs=_props.resetArgs,datasource=_props.datasource,selectDatasource=_props.selectDatasource;if(!(0,_lodash.isEqual)(prevProps.args,args)){resetArgs()}if(!(0,_lodash.isEqual)(prevProps.datasource,datasource)){selectDatasource(datasource)}}},{key:"render",value:function render(){var _props2=this.props,datasources=_props2.datasources,datasourceDef=_props2.datasourceDef,stateDatasource=_props2.stateDatasource,stateArgs=_props2.stateArgs,updateArgs=_props2.updateArgs,selecting=_props2.selecting,setSelecting=_props2.setSelecting,previewing=_props2.previewing,setPreviewing=_props2.setPreviewing,isInvalid=_props2.isInvalid,setInvalid=_props2.setInvalid;if(selecting){return _react2.default.createElement(_datasource_selector.DatasourceSelector,{datasources:datasources,onSelect:this.setSelectedDatasource})}var datasourcePreview=previewing?_react2.default.createElement(_datasource_preview.DatasourcePreview,{show:previewing,done:function done(){return setPreviewing(false)},function:this.getDatasourceFunctionNode(stateDatasource.name,stateArgs)}):null;return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiPanel,null,_react2.default.createElement(_eui.EuiButtonEmpty,{iconSide:"right",flush:"left",iconType:"sortRight",onClick:function onClick(){return setSelecting(!selecting)}},"Change your data source"),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),stateDatasource.render({args:stateArgs,updateArgs:updateArgs,datasourceDef:datasourceDef,isInvalid:isInvalid,setInvalid:setInvalid}),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButton,{size:"s",onClick:function onClick(){return setPreviewing(true)},icon:"check"},"Preview")),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButton,{disabled:isInvalid,size:"s",color:"secondary",fill:true,onClick:this.save,icon:"check"},"Save")))),datasourcePreview)}}]);return DatasourceComponent}(_react.PureComponent);DatasourceComponent.propTypes={args:_propTypes2.default.object.isRequired,datasources:_propTypes2.default.array.isRequired,datasource:_propTypes2.default.object.isRequired,datasourceDef:_propTypes2.default.object.isRequired,stateDatasource:_propTypes2.default.shape({name:_propTypes2.default.string.isRequired,render:_propTypes2.default.func.isRequired}).isRequired,selectDatasource:_propTypes2.default.func,setDatasourceAst:_propTypes2.default.func,stateArgs:_propTypes2.default.object.isRequired,updateArgs:_propTypes2.default.func,resetArgs:_propTypes2.default.func.isRequired,selecting:_propTypes2.default.bool,setSelecting:_propTypes2.default.func,previewing:_propTypes2.default.bool,setPreviewing:_propTypes2.default.func,isInvalid:_propTypes2.default.bool,setInvalid:_propTypes2.default.func};var _initialiseProps=function _initialiseProps(){var _this2=this;this.getDatasourceFunctionNode=function(name,args){return{arguments:args,function:name,type:"function"}};this.setSelectedDatasource=function(value){var _props3=_this2.props,datasource=_props3.datasource,resetArgs=_props3.resetArgs,updateArgs=_props3.updateArgs,selectDatasource=_props3.selectDatasource,datasources=_props3.datasources,setSelecting=_props3.setSelecting;if(datasource.name===value){resetArgs&&resetArgs()}else{updateArgs&&updateArgs({})}selectDatasource&&selectDatasource(datasources.find(function(d){return d.name===value}));setSelecting(false)};this.save=function(){var _props4=_this2.props,stateDatasource=_props4.stateDatasource,stateArgs=_props4.stateArgs,setDatasourceAst=_props4.setDatasourceAst;var datasourceAst=_this2.getDatasourceFunctionNode(stateDatasource.name,stateArgs);setDatasourceAst&&setDatasourceAst(datasourceAst)}}},3268:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatasourceSelector=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DatasourceSelector=exports.DatasourceSelector=function DatasourceSelector(_ref){var onSelect=_ref.onSelect,datasources=_ref.datasources;return _react2.default.createElement("div",null,datasources.map(function(d){return _react2.default.createElement(_eui.EuiCard,{key:d.name,title:d.displayName,icon:_react2.default.createElement(_eui.EuiIcon,{type:d.image,size:"xxl"}),onClick:function onClick(){return onSelect(d.name)},description:d.help,layout:"horizontal",className:"canvasDataSource__card"})}))};DatasourceSelector.propTypes={onSelect:_propTypes2.default.func.isRequired,datasources:_propTypes2.default.array.isRequired}},3269:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatasourcePreview=undefined;var _interpreter=__webpack_require__(352);var _recompose=__webpack_require__(19);var _propTypes=__webpack_require__(6);var _loading=__webpack_require__(505);var _datasource_preview=__webpack_require__(3270);var DatasourcePreview=exports.DatasourcePreview=(0,_recompose.compose)(_recompose.pure,(0,_recompose.withState)("datatable","setDatatable"),(0,_recompose.lifecycle)({componentDidMount:function componentDidMount(){(0,_interpreter.interpretAst)({type:"expression",chain:[this.props.function]}).then(this.props.setDatatable)}}),(0,_recompose.branch)(function(_ref){var datatable=_ref.datatable;return!datatable},(0,_recompose.renderComponent)(_loading.Loading)))(_datasource_preview.DatasourcePreview);DatasourcePreview.propTypes={function:_propTypes.PropTypes.object}},3270:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DatasourcePreview=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _datatable=__webpack_require__(3271);var _error=__webpack_require__(3273);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var DatasourcePreview=exports.DatasourcePreview=function DatasourcePreview(_ref){var done=_ref.done,datatable=_ref.datatable;return _react2.default.createElement(_eui.EuiOverlayMask,null,_react2.default.createElement(_eui.EuiModal,{onClose:done,maxWidth:"1000px"},_react2.default.createElement(_eui.EuiModalHeader,null,_react2.default.createElement(_eui.EuiModalHeaderTitle,null,"Datasource Preview")),_react2.default.createElement(_eui.EuiModalBody,{className:"canvasDatasourcePreview"},_react2.default.createElement(_eui.EuiText,{size:"s",color:"subdued"},_react2.default.createElement("p",null,"Click ",_react2.default.createElement("strong",null,"Save")," in the sidebar to use this data.")),datatable.type==="error"?_react2.default.createElement(_error.Error,{payload:datatable}):_react2.default.createElement(_eui.EuiPanel,{className:"canvasDatasourcePreview__panel"},datatable.rows.length>0?_react2.default.createElement(_datatable.Datatable,{datatable:datatable,showHeader:true,paginate:true}):_react2.default.createElement(_eui.EuiEmptyPrompt,{title:_react2.default.createElement("h2",null,"No documents found"),titleSize:"s",body:_react2.default.createElement("p",null,"We couldn't find any documents matching your search criteria.",_react2.default.createElement("br",null)," Check your datasource settings and try again.")})))))};DatasourcePreview.propTypes={datatable:_propTypes2.default.object,done:_propTypes2.default.func}},3271:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Datatable=undefined;var _recompose=__webpack_require__(19);var _datatable=__webpack_require__(3272);var Datatable=exports.Datatable=(0,_recompose.pure)(_datatable.Datatable)},3272:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Datatable=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _eui=__webpack_require__(2);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _moment=__webpack_require__(13);var _moment2=_interopRequireDefault(_moment);var _paginate=__webpack_require__(704);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var getIcon=function getIcon(type){if(type===null){return}var icon=void 0;switch(type){case"string":icon="string";break;case"number":icon="number";break;case"date":icon="calendar";break;case"boolean":icon="invert";break;default:icon="questionInCircle"}return _react2.default.createElement(_eui.EuiIcon,{type:icon,color:"subdued"})};var getColumnName=function getColumnName(col){return typeof col==="string"?col:col.name};var getColumnType=function getColumnType(col){return col.type||null};var getFormattedValue=function getFormattedValue(val,type){if(type==="date"){return(0,_moment2.default)(val).format()}return String(val)};var Datatable=exports.Datatable=function Datatable(_ref){var datatable=_ref.datatable,perPage=_ref.perPage,paginate=_ref.paginate,showHeader=_ref.showHeader;return _react2.default.createElement(_paginate.Paginate,{rows:datatable.rows,perPage:perPage||10},function(_ref2){var rows=_ref2.rows,setPage=_ref2.setPage,pageNumber=_ref2.pageNumber,totalPages=_ref2.totalPages;return _react2.default.createElement("div",{className:"canvasDataTable"},_react2.default.createElement("div",{className:"canvasDataTable__tableWrapper"},_react2.default.createElement("table",{className:"canvasDataTable__table"},!showHeader?null:_react2.default.createElement("thead",{className:"canvasDataTable__thead"},_react2.default.createElement("tr",{className:"canvasDataTable__tr"},datatable.columns.map(function(col){return _react2.default.createElement("th",{key:"header-"+getColumnName(col),className:"canvasDataTable__th"},getColumnName(col),"",getIcon(getColumnType(col)))}))),_react2.default.createElement("tbody",{className:"canvasDataTable__tbody"},rows.map(function(row,i){return _react2.default.createElement("tr",{key:i,className:"canvasDataTable__tr"},datatable.columns.map(function(col){return _react2.default.createElement("td",{key:"row-"+i+"-"+getColumnName(col),className:"canvasDataTable__td"},getFormattedValue(row[getColumnName(col)],getColumnType(col)))}))})))),paginate&&_react2.default.createElement("div",{className:"canvasDataTable__footer"},_react2.default.createElement(_eui.EuiPagination,{pageCount:totalPages,activePage:pageNumber,onPageClick:setPage})))})};Datatable.propTypes={datatable:_propTypes2.default.object.isRequired,perPage:_propTypes2.default.number,paginate:_propTypes2.default.bool,showHeader:_propTypes2.default.bool}},3273:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _error=__webpack_require__(3274);Object.defineProperty(exports,"Error",{enumerable:true,get:function get(){return _error.Error}})},3274:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Error=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(1);var _show_debugging=__webpack_require__(3275);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Error=exports.Error=function Error(_ref){var payload=_ref.payload;var message=(0,_lodash.get)(payload,"error.message");return _react2.default.createElement(_eui.EuiCallOut,{style:{maxWidth:500},color:"danger",iconType:"cross",title:"Whoops! Expression failed"},_react2.default.createElement("p",null,message?"Expression failed with the message:":""),message&&_react2.default.createElement("p",{style:{padding:"0 16px"}},message),_react2.default.createElement(_show_debugging.ShowDebugging,{payload:payload}))};Error.propTypes={payload:_propTypes2.default.object.isRequired}},3275:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ShowDebugging=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _eui=__webpack_require__(2);var _debug=__webpack_require__(3276);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ShowDebuggingComponent=function ShowDebuggingComponent(_ref){var payload=_ref.payload,expanded=_ref.expanded,setExpanded=_ref.setExpanded;return true?null:undefined};ShowDebuggingComponent.propTypes={expanded:_propTypes2.default.bool.isRequired,setExpanded:_propTypes2.default.func.isRequired,payload:_propTypes2.default.object.isRequired};var ShowDebugging=exports.ShowDebugging=(0,_recompose.withState)("expanded","setExpanded",false)(ShowDebuggingComponent)},3276:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _debug=__webpack_require__(3277);Object.defineProperty(exports,"Debug",{enumerable:true,get:function get(){return _debug.Debug}})},3277:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Debug=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Debug=exports.Debug=function Debug(_ref){var payload=_ref.payload;return _react2.default.createElement(_eui.EuiCode,{className:"canvasDebug"},_react2.default.createElement("pre",{className:"canvasDebug__content"},JSON.stringify(payload,null,2)))};Debug.propTypes={payload:_propTypes2.default.object.isRequired}},3278:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionFormList=undefined;var _interpreter=__webpack_require__(352);var _recompose=__webpack_require__(19);var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);var _expression_types=__webpack_require__(503);var _function_form_list=__webpack_require__(3279);function normalizeContext(chain){if(!Array.isArray(chain)||!chain.length){return null}return{type:"expression",chain:chain}}function getExpression(ast){return ast!=null&&ast.type==="expression"?(0,_common.toExpression)(ast):ast}function getArgTypeDef(fn){return _expression_types.modelRegistry.get(fn)||_expression_types.viewRegistry.get(fn)||_expression_types.transformRegistry.get(fn)}var functionFormItems=(0,_recompose.withProps)(function(props){var selectedElement=props.element;var FunctionFormChain=(0,_lodash.get)(selectedElement,"ast.chain",[]);var FunctionFormListItems=FunctionFormChain.reduce(function(acc,argType,i){var argTypeDef=getArgTypeDef(argType.function);var prevContext=normalizeContext(acc.context);var nextArg=FunctionFormChain[i+1]||null;if(argTypeDef){var component={args:argType.arguments,argType:argType.function,argTypeDef:argTypeDef,argResolver:function argResolver(argAst){return(0,_interpreter.interpretAst)(argAst,prevContext)},contextExpression:getExpression(prevContext),expressionIndex:i,nextArgType:nextArg&&nextArg.function};acc.mapped.push(component)}acc.context=acc.context.concat(argType);return acc},{mapped:[],context:[]});return{functionFormItems:FunctionFormListItems.mapped}});var FunctionFormList=exports.FunctionFormList=(0,_recompose.compose)(functionFormItems)(_function_form_list.FunctionFormList)},3279:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionFormList=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _function_form=__webpack_require__(3280);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FunctionFormList=exports.FunctionFormList=function FunctionFormList(_ref){var functionFormItems=_ref.functionFormItems;var argTypeComponents=functionFormItems.map(function(functionFormProps){return _react2.default.createElement(_function_form.FunctionForm,_extends({},functionFormProps,{key:functionFormProps.argType+"-"+functionFormProps.expressionIndex}))});return _react2.default.createElement("div",null,argTypeComponents)};FunctionFormList.propTypes={functionFormItems:_propTypes2.default.array.isRequired}},3280:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionForm=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactRedux=__webpack_require__(14);var _find_expression_type=__webpack_require__(3281);var _get_id=__webpack_require__(228);var _assets=__webpack_require__(306);var _elements=__webpack_require__(61);var _workpad=__webpack_require__(33);var _assets2=__webpack_require__(304);var _function_form=__webpack_require__(3282);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}var mapStateToProps=function mapStateToProps(state,_ref){var expressionIndex=_ref.expressionIndex;return{context:(0,_workpad.getContextForIndex)(state,expressionIndex),element:(0,_workpad.getSelectedElement)(state),pageId:(0,_workpad.getSelectedPage)(state),assets:(0,_assets2.getAssets)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch,_ref2){var expressionIndex=_ref2.expressionIndex;return{addArgument:function addArgument(element,pageId){return function(argName,argValue){return function(){dispatch((0,_elements.addArgumentValueAtIndex)({index:expressionIndex,element:element,pageId:pageId,argName:argName,value:argValue}))}}},updateContext:function updateContext(element){return function(){return dispatch((0,_elements.fetchContext)(expressionIndex,element))}},setArgument:function setArgument(element,pageId){return function(argName,valueIndex){return function(value){dispatch((0,_elements.setArgumentAtIndex)({index:expressionIndex,element:element,pageId:pageId,argName:argName,value:value,valueIndex:valueIndex}))}}},deleteArgument:function deleteArgument(element,pageId){return function(argName,argIndex){return function(){dispatch((0,_elements.deleteArgumentAtIndex)({index:expressionIndex,element:element,pageId:pageId,argName:argName,argIndex:argIndex}))}}},onAssetAdd:function onAssetAdd(type,content){var assetId=(0,_get_id.getId)("asset");dispatch((0,_assets.createAsset)(type,content,assetId));return assetId}}};var mergeProps=function mergeProps(stateProps,dispatchProps,ownProps){var element=stateProps.element,pageId=stateProps.pageId,assets=stateProps.assets;var argType=ownProps.argType,nextArgType=ownProps.nextArgType;var updateContext=dispatchProps.updateContext,setArgument=dispatchProps.setArgument,addArgument=dispatchProps.addArgument,deleteArgument=dispatchProps.deleteArgument,_onAssetAdd=dispatchProps.onAssetAdd,dispatchers=_objectWithoutProperties(dispatchProps,["updateContext","setArgument","addArgument","deleteArgument","onAssetAdd"]);return _extends({},stateProps,dispatchers,ownProps,{updateContext:updateContext(element),expressionType:(0,_find_expression_type.findExpressionType)(argType),nextExpressionType:nextArgType?(0,_find_expression_type.findExpressionType)(nextArgType):nextArgType,onValueChange:setArgument(element,pageId),onValueAdd:addArgument(element,pageId),onValueRemove:deleteArgument(element,pageId),onAssetAdd:function onAssetAdd(type,content){var existingId=Object.keys(assets).find(function(assetId){return assets[assetId].type===type&&assets[assetId].value===content});if(existingId){return existingId}return _onAssetAdd(type,content)}})};var FunctionForm=exports.FunctionForm=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,mergeProps)(_function_form.FunctionForm);FunctionForm.propTypes={expressionIndex:_propTypes2.default.number,argType:_propTypes2.default.string,nextArgType:_propTypes2.default.string}},3281:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.findExpressionType=findExpressionType;var _datasource=__webpack_require__(1161);var _transform=__webpack_require__(1163);var _model=__webpack_require__(1169);var _view=__webpack_require__(1170);var expressionTypes=["view","model","transform","datasource"];function findExpressionType(name,type){var checkTypes=expressionTypes.filter(function(expressionType){return type==null||expressionType===type});var matches=checkTypes.reduce(function(acc,checkType){var expression=void 0;switch(checkType){case"view":expression=_view.viewRegistry.get(name);return!expression?acc:acc.concat(expression);case"model":expression=_model.modelRegistry.get(name);return!expression?acc:acc.concat(expression);case"transform":expression=_transform.transformRegistry.get(name);return!expression?acc:acc.concat(expression);case"datasource":expression=_datasource.datasourceRegistry.get(name);return!expression?acc:acc.concat(expression);default:return acc}},[]);if(matches.length>1){throw new Error('Found multiple expressions with name "'+name+'"')}return matches[0]||null}},3282:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionForm=undefined;var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _function_form_component=__webpack_require__(3283);var _function_unknown=__webpack_require__(3284);var _function_form_context_pending=__webpack_require__(3285);var _function_form_context_error=__webpack_require__(3286);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function checkState(state){return function(_ref){var context=_ref.context,expressionType=_ref.expressionType;var matchState=!context||context.state===state;return expressionType&&expressionType.requiresContext&&matchState}}var branches=[(0,_recompose.branch)(function(props){return!props.expressionType},(0,_recompose.renderComponent)(_function_unknown.FunctionUnknown)),(0,_recompose.branch)(checkState("pending"),(0,_recompose.renderComponent)(_function_form_context_pending.FunctionFormContextPending)),(0,_recompose.branch)(checkState("error"),(0,_recompose.renderComponent)(_function_form_context_error.FunctionFormContextError))];var FunctionForm=exports.FunctionForm=_recompose.compose.apply(undefined,branches)(_function_form_component.FunctionFormComponent);FunctionForm.propTypes=_defineProperty({expressionType:_propTypes2.default.object,context:_propTypes2.default.object},"expressionType",_propTypes2.default.object)},3283:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionFormComponent=undefined;var _FunctionFormComponen;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var FunctionFormComponent=exports.FunctionFormComponent=function FunctionFormComponent(props){var passedProps={argResolver:props.argResolver,args:props.args,argType:props.argType,argTypeDef:props.argTypeDef,context:props.context,expressionIndex:props.expressionIndex,expressionType:props.expressionType,nextArgType:props.nextArgType,nextExpressionType:props.nextExpressionType,onAssetAdd:props.onAssetAdd,onValueAdd:props.onValueAdd,onValueChange:props.onValueChange,onValueRemove:props.onValueRemove};return _react2.default.createElement("div",{className:"canvasFunctionForm"},props.expressionType.render(passedProps))};FunctionFormComponent.propTypes=(_FunctionFormComponen={argResolver:_propTypes2.default.func.isRequired,args:_propTypes2.default.object.isRequired,argType:_propTypes2.default.string.isRequired,argTypeDef:_propTypes2.default.object.isRequired,context:_propTypes2.default.object,expressionIndex:_propTypes2.default.number.isRequired,expressionType:_propTypes2.default.object.isRequired,nextArgType:_propTypes2.default.string,nextExpressionType:_propTypes2.default.object,onAssetAdd:_propTypes2.default.func.isRequired,onValueAdd:_propTypes2.default.func.isRequired,onValueChange:_propTypes2.default.func.isRequired},_defineProperty(_FunctionFormComponen,"onValueChange",_propTypes2.default.func.isRequired),_defineProperty(_FunctionFormComponen,"onValueRemove",_propTypes2.default.func.isRequired),_defineProperty(_FunctionFormComponen,"onValueRemove",_propTypes2.default.func.isRequired),_FunctionFormComponen)},3284:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionUnknown=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FunctionUnknown=exports.FunctionUnknown=function FunctionUnknown(_ref){var argType=_ref.argType;return _react2.default.createElement("div",{className:"canvasFunctionForm canvasFunctionForm--unknown-expression"},'Unknown expression type "',argType,'"')};FunctionUnknown.propTypes={argType:_propTypes2.default.string}},3285:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionFormContextPending=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _loading=__webpack_require__(505);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var FunctionFormContextPending=exports.FunctionFormContextPending=function(_React$PureComponent){_inherits(FunctionFormContextPending,_React$PureComponent);function FunctionFormContextPending(){var _ref;var _temp,_this,_ret;_classCallCheck(this,FunctionFormContextPending);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=FunctionFormContextPending.__proto__||Object.getPrototypeOf(FunctionFormContextPending)).call.apply(_ref,[this].concat(args))),_this),_this.fetchContext=function(props){var force=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var expressionType=props.expressionType,context=props.context,updateContext=props.updateContext;if(force||context==null&&expressionType.requiresContext){updateContext()}},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(FunctionFormContextPending,[{key:"componentDidMount",value:function componentDidMount(){this.fetchContext(this.props)}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(newProps){var oldContext=this.props.contextExpression;var newContext=newProps.contextExpression;var forceUpdate=newProps.expressionType.requiresContext&&oldContext!==newContext;this.fetchContext(newProps,forceUpdate)}},{key:"render",value:function render(){return _react2.default.createElement("div",{className:"canvasFunctionForm canvasFunctionForm--loading"},_react2.default.createElement(_loading.Loading,null))}}]);return FunctionFormContextPending}(_react2.default.PureComponent);FunctionFormContextPending.propTypes={context:_propTypes2.default.object,contextExpression:_propTypes2.default.string,expressionType:_propTypes2.default.object.isRequired,updateContext:_propTypes2.default.func.isRequired}},3286:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionFormContextError=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FunctionFormContextError=exports.FunctionFormContextError=function FunctionFormContextError(_ref){var context=_ref.context;return _react2.default.createElement("div",{className:"canvasFunctionForm canvasFunctionForm--error"},"ERROR: ",context.error)};FunctionFormContextError.propTypes={context:_propTypes2.default.object}},3287:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GlobalConfig=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _page_config=__webpack_require__(3288);var _workpad_config=__webpack_require__(3303);var _sidebar_section=__webpack_require__(1164);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var GlobalConfig=exports.GlobalConfig=function GlobalConfig(){return _react2.default.createElement("div",{className:"canvasSidebar"},_react2.default.createElement(_sidebar_section.SidebarSection,null,_react2.default.createElement(_workpad_config.WorkpadConfig,null)),_react2.default.createElement(_sidebar_section.SidebarSection,null,_react2.default.createElement(_page_config.PageConfig,null)))}},3288:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PageConfig=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _reactRedux=__webpack_require__(14);var _lodash=__webpack_require__(1);var _transitions_registry=__webpack_require__(711);var _workpad=__webpack_require__(33);var _pages=__webpack_require__(305);var _page_config=__webpack_require__(3290);var mapStateToProps=function mapStateToProps(state){var pageIndex=(0,_workpad.getSelectedPageIndex)(state);var page=(0,_workpad.getPages)(state)[pageIndex];return{page:page,pageIndex:pageIndex}};var mapDispatchToProps={stylePage:_pages.stylePage,setPageTransition:_pages.setPageTransition};var mergeProps=function mergeProps(stateProps,dispatchProps){return{pageIndex:stateProps.pageIndex,setBackground:function setBackground(background){var itsTheNewStyle=_extends({},stateProps.page.style,{background:background});dispatchProps.stylePage(stateProps.page.id,itsTheNewStyle)},background:(0,_lodash.get)(stateProps,"page.style.background"),transition:_transitions_registry.transitionsRegistry.get((0,_lodash.get)(stateProps,"page.transition.name")),transitions:[{value:"",text:"None"}].concat(_transitions_registry.transitionsRegistry.toArray().map(function(_ref){var name=_ref.name,displayName=_ref.displayName;return{value:name,text:displayName}})),setTransition:function setTransition(name){dispatchProps.setPageTransition(stateProps.page.id,{name:name})}}};var PageConfig=exports.PageConfig=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,mergeProps)(_page_config.PageConfig)},3289:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Transition=Transition;function Transition(config){this.name=config.name;this.displayName=config.displayName||this.name;this.help=config.help||"";this.enter=config.enter||"";this.exit=config.exit||""}},3290:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PageConfig=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _color_picker_mini=__webpack_require__(354);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var PageConfig=exports.PageConfig=function PageConfig(_ref){var pageIndex=_ref.pageIndex,setBackground=_ref.setBackground,background=_ref.background,transition=_ref.transition,transitions=_ref.transitions,setTransition=_ref.setTransition;return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiTitle,{size:"xs"},_react2.default.createElement("h4",null,"Page")),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiFormRow,{label:"Background color"},_react2.default.createElement(_color_picker_mini.ColorPickerMini,{onChange:setBackground,value:background})),pageIndex>0?_react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiFormRow,{label:"Transition",compressed:true},_react2.default.createElement(_eui.EuiSelect,{value:transition?transition.name:"",options:transitions,onChange:function onChange(e){return setTransition(e.target.value)}})),transition?_react2.default.createElement(_eui.EuiFormRow,{label:"Preview"},_react2.default.createElement(_eui.EuiCard,{title:"",description:"",className:transition.enter,style:{height:"72px",width:"128px",background:background,animationDuration:"1s"}})):""):"")};PageConfig.propTypes={pageIndex:_propTypes2.default.number.isRequired,background:_propTypes2.default.string,setBackground:_propTypes2.default.func.isRequired,transition:_propTypes2.default.shape({name:_propTypes2.default.string}),transitions:_propTypes2.default.arrayOf(_propTypes2.default.shape({text:_propTypes2.default.string.isRequired,value:_propTypes2.default.string.isRequired})).isRequired,setTransition:_propTypes2.default.func.isRequired}},3291:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorPickerMini=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _popover=__webpack_require__(504);var _color_picker=__webpack_require__(1171);var _color_dot=__webpack_require__(1172);var _workpad_color_picker=__webpack_require__(3301);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ColorPickerMini=exports.ColorPickerMini=function ColorPickerMini(_ref){var onChange=_ref.onChange,value=_ref.value,anchorPosition=_ref.anchorPosition,colors=_ref.colors;var button=function button(handleClick){return _react2.default.createElement(_eui.EuiLink,{style:{fontSize:0},onClick:handleClick},_react2.default.createElement(_color_dot.ColorDot,{value:value,clickable:true}))};return _react2.default.createElement(_popover.Popover,{id:"color-picker-mini-popover",panelClassName:"canvas canvasColorPickerMini__popover",button:button,anchorPosition:anchorPosition},function(){return colors?_react2.default.createElement(_color_picker.ColorPicker,{onChange:onChange,value:value,colors:colors}):_react2.default.createElement(_workpad_color_picker.WorkpadColorPicker,{onChange:onChange,value:value})})};ColorPickerMini.propTypes={colors:_propTypes2.default.array,value:_propTypes2.default.string,onChange:_propTypes2.default.func,anchorPosition:_propTypes2.default.string}},3292:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorPicker=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _color_palette=__webpack_require__(3293);var _color_manager=__webpack_require__(3299);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ColorPicker=exports.ColorPicker=function ColorPicker(_ref){var onChange=_ref.onChange,value=_ref.value,colors=_ref.colors,addColor=_ref.addColor,removeColor=_ref.removeColor;return _react2.default.createElement("div",null,_react2.default.createElement(_color_palette.ColorPalette,{onChange:onChange,value:value,colors:colors}),_react2.default.createElement(_color_manager.ColorManager,{onChange:onChange,value:value,addColor:addColor,removeColor:removeColor}))};ColorPicker.propTypes={value:_propTypes2.default.string,onChange:_propTypes2.default.func,colors:_propTypes2.default.array,addColor:_propTypes2.default.func,removeColor:_propTypes2.default.func}},3293:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorPalette=undefined;var _recompose=__webpack_require__(19);var _color_palette=__webpack_require__(3294);var ColorPalette=exports.ColorPalette=(0,_recompose.pure)(_color_palette.ColorPalette)},3294:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorPalette=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _readable_color=__webpack_require__(3295);var _color_dot=__webpack_require__(1172);var _item_grid=__webpack_require__(3297);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ColorPalette=exports.ColorPalette=function ColorPalette(_ref){var value=_ref.value,colors=_ref.colors,colorsPerRow=_ref.colorsPerRow,onChange=_ref.onChange;return _react2.default.createElement("div",{className:"canvasColorPalette"},_react2.default.createElement(_item_grid.ItemGrid,{items:colors,itemsPerRow:colorsPerRow||6},function(_ref2){var color=_ref2.item;return _react2.default.createElement(_eui.EuiLink,{style:{fontSize:0},key:color,onClick:function onClick(){return onChange(color)},className:"canvasColorPalette__dot"},_react2.default.createElement(_color_dot.ColorDot,{value:color},color===value&&_react2.default.createElement(_eui.EuiIcon,{type:"check",className:"selected-color",color:(0,_readable_color.readableColor)(value)})))}))};ColorPalette.propTypes={colors:_propTypes2.default.array.isRequired,onChange:_propTypes2.default.func.isRequired,value:_propTypes2.default.string,colorsPerRow:_propTypes2.default.number}},3295:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.readableColor=readableColor;var _chromaJs=__webpack_require__(5014);var _chromaJs2=_interopRequireDefault(_chromaJs);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function readableColor(background,light,dark){light=light||"#FFF";dark=dark||"#333";try{return _chromaJs2.default.contrast(background,"#000")<7?light:dark}catch(e){return dark}}},3297:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ItemGrid=undefined;var _recompose=__webpack_require__(19);var _item_grid=__webpack_require__(3298);var ItemGrid=exports.ItemGrid=(0,_recompose.pure)(_item_grid.ItemGrid)},3298:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ItemGrid=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _lodash=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var defaultPerRow=6;var ItemGrid=exports.ItemGrid=function ItemGrid(_ref){var items=_ref.items,itemsPerRow=_ref.itemsPerRow,children=_ref.children;if(!items){return null}var rows=items.reduce(function(rows,item){if((0,_lodash.last)(rows).length>=(itemsPerRow||defaultPerRow)){rows.push([])}(0,_lodash.last)(rows).push(children({item:item}));return rows},[[]]);return rows.map(function(row,i){return _react2.default.createElement("div",{key:"item-grid-row-"+i,className:"item-grid-row"},row)})};ItemGrid.propTypes={items:_propTypes2.default.array.isRequired,itemsPerRow:_propTypes2.default.oneOfType([_propTypes2.default.number,_propTypes2.default.string]),children:_propTypes2.default.func.isRequired}},3299:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorManager=undefined;var _recompose=__webpack_require__(19);var _color_manager=__webpack_require__(3300);var ColorManager=exports.ColorManager=(0,_recompose.compose)((0,_recompose.withState)("adding","setAdding",false))(_color_manager.ColorManager)},33:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};exports.getWorkpad=getWorkpad;exports.getWorkpadPersisted=getWorkpadPersisted;exports.getWorkpadInfo=getWorkpadInfo;exports.isWriteable=isWriteable;exports.getSelectedPageIndex=getSelectedPageIndex;exports.getSelectedPage=getSelectedPage;exports.getPages=getPages;exports.getPageById=getPageById;exports.getPageIndexById=getPageIndexById;exports.getWorkpadName=getWorkpadName;exports.getWorkpadColors=getWorkpadColors;exports.getAllElements=getAllElements;exports.getGlobalFilterExpression=getGlobalFilterExpression;exports.getSelectedElementId=getSelectedElementId;exports.getSelectedElement=getSelectedElement;exports.getElements=getElements;exports.getNodes=getNodes;exports.getElementById=getElementById;exports.getNodeById=getNodeById;exports.getResolvedArgs=getResolvedArgs;exports.getSelectedResolvedArgs=getSelectedResolvedArgs;exports.getContextForIndex=getContextForIndex;exports.getRefreshInterval=getRefreshInterval;var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);var _modify_path=__webpack_require__(499);var _assets=__webpack_require__(304);var workpadRoot="persistent.workpad";var appendAst=function appendAst(element){return _extends({},element,{ast:(0,_common.safeElementFromExpression)(element.expression)})};function getWorkpad(state){return(0,_lodash.get)(state,workpadRoot)}function getWorkpadPersisted(state){return _extends({},getWorkpad(state),{assets:(0,_assets.getAssets)(state)})}function getWorkpadInfo(state){return(0,_lodash.omit)(getWorkpad(state),["pages"])}function isWriteable(state){return(0,_lodash.get)(state,(0,_modify_path.append)(workpadRoot,"isWriteable"),true)}function getSelectedPageIndex(state){return(0,_lodash.get)(state,(0,_modify_path.append)(workpadRoot,"page"))}function getSelectedPage(state){var pageIndex=getSelectedPageIndex(state);var pages=getPages(state);return(0,_lodash.get)(pages,"["+pageIndex+"].id")}function getPages(state){return(0,_lodash.get)(state,(0,_modify_path.append)(workpadRoot,"pages"),[])}function getPageById(state,id){var pages=getPages(state);return pages.find(function(page){return page.id===id})}function getPageIndexById(state,id){var pages=getPages(state);return pages.findIndex(function(page){return page.id===id})}function getWorkpadName(state){return(0,_lodash.get)(state,(0,_modify_path.append)(workpadRoot,"name"))}function getWorkpadColors(state){return(0,_lodash.get)(state,(0,_modify_path.append)(workpadRoot,"colors"))}function getAllElements(state){return getPages(state).reduce(function(elements,page){return elements.concat(page.elements)},[])}function getGlobalFilterExpression(state){return getAllElements(state).map(function(el){return el.filter}).filter(function(str){return str!=null&&str.length}).join(" | ")}function getSelectedElementId(state){return(0,_lodash.get)(state,"transient.selectedElement")}function getSelectedElement(state){return getElementById(state,getSelectedElementId(state))}function getElements(state,pageId){var withAst=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var id=pageId||getSelectedPage(state);if(!id){return[]}var page=getPageById(state,id);var elements=(0,_lodash.get)(page,"elements");if(!elements){return[]}if(!withAst){return elements.map(function(el){return(0,_lodash.omit)(el,["ast"])})}return elements.map(appendAst)}var augment=function augment(type){return function(n){return _extends({},n,{position:_extends({},n.position,{type:type})},type==="group"&&{expression:'shape fill="rgba(255,255,255,0)" | render'})}};var getNodesOfPage=function getNodesOfPage(page){return(0,_lodash.get)(page,"elements").map(augment("element")).concat(((0,_lodash.get)(page,"groups")||[]).map(augment("group")))};function getNodes(state,pageId){var withAst=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var id=pageId||getSelectedPage(state);if(!id){return[]}var page=getPageById(state,id);var elements=getNodesOfPage(page);if(!elements){return[]}if(!withAst){return elements.map(function(el){return(0,_lodash.omit)(el,["ast"])})}return elements.map(appendAst)}function getElementById(state,id,pageId){var element=getElements(state,pageId,[]).find(function(el){return el.id===id});if(element){return appendAst(element)}}function getNodeById(state,id,pageId){var group=getNodes(state,pageId,[]).find(function(el){return el.id===id});if(group){return appendAst(group)}}function getResolvedArgs(state,elementId,path){if(!elementId){return}var args=(0,_lodash.get)(state,["transient","resolvedArgs",elementId]);if(path){return(0,_lodash.get)(args,path)}return args}function getSelectedResolvedArgs(state,path){return getResolvedArgs(state,getSelectedElementId(state),path)}function getContextForIndex(state,index){return getSelectedResolvedArgs(state,["expressionContext",index-1])}function getRefreshInterval(state){return(0,_lodash.get)(state,"transient.refresh.interval",0)}},3300:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorManager=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _color_dot=__webpack_require__(1173);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ColorManager=exports.ColorManager=function ColorManager(_ref){var value=_ref.value,addColor=_ref.addColor,removeColor=_ref.removeColor,_onChange=_ref.onChange;return _react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},_react2.default.createElement(_eui.EuiFlexItem,{grow:1},_react2.default.createElement(_color_dot.ColorDot,{value:value})),_react2.default.createElement(_eui.EuiFlexItem,{grow:5,style:{display:"inline-block"}},_react2.default.createElement(_eui.EuiFieldText,{compressed:true,value:value||"",placeholder:"#hex color",onChange:function onChange(e){return _onChange(e.target.value)}})),(addColor||removeColor)&&_react2.default.createElement(_eui.EuiFlexItem,{grow:false},addColor&&_react2.default.createElement(_eui.EuiButtonIcon,{"aria-label":"Add Color",iconType:"plusInCircle",onClick:function onClick(){return addColor(value)}}),removeColor&&_react2.default.createElement(_eui.EuiButtonIcon,{"aria-label":"Remove Color",iconType:"minusInCircle",onClick:function onClick(){return removeColor(value)}})))};ColorManager.propTypes={value:_propTypes2.default.string,addColor:_propTypes2.default.func,removeColor:_propTypes2.default.func,onChange:_propTypes2.default.func.isRequired}},3301:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadColorPicker=undefined;var _reactRedux=__webpack_require__(14);var _workpad=__webpack_require__(33);var _workpad2=__webpack_require__(180);var _workpad_color_picker=__webpack_require__(3302);var mapStateToProps=function mapStateToProps(state){return{colors:(0,_workpad.getWorkpadColors)(state)}};var mapDispatchToProps={addColor:_workpad2.addColor,removeColor:_workpad2.removeColor};var WorkpadColorPicker=exports.WorkpadColorPicker=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(_workpad_color_picker.WorkpadColorPicker)},3302:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadColorPicker=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _color_picker=__webpack_require__(1171);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkpadColorPicker=exports.WorkpadColorPicker=function WorkpadColorPicker(_ref){var onChange=_ref.onChange,value=_ref.value,colors=_ref.colors,addColor=_ref.addColor,removeColor=_ref.removeColor;return _react2.default.createElement("div",null,_react2.default.createElement(_color_picker.ColorPicker,{onChange:onChange,value:value,colors:colors,addColor:addColor,removeColor:removeColor}))};WorkpadColorPicker.propTypes={value:_propTypes2.default.string,onChange:_propTypes2.default.func,colors:_propTypes2.default.array,addColor:_propTypes2.default.func,removeColor:_propTypes2.default.func}},3303:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadConfig=undefined;var _reactRedux=__webpack_require__(14);var _lodash=__webpack_require__(1);var _workpad=__webpack_require__(180);var _workpad2=__webpack_require__(33);var _constants=__webpack_require__(229);var _workpad_config=__webpack_require__(3304);var mapStateToProps=function mapStateToProps(state){var workpad=(0,_workpad2.getWorkpad)(state);return{name:(0,_lodash.get)(workpad,"name"),size:{width:(0,_lodash.get)(workpad,"width"),height:(0,_lodash.get)(workpad,"height")},css:(0,_lodash.get)(workpad,"css",_constants.DEFAULT_WORKPAD_CSS)}};var mapDispatchToProps={setSize:function setSize(size){return(0,_workpad.sizeWorkpad)(size)},setName:function setName(name){return(0,_workpad.setName)(name)},setWorkpadCSS:function setWorkpadCSS(css){return(0,_workpad.setWorkpadCSS)(css)}};var WorkpadConfig=exports.WorkpadConfig=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(_workpad_config.WorkpadConfig)},3304:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadConfig=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _constants=__webpack_require__(229);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var WorkpadConfig=exports.WorkpadConfig=function(_PureComponent){_inherits(WorkpadConfig,_PureComponent);function WorkpadConfig(){var _ref;var _temp,_this,_ret;_classCallCheck(this,WorkpadConfig);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=WorkpadConfig.__proto__||Object.getPrototypeOf(WorkpadConfig)).call.apply(_ref,[this].concat(args))),_this),_this.state={css:_this.props.css},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(WorkpadConfig,[{key:"render",value:function render(){var _this2=this;var _props=this.props,size=_props.size,name=_props.name,setSize=_props.setSize,setName=_props.setName,setWorkpadCSS=_props.setWorkpadCSS;var css=this.state.css;var rotate=function rotate(){return setSize({width:size.height,height:size.width})};var badges=[{name:"1080p",size:{height:1080,width:1920}},{name:"720p",size:{height:720,width:1280}},{name:"A4",size:{height:842,width:590}},{name:"US Letter",size:{height:792,width:612}}];return _react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiTitle,{size:"xs"},_react2.default.createElement("h4",null,"Workpad")),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiFormRow,{label:"Name",compressed:true},_react2.default.createElement(_eui.EuiFieldText,{value:name,onChange:function onChange(e){return setName(e.target.value)}})),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiFormRow,{label:"Width",compressed:true},_react2.default.createElement(_eui.EuiFieldNumber,{onChange:function onChange(e){return setSize({width:Number(e.target.value),height:size.height})},value:size.width}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiFormRow,{hasEmptyLabelSpace:true},_react2.default.createElement(_eui.EuiToolTip,{position:"bottom",content:"Flip the width and height"},_react2.default.createElement(_eui.EuiButtonIcon,{iconType:"merge",color:"text",onClick:rotate,"aria-label":"Swap Page Dimensions",style:{marginBottom:12}})))),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiFormRow,{label:"Height",compressed:true},_react2.default.createElement(_eui.EuiFieldNumber,{onChange:function onChange(e){return setSize({height:Number(e.target.value),width:size.width})},value:size.height})))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement("div",null,badges.map(function(badge,i){return _react2.default.createElement(_eui.EuiBadge,{key:"page-size-badge-"+i,color:"hollow",onClick:function onClick(){return setSize(badge.size)},"aria-label":"Preset Page Size: "+badge.name,onClickAriaLabel:"Set page size to "+badge.name},badge.name)})),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiAccordion,{id:"accordion-global-css",className:"canvasArg__accordion",buttonContent:_react2.default.createElement(_eui.EuiToolTip,{content:"Apply styles to all pages in this workpad",position:"left",className:"canvasArg__tooltip"},_react2.default.createElement(_eui.EuiText,{size:"s",color:"subdued"},"Global CSS overrides"))},_react2.default.createElement("div",{className:"canvasArg__content"},_react2.default.createElement(_eui.EuiTextArea,{"aria-label":"Apply styles to all pages in this workpad",value:css,onChange:function onChange(e){return _this2.setState({css:e.target.value})},rows:10}),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiButton,{size:"s",onClick:function onClick(){return setWorkpadCSS(css||_constants.DEFAULT_WORKPAD_CSS)}},"Apply stylesheet"),_react2.default.createElement(_eui.EuiSpacer,{size:"xs"}))))}}]);return WorkpadConfig}(_react.PureComponent);WorkpadConfig.propTypes={size:_propTypes2.default.object.isRequired,name:_propTypes2.default.string.isRequired,css:_propTypes2.default.string,setSize:_propTypes2.default.func.isRequired,setName:_propTypes2.default.func.isRequired,setWorkpadCSS:_propTypes2.default.func.isRequired}},3305:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Toolbar=undefined;var _reactRedux=__webpack_require__(14);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _workpad=__webpack_require__(33);var _toolbar=__webpack_require__(3306);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var mapStateToProps=function mapStateToProps(state){return{workpadName:(0,_workpad.getWorkpadName)(state),workpadId:(0,_workpad.getWorkpad)(state).id,totalPages:(0,_workpad.getWorkpad)(state).pages.length,selectedPageNumber:(0,_workpad.getSelectedPageIndex)(state)+1,selectedElement:(0,_workpad.getSelectedElement)(state)}};var Toolbar=exports.Toolbar=(0,_recompose.compose)((0,_reactRedux.connect)(mapStateToProps),(0,_recompose.getContext)({router:_propTypes2.default.object}),(0,_recompose.withHandlers)({nextPage:function nextPage(props){return function(){var pageNumber=Math.min(props.selectedPageNumber+1,props.totalPages);props.router.navigateTo("loadWorkpad",{id:props.workpadId,page:pageNumber})}},previousPage:function previousPage(props){return function(){var pageNumber=Math.max(1,props.selectedPageNumber-1);props.router.navigateTo("loadWorkpad",{id:props.workpadId,page:pageNumber})}}}),(0,_recompose.withState)("tray","setTray",function(props){return props.tray}),(0,_recompose.withState)("showWorkpadManager","setShowWorkpadManager",false))(_toolbar.Toolbar)},3306:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Toolbar=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _navbar=__webpack_require__(3307);var _workpad_manager=__webpack_require__(1155);var _page_manager=__webpack_require__(3309);var _expression=__webpack_require__(3317);var _tray=__webpack_require__(3329);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Toolbar=exports.Toolbar=function Toolbar(props){var selectedElement=props.selectedElement,tray=props.tray,setTray=props.setTray,previousPage=props.previousPage,nextPage=props.nextPage,selectedPageNumber=props.selectedPageNumber,workpadName=props.workpadName,totalPages=props.totalPages,showWorkpadManager=props.showWorkpadManager,setShowWorkpadManager=props.setShowWorkpadManager;var elementIsSelected=Boolean(selectedElement);var done=function done(){return setTray(null)};var showHideTray=function showHideTray(exp){if(tray&&tray===exp){return done()}setTray(exp)};var closeWorkpadManager=function closeWorkpadManager(){return setShowWorkpadManager(false)};var openWorkpadManager=function openWorkpadManager(){return setShowWorkpadManager(true)};var workpadManager=_react2.default.createElement(_eui.EuiOverlayMask,null,_react2.default.createElement(_eui.EuiModal,{onClose:closeWorkpadManager,className:"canvasModal--fixedSize",maxWidth:"1000px"},_react2.default.createElement(_workpad_manager.WorkpadManager,{onClose:closeWorkpadManager}),_react2.default.createElement(_eui.EuiModalFooter,null,_react2.default.createElement(_eui.EuiButton,{size:"s",onClick:closeWorkpadManager},"Dismiss"))));var trays={pageManager:_react2.default.createElement(_page_manager.PageManager,{previousPage:previousPage}),expression:!elementIsSelected?null:_react2.default.createElement(_expression.Expression,{done:done})};return _react2.default.createElement("div",{className:"canvasToolbar hide-for-sharing"},trays[tray]&&_react2.default.createElement(_tray.Tray,{done:done},trays[tray]),_react2.default.createElement(_navbar.Navbar,null,_react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"none",className:"canvasToolbar__controls"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonEmpty,{color:"text",iconType:"grid",onClick:function onClick(){return openWorkpadManager()}},workpadName)),_react2.default.createElement(_eui.EuiFlexItem,{grow:false}),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonIcon,{color:"text",onClick:previousPage,iconType:"arrowLeft",disabled:selectedPageNumber<=1,"aria-label":"Previous Page"})),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonEmpty,{color:"text",onClick:function onClick(){return showHideTray("pageManager")}},"Page ",selectedPageNumber,totalPages>1?" of "+totalPages:null)),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonIcon,{color:"text",onClick:nextPage,iconType:"arrowRight",disabled:selectedPageNumber>=totalPages,"aria-label":"Next Page"})),_react2.default.createElement(_eui.EuiFlexItem,null),elementIsSelected&&_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonEmpty,{color:"text",iconType:"editorCodeBlock",onClick:function onClick(){return showHideTray("expression")}},"Expression editor")))),showWorkpadManager&&workpadManager)};Toolbar.propTypes={workpadName:_propTypes2.default.string,tray:_propTypes2.default.node,setTray:_propTypes2.default.func.isRequired,nextPage:_propTypes2.default.func.isRequired,previousPage:_propTypes2.default.func.isRequired,selectedPageNumber:_propTypes2.default.number.isRequired,totalPages:_propTypes2.default.number.isRequired,selectedElement:_propTypes2.default.object,showWorkpadManager:_propTypes2.default.bool.isRequired,setShowWorkpadManager:_propTypes2.default.func.isRequired}},3307:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Navbar=undefined;var _recompose=__webpack_require__(19);var _navbar=__webpack_require__(3308);var Navbar=exports.Navbar=(0,_recompose.pure)(_navbar.Navbar)},3308:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Navbar=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Navbar=exports.Navbar=function Navbar(_ref){var children=_ref.children;return _react2.default.createElement("div",{className:"canvasNavbar"},children)};Navbar.propTypes={children:_propTypes2.default.node}},3309:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PageManager=undefined;var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _pages=__webpack_require__(305);var pageActions=_interopRequireWildcard(_pages);var _app=__webpack_require__(72);var _workpad=__webpack_require__(33);var _constants=__webpack_require__(229);var _page_manager=__webpack_require__(3310);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}var mapStateToProps=function mapStateToProps(state){var _getWorkpad=(0,_workpad.getWorkpad)(state),id=_getWorkpad.id,css=_getWorkpad.css;return{isWriteable:(0,_workpad.isWriteable)(state)&&(0,_app.canUserWrite)(state),pages:(0,_workpad.getPages)(state),selectedPage:(0,_workpad.getSelectedPage)(state),workpadId:id,workpadCSS:css||_constants.DEFAULT_WORKPAD_CSS}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{addPage:function addPage(){return dispatch(pageActions.addPage())},movePage:function movePage(id,position){return dispatch(pageActions.movePage(id,position))},duplicatePage:function duplicatePage(id){return dispatch(pageActions.duplicatePage(id))},removePage:function removePage(id){return dispatch(pageActions.removePage(id))}}};var PageManager=exports.PageManager=(0,_recompose.compose)((0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps),(0,_recompose.withState)("deleteId","setDeleteId",null))(_page_manager.PageManager)},3310:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PageManager=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _reactBeautifulDnd=__webpack_require__(5015);var _styleIt=__webpack_require__(715);var _styleIt2=_interopRequireDefault(_styleIt);var _confirm_modal=__webpack_require__(702);var _link=__webpack_require__(703);var _page_preview=__webpack_require__(3312);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var PageManager=exports.PageManager=function(_React$PureComponent){_inherits(PageManager,_React$PureComponent);function PageManager(){var _ref;var _temp,_this,_ret;_classCallCheck(this,PageManager);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=PageManager.__proto__||Object.getPrototypeOf(PageManager)).call.apply(_ref,[this].concat(args))),_this),_this.state={showTrayPop:true},_this.scrollToActivePage=function(){if(_this.activePageRef&&_this.pageListRef){if(!_this.pageListRef.scrollTo){return}var pageOffset=_this.activePageRef.offsetLeft;var _this$activePageRef$g=_this.activePageRef.getBoundingClientRect(),pageLeft=_this$activePageRef$g.left,pageRight=_this$activePageRef$g.right,pageWidth=_this$activePageRef$g.width;var _this$pageListRef$get=_this.pageListRef.getBoundingClientRect(),listLeft=_this$pageListRef$get.left,listRight=_this$pageListRef$get.right,listWidth=_this$pageListRef$get.width;if(pageLeft<listLeft){_this.pageListRef.scrollTo({left:pageOffset,behavior:"smooth"})}if(pageRight>listRight){_this.pageListRef.scrollTo({left:pageOffset-listWidth+pageWidth,behavior:"smooth"})}}},_this.confirmDelete=function(pageId){_this._isMounted&&_this.props.setDeleteId(pageId)},_this.resetDelete=function(){return _this._isMounted&&_this.props.setDeleteId(null)},_this.doDelete=function(){var _this$props=_this.props,previousPage=_this$props.previousPage,removePage=_this$props.removePage,deleteId=_this$props.deleteId,selectedPage=_this$props.selectedPage;_this.resetDelete();if(deleteId===selectedPage){previousPage()}removePage(deleteId)},_this.onDragEnd=function(_ref2){var pageId=_ref2.draggableId,source=_ref2.source,destination=_ref2.destination;if(!destination){return}var position=destination.index-source.index;_this.props.movePage(pageId,position)},_this.renderPage=function(page,i){var _this$props2=_this.props,isWriteable=_this$props2.isWriteable,selectedPage=_this$props2.selectedPage,workpadId=_this$props2.workpadId,movePage=_this$props2.movePage,duplicatePage=_this$props2.duplicatePage,workpadCSS=_this$props2.workpadCSS;var pageNumber=i+1;return _react2.default.createElement(_reactBeautifulDnd.Draggable,{key:page.id,draggableId:page.id,index:i,isDragDisabled:!isWriteable},function(provided){return _react2.default.createElement("div",_extends({key:page.id,className:"canvasPageManager__page "+(page.id===selectedPage?"canvasPageManager__page-isActive":""),ref:function ref(el){if(page.id===selectedPage){_this.activePageRef=el}provided.innerRef(el)}},provided.draggableProps,provided.dragHandleProps),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiText,{size:"xs",className:"canvasPageManager__pageNumber"},pageNumber)),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_link.Link,{name:"loadWorkpad",params:{id:workpadId,page:pageNumber},"aria-label":"Load page number "+pageNumber},_styleIt2.default.it(workpadCSS,_react2.default.createElement("div",null,_react2.default.createElement(_page_preview.PagePreview,{isWriteable:isWriteable,page:page,height:100,pageNumber:pageNumber,movePage:movePage,selectedPage:selectedPage,duplicatePage:duplicatePage,confirmDelete:_this.confirmDelete})))))))})},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(PageManager,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;this._isMounted=true;setTimeout(function(){_this2.scrollToActivePage();_this2._isMounted&&_this2.setState({showTrayPop:false})},1e3)}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){if(prevProps.selectedPage!==this.props.selectedPage){setTimeout(this.scrollToActivePage,0)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){this._isMounted=false}},{key:"render",value:function render(){var _this3=this;var _props=this.props,pages=_props.pages,addPage=_props.addPage,deleteId=_props.deleteId,isWriteable=_props.isWriteable;var showTrayPop=this.state.showTrayPop;return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"none",className:"canvasPageManager"},_react2.default.createElement(_eui.EuiFlexItem,{className:"canvasPageManager__pages"},_react2.default.createElement(_reactBeautifulDnd.DragDropContext,{onDragEnd:this.onDragEnd},_react2.default.createElement(_reactBeautifulDnd.Droppable,{droppableId:"droppable-page-manager",direction:"horizontal"},function(provided){return _react2.default.createElement("div",_extends({className:"canvasPageManager__pageList "+(showTrayPop?"canvasPageManager--trayPop":""),ref:function ref(el){_this3.pageListRef=el;provided.innerRef(el)}},provided.droppableProps),pages.map(_this3.renderPage),provided.placeholder)}))),isWriteable&&_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{anchorClassName:"canvasPageManager__addPageTip",content:"Add a new page to this workpad",position:"left"},_react2.default.createElement("button",{onClick:addPage,className:"canvasPageManager__addPage"},_react2.default.createElement(_eui.EuiIcon,{color:"ghost",type:"plusInCircle",size:"l"}))))),_react2.default.createElement(_confirm_modal.ConfirmModal,{isOpen:deleteId!=null,title:"Remove Page",message:"Are you sure you want to remove this page?",confirmButtonText:"Remove",onConfirm:this.doDelete,onCancel:this.resetDelete}))}}]);return PageManager}(_react2.default.PureComponent);PageManager.propTypes={isWriteable:_propTypes2.default.bool.isRequired,pages:_propTypes2.default.array.isRequired,workpadId:_propTypes2.default.string.isRequired,addPage:_propTypes2.default.func.isRequired,movePage:_propTypes2.default.func.isRequired,previousPage:_propTypes2.default.func.isRequired,duplicatePage:_propTypes2.default.func.isRequired,removePage:_propTypes2.default.func.isRequired,selectedPage:_propTypes2.default.string,deleteId:_propTypes2.default.string,setDeleteId:_propTypes2.default.func.isRequired,workpadCSS:_propTypes2.default.string}},3312:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _page_preview=__webpack_require__(3313);Object.defineProperty(exports,"PagePreview",{enumerable:true,get:function get(){return _page_preview.PagePreview}})},3313:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PagePreview=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _dom_preview=__webpack_require__(3314);var _page_controls=__webpack_require__(3316);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var PagePreview=exports.PagePreview=function PagePreview(_ref){var isWriteable=_ref.isWriteable,page=_ref.page,pageNumber=_ref.pageNumber,height=_ref.height,duplicatePage=_ref.duplicatePage,confirmDelete=_ref.confirmDelete;return _react2.default.createElement("div",{className:"canvasPageManager__pagePreview",style:{backgroundColor:page.style.background}},_react2.default.createElement(_dom_preview.DomPreview,{elementId:page.id,pageNumber:pageNumber,height:height}),isWriteable&&_react2.default.createElement(_page_controls.PageControls,{pageId:page.id,pageNumber:pageNumber,onDuplicate:duplicatePage,onDelete:confirmDelete}))};PagePreview.propTypes={isWriteable:_propTypes2.default.bool.isRequired,page:_propTypes2.default.shape({id:_propTypes2.default.string.isRequired,style:_propTypes2.default.shape({background:_propTypes2.default.string.isRequired}).isRequired}).isRequired,height:_propTypes2.default.number.isRequired,pageNumber:_propTypes2.default.number.isRequired,duplicatePage:_propTypes2.default.func.isRequired,confirmDelete:_propTypes2.default.func.isRequired}},3314:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DomPreview=undefined;var _dom_preview=__webpack_require__(3315);var DomPreview=exports.DomPreview=_dom_preview.DomPreview},3315:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DomPreview=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _lodash=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DomPreview=exports.DomPreview=function(_React$Component){_inherits(DomPreview,_React$Component);function DomPreview(){var _ref;var _temp,_this,_ret;_classCallCheck(this,DomPreview);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=DomPreview.__proto__||Object.getPrototypeOf(DomPreview)).call.apply(_ref,[this].concat(args))),_this),_this.update=function(original){return function(){if(!_this.content||!_this.container){return}var thumb=original.cloneNode(true);var originalStyle=window.getComputedStyle(original,null);var originalWidth=parseInt(originalStyle.getPropertyValue("width"),10);var originalHeight=parseInt(originalStyle.getPropertyValue("height"),10);var thumbHeight=_this.props.height;var scale=thumbHeight/originalHeight;var thumbWidth=originalWidth*scale;if(_this.content.hasChildNodes()){_this.content.removeChild(_this.content.firstChild)}_this.content.appendChild(thumb);_this.content.style.cssText="transform: scale("+scale+"); transform-origin: top left;";_this.container.style.cssText="width: "+thumbWidth+"px; height: "+thumbHeight+"px;";var originalCanvas=original.querySelectorAll("canvas");var thumbCanvas=thumb.querySelectorAll("canvas");if(originalCanvas.length>0){Array.from(originalCanvas).map(function(img,i){return thumbCanvas[i].getContext("2d").drawImage(img,0,0)})}}},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(DomPreview,[{key:"componentDidMount",value:function componentDidMount(){var original=document.querySelector("#"+this.props.elementId);var update=this.update(original);update();var slowUpdate=(0,_lodash.debounce)(update,250);this.observer=new MutationObserver(slowUpdate);var config={attributes:true,childList:true,subtree:true};this.observer.observe(original,config)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.observer.disconnect()}},{key:"render",value:function render(){var _this2=this;return _react2.default.createElement("div",{ref:function ref(container){_this2.container=container},className:"dom-preview"},_react2.default.createElement("div",{ref:function ref(content){_this2.content=content}}))}}]);return DomPreview}(_react2.default.Component);DomPreview.container=null;DomPreview.content=null;DomPreview.observer=null;DomPreview.propTypes={elementId:_propTypes2.default.string.isRequired,height:_propTypes2.default.number.isRequired}},3316:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PageControls=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var PageControls=exports.PageControls=function PageControls(_ref){var pageId=_ref.pageId,onDelete=_ref.onDelete,onDuplicate=_ref.onDuplicate;var handleDuplicate=function handleDuplicate(ev){ev.preventDefault();onDuplicate(pageId)};var handleDelete=function handleDelete(ev){ev.preventDefault();onDelete(pageId)};return _react2.default.createElement(_eui.EuiFlexGroup,{className:"canvasPageManager__controls",gutterSize:"xs",justifyContent:"spaceBetween"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{content:"Duplicate"},_react2.default.createElement(_eui.EuiButtonIcon,{iconType:"document","aria-label":"Duplicate Page",onClick:handleDuplicate}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{content:"Delete"},_react2.default.createElement(_eui.EuiButtonIcon,{color:"danger",iconType:"trash","aria-label":"Delete Page",onClick:handleDelete}))))};PageControls.propTypes={pageId:_propTypes2.default.string.isRequired,pageNumber:_propTypes2.default.number.isRequired,onDelete:_propTypes2.default.func.isRequired,onDuplicate:_propTypes2.default.func.isRequired}},3317:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Expression=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _storage=__webpack_require__(381);var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _common=__webpack_require__(41);var _workpad=__webpack_require__(33);var _elements=__webpack_require__(61);var _function_definitions=__webpack_require__(3318);var _get_window=__webpack_require__(245);var _constants=__webpack_require__(229);var _element_not_selected=__webpack_require__(3320);var _expression=__webpack_require__(3321);var storage=new _storage.Storage((0,_get_window.getWindow)().localStorage);var mapStateToProps=function mapStateToProps(state){return{pageId:(0,_workpad.getSelectedPage)(state),element:(0,_workpad.getSelectedElement)(state),functionDefinitionsPromise:(0,_function_definitions.getFunctionDefinitions)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setExpression:function setExpression(elementId,pageId){return function(expression){dispatch((0,_elements.flushContext)(elementId));dispatch((0,_elements.setExpression)(expression,elementId,pageId))}}}};var mergeProps=function mergeProps(stateProps,dispatchProps,ownProps){var element=stateProps.element,pageId=stateProps.pageId;var allProps=_extends({},ownProps,stateProps,dispatchProps);if(!element){return allProps}var expression=element.expression;return _extends({},allProps,{expression:expression,setExpression:dispatchProps.setExpression(element.id,pageId)})};var expressionLifecycle=(0,_recompose.lifecycle)({componentWillReceiveProps:function componentWillReceiveProps(_ref){var formState=_ref.formState,setFormState=_ref.setFormState,expression=_ref.expression;if(this.props.expression!==expression&&expression!==formState.expression){setFormState({expression:expression,dirty:false})}},componentDidMount:function componentDidMount(){var _props=this.props,functionDefinitionsPromise=_props.functionDefinitionsPromise,setFunctionDefinitions=_props.setFunctionDefinitions;functionDefinitionsPromise.then(function(defs){return setFunctionDefinitions(defs)})}});var Expression=(0,_recompose.compose)((0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,mergeProps),(0,_recompose.withState)("functionDefinitions","setFunctionDefinitions",[]),(0,_recompose.withState)("formState","setFormState",function(_ref2){var expression=_ref2.expression;return{expression:expression,dirty:false}}),(0,_recompose.withState)("isAutocompleteEnabled","setIsAutocompleteEnabled",function(){var setting=storage.get(_constants.LOCALSTORAGE_AUTOCOMPLETE_ENABLED);return setting===null?true:setting}),(0,_recompose.withHandlers)({toggleAutocompleteEnabled:function toggleAutocompleteEnabled(_ref3){var isAutocompleteEnabled=_ref3.isAutocompleteEnabled,setIsAutocompleteEnabled=_ref3.setIsAutocompleteEnabled;return function(){storage.set(_constants.LOCALSTORAGE_AUTOCOMPLETE_ENABLED,!isAutocompleteEnabled);setIsAutocompleteEnabled(!isAutocompleteEnabled)}},updateValue:function updateValue(_ref4){var setFormState=_ref4.setFormState;return function(expression){setFormState({expression:expression,dirty:true})}},setExpression:function setExpression(_ref5){var _setExpression2=_ref5.setExpression,setFormState=_ref5.setFormState;return function(exp){setFormState(function(prev){return _extends({},prev,{dirty:false})});_setExpression2(exp)}}}),expressionLifecycle,(0,_recompose.withPropsOnChange)(["formState"],function(_ref6){var formState=_ref6.formState;return{error:function(){try{(0,_common.fromExpression)(formState.expression);return null}catch(e){return e.message}}()}}),(0,_recompose.branch)(function(props){return!props.element},(0,_recompose.renderComponent)(_element_not_selected.ElementNotSelected)))(_expression.Expression);exports.Expression=Expression},3318:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getFunctionDefinitions=undefined;var getFunctionDefinitions=exports.getFunctionDefinitions=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(state){var serverFunctions;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:serverFunctions=(0,_app.getServerFunctions)(state);return _context.abrupt("return",(0,_lodash2.default)(serverFunctions.concat(_functions_registry.functionsRegistry.toArray()),"name"));case 2:case"end":return _context.stop()}}},_callee,this)}));return function getFunctionDefinitions(_x){return _ref.apply(this,arguments)}}();var _functions_registry=__webpack_require__(700);var _lodash=__webpack_require__(5016);var _lodash2=_interopRequireDefault(_lodash);var _app=__webpack_require__(72);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}},3320:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ElementNotSelected=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ElementNotSelected=exports.ElementNotSelected=function ElementNotSelected(_ref){var done=_ref.done;return _react2.default.createElement("div",null,_react2.default.createElement("div",null,"Select an element to show expression input"),done&&_react2.default.createElement(_eui.EuiButton,{size:"s",onClick:done}," ","Close"))};ElementNotSelected.propTypes={done:_propTypes2.default.func}},3321:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Expression=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _expression_input=__webpack_require__(3322);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Expression=exports.Expression=function Expression(_ref){var functionDefinitions=_ref.functionDefinitions,formState=_ref.formState,updateValue=_ref.updateValue,setExpression=_ref.setExpression,done=_ref.done,error=_ref.error,isAutocompleteEnabled=_ref.isAutocompleteEnabled,toggleAutocompleteEnabled=_ref.toggleAutocompleteEnabled;return _react2.default.createElement(_eui.EuiPanel,{className:"canvasTray__panel"},_react2.default.createElement(_expression_input.ExpressionInput,{functionDefinitions:functionDefinitions,error:error,value:formState.expression,onChange:updateValue,isAutocompleteEnabled:isAutocompleteEnabled}),_react2.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"s"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiSwitch,{id:"autocompleteOptIn",name:"popswitch",label:"Enable autocomplete",checked:isAutocompleteEnabled,onChange:toggleAutocompleteEnabled})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},_react2.default.createElement(_eui.EuiButtonEmpty,{size:"s",color:formState.dirty?"danger":"primary",onClick:done},formState.dirty?"Cancel":"Close"),_react2.default.createElement(_eui.EuiButton,{fill:true,disabled:!!error,onClick:function onClick(){return setExpression(formState.expression)},size:"s"},"Run")))))};Expression.propTypes={functionDefinitions:_propTypes2.default.array,formState:_propTypes2.default.object,updateValue:_propTypes2.default.func,setExpression:_propTypes2.default.func,done:_propTypes2.default.func,error:_propTypes2.default.string,isAutocompleteEnabled:_propTypes2.default.bool,toggleAutocompleteEnabled:_propTypes2.default.func}},3322:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _expression_input=__webpack_require__(3323);Object.defineProperty(exports,"ExpressionInput",{enumerable:true,get:function get(){return _expression_input.ExpressionInput}})},3323:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExpressionInput=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(1);var _autocomplete=__webpack_require__(3324);var _autocomplete2=__webpack_require__(3326);var _function_reference=__webpack_require__(3327);var _argument_reference=__webpack_require__(3328);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ExpressionInput=exports.ExpressionInput=function(_React$Component){_inherits(ExpressionInput,_React$Component);function ExpressionInput(_ref){var value=_ref.value;_classCallCheck(this,ExpressionInput);var _this=_possibleConstructorReturn(this,(ExpressionInput.__proto__||Object.getPrototypeOf(ExpressionInput)).call(this));_initialiseProps.call(_this);_this.undoHistory=[];_this.redoHistory=[];_this.state={selection:{start:value.length,end:value.length},suggestions:[]};return _this}_createClass(ExpressionInput,[{key:"componentDidUpdate",value:function componentDidUpdate(){if(!this.ref){return}var selection=this.state.selection;var start=selection.start,end=selection.end;this.ref.setSelectionRange(start,end)}},{key:"undo",value:function undo(){if(!this.undoHistory.length){return}var value=this.undoHistory.pop();this.redoHistory.push(this.props.value);this.props.onChange(value)}},{key:"redo",value:function redo(){if(!this.redoHistory.length){return}var value=this.redoHistory.pop();this.undoHistory.push(this.props.value);this.props.onChange(value)}},{key:"render",value:function render(){var _this2=this;var _props=this.props,value=_props.value,error=_props.error,isAutocompleteEnabled=_props.isAutocompleteEnabled;var suggestions=this.state.suggestions;var helpText=error?null:"This is the coded expression that backs this element. You better know what you are doing here.";return _react2.default.createElement("div",{className:"expressionInput"},_react2.default.createElement(_eui.EuiFormRow,{fullWidth:true,isInvalid:Boolean(error),error:error,helpText:helpText},isAutocompleteEnabled?_react2.default.createElement(_autocomplete.Autocomplete,{header:this.getHeader(),items:suggestions,onSelect:this.onSuggestionSelect,reference:this.getReference},_react2.default.createElement(_eui.EuiTextArea,{onKeyDown:this.onKeyDown,className:"canvasTextArea--code",value:value,onChange:this.onChange,inputRef:function inputRef(ref){return _this2.ref=ref},spellCheck:"false"})):_react2.default.createElement(_eui.EuiTextArea,{onKeyDown:this.onKeyDown,className:"canvasTextArea--code",value:value,onChange:this.onChange,inputRef:function inputRef(ref){return _this2.ref=ref},spellCheck:"false"})))}}]);return ExpressionInput}(_react2.default.Component);var _initialiseProps=function _initialiseProps(){var _this3=this;this.stash=(0,_lodash.debounce)(function(value){_this3.undoHistory.push(value);_this3.redoHistory=[]},500,{leading:true,trailing:false});this.onKeyDown=function(e){if(e.ctrlKey||e.metaKey){if(e.key==="z"){e.preventDefault();if(e.shiftKey){_this3.redo()}else{_this3.undo()}}if(e.key==="y"){e.preventDefault();_this3.redo()}}};this.onSuggestionSelect=function(item){var text=item.text,start=item.start,end=item.end;var value=_this3.props.value.substr(0,start)+text+_this3.props.value.substr(end);var selection={start:start+text.length,end:start+text.length};_this3.updateState({value:value,selection:selection});_this3.ref.focus()};this.onChange=function(e){var target=e.target;var value=target.value,selectionStart=target.selectionStart,selectionEnd=target.selectionEnd;var selection={start:selectionStart,end:selectionEnd};_this3.updateState({value:value,selection:selection})};this.updateState=function(_ref2){var value=_ref2.value,selection=_ref2.selection;_this3.stash(_this3.props.value);var suggestions=(0,_autocomplete2.getAutocompleteSuggestions)(_this3.props.functionDefinitions,value,selection.start);_this3.props.onChange(value);_this3.setState({selection:selection,suggestions:suggestions})};this.getHeader=function(){var suggestions=_this3.state.suggestions;if(!suggestions.length){return""}return _react2.default.createElement(_eui.EuiTitle,{className:"autocompleteType",size:"xs"},_react2.default.createElement("h3",null,(0,_lodash.startCase)(suggestions[0].type)))};this.getReference=function(selectedItem){var _ref3=selectedItem||{},fnDef=_ref3.fnDef,argDef=_ref3.argDef;if(argDef){return _react2.default.createElement(_argument_reference.ArgumentReference,{argDef:argDef})}if(fnDef){return _react2.default.createElement(_function_reference.FunctionReference,{fnDef:fnDef})}var _getFnArgDefAtPositio=(0,_autocomplete2.getFnArgDefAtPosition)(_this3.props.functionDefinitions,_this3.props.value,_this3.state.selection.start),fnDefAtPosition=_getFnArgDefAtPositio.fnDef,argDefAtPosition=_getFnArgDefAtPositio.argDef;if(argDefAtPosition){return _react2.default.createElement(_argument_reference.ArgumentReference,{argDef:argDefAtPosition})}if(fnDefAtPosition){return _react2.default.createElement(_function_reference.FunctionReference,{fnDef:fnDefAtPosition})}return""}};ExpressionInput.propTypes={functionDefinitions:_propTypes2.default.array,value:_propTypes2.default.string,onChange:_propTypes2.default.func,error:_propTypes2.default.string,isAutocompleteEnabled:_propTypes2.default.bool}},3324:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _autocomplete=__webpack_require__(3325);Object.defineProperty(exports,"Autocomplete",{enumerable:true,get:function get(){return _autocomplete.Autocomplete}})},3325:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Autocomplete=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Autocomplete=exports.Autocomplete=function(_React$Component){_inherits(Autocomplete,_React$Component);function Autocomplete(){_classCallCheck(this,Autocomplete);var _this=_possibleConstructorReturn(this,(Autocomplete.__proto__||Object.getPrototypeOf(Autocomplete)).call(this));_this.onSubmit=function(){var selectedIndex=_this.state.selectedIndex;var _this$props=_this.props,items=_this$props.items,onSelect=_this$props.onSelect;onSelect(items[selectedIndex]);_this.setState({selectedIndex:-1})};_this.onKeyDown=function(e){var ESCAPE=_eui.keyCodes.ESCAPE,TAB=_eui.keyCodes.TAB,ENTER=_eui.keyCodes.ENTER,UP=_eui.keyCodes.UP,DOWN=_eui.keyCodes.DOWN,LEFT=_eui.keyCodes.LEFT,RIGHT=_eui.keyCodes.RIGHT;var keyCode=e.keyCode;var items=_this.props.items;var _this$state=_this.state,isOpen=_this$state.isOpen,selectedIndex=_this$state.selectedIndex;if([ESCAPE,LEFT,RIGHT].includes(keyCode)){_this.setState({isOpen:false})}if([TAB,ENTER].includes(keyCode)&&isOpen&&selectedIndex>=0){e.preventDefault();_this.onSubmit()}else if(keyCode===UP&&items.length>0&&isOpen){e.preventDefault();_this.selectPrevious()}else if(keyCode===DOWN&&items.length>0&&isOpen){e.preventDefault();_this.selectNext()}else if(e.key==="Backspace"){_this.setState({isOpen:true})}else if(!["Shift","Control","Alt","Meta"].includes(e.key)){_this.setState({selectedIndex:-1})}};_this.onKeyPress=function(){_this.setState({isOpen:true})};_this.onFocus=function(){_this.setState({isFocused:true})};_this.onBlur=function(){_this.setState({isFocused:false})};_this.onMouseDown=function(){_this.setState({isOpen:false})};_this.onMouseEnter=function(){_this.setState({isMousedOver:true})};_this.onMouseLeave=function(){_this.setState({isMousedOver:false})};_this.state={isOpen:false,isFocused:false,isMousedOver:false,selectedIndex:-1};_this.containerRef=null;_this.itemRefs=[];return _this}_createClass(Autocomplete,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps,prevState){if(this.props.items&&prevProps.items!==this.props.items&&this.props.items.length===1&&this.state.selectedIndex!==0){this.selectFirst()}if(prevState.selectedIndex!==this.state.selectedIndex){this.scrollIntoView()}}},{key:"selectFirst",value:function selectFirst(){this.setState({selectedIndex:0})}},{key:"isVisible",value:function isVisible(){var _state=this.state,isOpen=_state.isOpen,isFocused=_state.isFocused,isMousedOver=_state.isMousedOver;var _props=this.props,items=_props.items,reference=_props.reference;var visible=isOpen&&(isFocused||isMousedOver);var hasItems=items&&items.length;var hasReference=reference(this.getSelectedItem());return visible&&(hasItems||hasReference)}},{key:"getSelectedItem",value:function getSelectedItem(){return this.props.items&&this.props.items[this.state.selectedIndex]}},{key:"selectPrevious",value:function selectPrevious(){var items=this.props.items;var selectedIndex=this.state.selectedIndex;if(selectedIndex>0){this.setState({selectedIndex:selectedIndex-1})}else{this.setState({selectedIndex:items.length-1})}}},{key:"selectNext",value:function selectNext(){var items=this.props.items;var selectedIndex=this.state.selectedIndex;if(selectedIndex>=0&&selectedIndex<items.length-1){this.setState({selectedIndex:selectedIndex+1})}else{this.setState({selectedIndex:0})}}},{key:"scrollIntoView",value:function scrollIntoView(){var containerRef=this.containerRef,itemRefs=this.itemRefs,selectedIndex=this.state.selectedIndex;var itemRef=itemRefs[selectedIndex];if(!containerRef||!itemRef){return}containerRef.scrollTop=Math.max(Math.min(containerRef.scrollTop,itemRef.offsetTop),itemRef.offsetTop+itemRef.offsetHeight-containerRef.offsetHeight)}},{key:"render",value:function render(){var _this2=this;var _props2=this.props,header=_props2.header,items=_props2.items,reference=_props2.reference;return _react2.default.createElement("div",{className:"autocomplete",onKeyDown:this.onKeyDown,onKeyPress:this.onKeyPress,onFocus:this.onFocus,onBlur:this.onBlur,role:"combobox","aria-haspopup":"true","aria-owns":"autocompleteItems","aria-expanded":this.isVisible()?"true":"false"},this.isVisible()?_react2.default.createElement(_eui.EuiPanel,{paddingSize:"none",className:"autocompletePopup",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"none"},items&&items.length?_react2.default.createElement(_eui.EuiFlexItem,{style:{maxWidth:400}},_react2.default.createElement("div",{className:"autocompleteItems",ref:function ref(_ref2){return _this2.containerRef=_ref2},role:"listbox"},header,items.map(function(item,i){return _react2.default.createElement("div",{key:i,ref:function ref(_ref){return _this2.itemRefs[i]=_ref},className:"autocompleteItem"+(_this2.state.selectedIndex===i?" autocompleteItem--isActive":""),onMouseEnter:function onMouseEnter(){return _this2.setState({selectedIndex:i})},onClick:_this2.onSubmit,role:"option"},item.text)}))):"",_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement("div",{className:"autocompleteReference"},reference(this.getSelectedItem()))))):"",_react2.default.createElement("div",{onMouseDown:this.onMouseDown},this.props.children))}}]);return Autocomplete}(_react2.default.Component);Autocomplete.propTypes={header:_propTypes2.default.node,items:_propTypes2.default.array,onSelect:_propTypes2.default.func,children:_propTypes2.default.node,reference:_propTypes2.default.func}},3326:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();exports.getFnArgDefAtPosition=getFnArgDefAtPosition;exports.getAutocompleteSuggestions=getAutocompleteSuggestions;var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var MARKER="CANVAS_SUGGESTION_MARKER";function getFnArgDefAtPosition(specs,expression,position){var text=expression.substr(0,position)+MARKER+expression.substr(position);try{var ast=(0,_common.parse)(text,{addMeta:true});var _getFnArgAtPosition=getFnArgAtPosition(ast,position),newAst=_getFnArgAtPosition.ast,fnIndex=_getFnArgAtPosition.fnIndex,argName=_getFnArgAtPosition.argName;var fn=newAst.node.chain[fnIndex].node;var fnDef=(0,_common.getByAlias)(specs,fn.function.replace(MARKER,""));if(fnDef&&argName){var argDef=(0,_common.getByAlias)(fnDef.args,argName);return{fnDef:fnDef,argDef:argDef}}return{fnDef:fnDef}}catch(e){}return[]}function getAutocompleteSuggestions(specs,expression,position){var text=expression.substr(0,position)+MARKER+expression.substr(position);try{var ast=(0,_common.parse)(text,{addMeta:true});var _getFnArgAtPosition2=getFnArgAtPosition(ast,position),newAst=_getFnArgAtPosition2.ast,fnIndex=_getFnArgAtPosition2.fnIndex,argName=_getFnArgAtPosition2.argName,argIndex=_getFnArgAtPosition2.argIndex;var fn=newAst.node.chain[fnIndex].node;if(fn.function.includes(MARKER)){return getFnNameSuggestions(specs,newAst,fnIndex)}if(argName==="_"){return getArgNameSuggestions(specs,newAst,fnIndex,argName,argIndex)}if(argName){return getArgValueSuggestions(specs,newAst,fnIndex,argName,argIndex)}}catch(e){}return[]}function getFnArgAtPosition(ast,position){var fnIndex=ast.node.chain.findIndex(function(fn){return fn.start<=position&&position<=fn.end});var fn=ast.node.chain[fnIndex];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=Object.entries(fn.node.arguments)[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var _ref=_step.value;var _ref2=_slicedToArray(_ref,2);var argName=_ref2[0];var argValues=_ref2[1];for(var argIndex=0;argIndex<argValues.length;argIndex++){var value=argValues[argIndex];if(value.start<=position&&position<=value.end){if(value.node!==null&&value.node.type==="expression"){return getFnArgAtPosition(value,position)}return{ast:ast,fnIndex:fnIndex,argName:argName,argIndex:argIndex}}}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}return{ast:ast,fnIndex:fnIndex}}function getFnNameSuggestions(specs,ast,fnIndex){var _ast$node$chain$fnInd=ast.node.chain[fnIndex],start=_ast$node$chain$fnInd.start,end=_ast$node$chain$fnInd.end,fn=_ast$node$chain$fnInd.node;var query=fn.function.replace(MARKER,"");var matchingFnDefs=specs.filter(function(_ref3){var name=_ref3.name;return textMatches(name,query)});var prevFn=ast.node.chain[fnIndex-1];var prevFnDef=prevFn&&(0,_common.getByAlias)(specs,prevFn.node.function);var prevFnType=prevFnDef&&prevFnDef.type;var comparator=combinedComparator(prevFnTypeComparator(prevFnType),invokeWithProp(startsWithComparator(query),"name"),invokeWithProp(alphanumericalComparator,"name"));var fnDefs=matchingFnDefs.sort(comparator);return fnDefs.map(function(fnDef){return{type:"function",text:fnDef.name+" ",start:start,end:end-MARKER.length,fnDef:fnDef}})}function getArgNameSuggestions(specs,ast,fnIndex,argName,argIndex){var fn=ast.node.chain[fnIndex].node;var fnDef=(0,_common.getByAlias)(specs,fn.function);if(!fnDef){return[]}var _fn$arguments$argName=fn.arguments[argName][argIndex],text=_fn$arguments$argName.text,start=_fn$arguments$argName.start,end=_fn$arguments$argName.end;var query=text.replace(MARKER,"");var matchingArgDefs=Object.values(fnDef.args).filter(function(_ref4){var name=_ref4.name;return textMatches(name,query)});var argEntries=Object.entries(fn.arguments).map(function(_ref5){var _ref6=_slicedToArray(_ref5,2),name=_ref6[0],values=_ref6[1];return[name,values.filter(function(value){return!value.text.includes(MARKER)})]});var unusedArgDefs=matchingArgDefs.filter(function(argDef){if(argDef.multi){return true}return!argEntries.some(function(_ref7){var _ref8=_slicedToArray(_ref7,2),name=_ref8[0],values=_ref8[1];return values.length&&(name===argDef.name||argDef.aliases.includes(name))})});var comparator=combinedComparator(unnamedArgComparator,invokeWithProp(startsWithComparator(query),"name"),invokeWithProp(alphanumericalComparator,"name"));var argDefs=unusedArgDefs.sort(comparator);return argDefs.map(function(argDef){return{type:"argument",text:argDef.name+"=",start:start,end:end-MARKER.length,argDef:argDef}})}function getArgValueSuggestions(specs,ast,fnIndex,argName,argIndex){var fn=ast.node.chain[fnIndex].node;var fnDef=(0,_common.getByAlias)(specs,fn.function);if(!fnDef){return[]}var argDef=(0,_common.getByAlias)(fnDef.args,argName);if(!argDef){return[]}var _fn$arguments$argName2=fn.arguments[argName][argIndex],start=_fn$arguments$argName2.start,end=_fn$arguments$argName2.end,node=_fn$arguments$argName2.node;var query=node.replace(MARKER,"");var suggestions=(0,_lodash.uniq)(argDef.options.concat(argDef.default||[]));var filtered=suggestions.filter(function(option){return textMatches(String(option),query)});var comparator=combinedComparator(startsWithComparator(query),alphanumericalComparator);var sorted=filtered.sort(comparator);return sorted.map(function(value){var text=maybeQuote(value)+" ";return{start:start,end:end-MARKER.length,type:"value",text:text}})}function textMatches(text,query){return text.toLowerCase().includes(query.toLowerCase().trim())}function maybeQuote(value){if(typeof value==="string"){if(value.match(/^\{.*\}$/)){return value}return'"'+value.replace(/"/g,'\\"')+'"'}return value}function prevFnTypeComparator(prevFnType){return function(a,b){return Boolean(b.context.types&&b.context.types.includes(prevFnType))-Boolean(a.context.types&&a.context.types.includes(prevFnType))}}function unnamedArgComparator(a,b){return b.aliases.includes("_")-a.aliases.includes("_")}function alphanumericalComparator(a,b){if(a<b){return-1}if(a>b){return 1}return 0}function startsWithComparator(query){return function(a,b){return String(b).startsWith(query)-String(a).startsWith(query)}}function combinedComparator(){for(var _len=arguments.length,comparators=Array(_len),_key=0;_key<_len;_key++){comparators[_key]=arguments[_key]}return function(a,b){return comparators.reduce(function(acc,comparator){if(acc!==0){return acc}return comparator(a,b)},0)}}function invokeWithProp(fn,prop){return function(){for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}return fn.apply(undefined,_toConsumableArray(args.map(function(arg){return arg[prop]})))}}},3327:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionReference=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _markdownIt=__webpack_require__(302);var _markdownIt2=_interopRequireDefault(_markdownIt);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var md=new _markdownIt2.default;var FunctionReference=exports.FunctionReference=function FunctionReference(_ref){var fnDef=_ref.fnDef;return _react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiTitle,{size:"xs"},_react2.default.createElement("h3",null,fnDef.name)),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,{dangerouslySetInnerHTML:getHelp(fnDef)}),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiDescriptionList,{type:"inline",className:"autocompleteDescList",compressed:true,listItems:getFnListItems(fnDef)}),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiBasicTable,{className:"autocompleteTable",items:getArgItems(fnDef.args),columns:getArgColumns()}))};function getHelp(fnDef){return{__html:md.render(fnDef.help)}}function getFnListItems(fnDef){var aliases=fnDef.aliases,context=fnDef.context,type=fnDef.type;var items=[];if(aliases.length){items.push({title:"Aliases",description:aliases.join(", ")})}if(context.types){items.push({title:"Accepts",description:context.types.join(", ")})}if(type){items.push({title:"Returns",description:type})}return items}function getArgItems(args){return Object.entries(args).map(function(_ref2){var _ref3=_slicedToArray(_ref2,2),name=_ref3[0],argDef=_ref3[1];return{argument:name+(argDef.required?"*":""),aliases:(argDef.aliases||[]).join(", "),types:(argDef.types||[]).join(", "),default:argDef.default||"",description:argDef.help||""}})}function getArgColumns(){return["argument","aliases","types","default","description"].map(function(field){var column={field:field,name:(0,_lodash.startCase)(field),truncateText:field!=="description"};if(field==="description"){column.width="50%"}return column})}FunctionReference.propTypes={fnDef:_propTypes2.default.object}},3328:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ArgumentReference=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _markdownIt=__webpack_require__(302);var _markdownIt2=_interopRequireDefault(_markdownIt);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var md=new _markdownIt2.default;var ArgumentReference=exports.ArgumentReference=function ArgumentReference(_ref){var argDef=_ref.argDef;return _react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiTitle,{size:"xs"},_react2.default.createElement("h3",null,argDef.name)),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,{dangerouslySetInnerHTML:getHelp(argDef)}),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiDescriptionList,{type:"inline",compressed:true,listItems:getArgListItems(argDef)}))};function getHelp(argDef){return{__html:md.render(argDef.help)}}function getArgListItems(argDef){var aliases=argDef.aliases,types=argDef.types,def=argDef.default,required=argDef.required;var items=[];if(aliases.length){items.push({title:"Aliases",description:aliases.join(", ")})}if(types.length){items.push({title:"Types",description:types.join(", ")})}if(def!=null){items.push({title:"Default",description:def})}items.push({title:"Required",description:String(Boolean(required))});return items}ArgumentReference.propTypes={argDef:_propTypes2.default.object}},3329:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Tray=undefined;var _recompose=__webpack_require__(19);var _tray=__webpack_require__(3330);var Tray=exports.Tray=(0,_recompose.pure)(_tray.Tray)},3330:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Tray=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Tray=exports.Tray=function Tray(_ref){var children=_ref.children,done=_ref.done;return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiFlexGroup,{className:"canvasTray__toggle",justifyContent:"spaceAround"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonIcon,{size:"s",onClick:done,"aria-label":"Dismiss tray",iconType:"arrowDown"}))),_react2.default.createElement("div",{className:"canvasTray"},children))};Tray.propTypes={children:_propTypes2.default.node,done:_propTypes2.default.func}},3331:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Workpad=undefined;var _reactRedux=__webpack_require__(14);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _transitions_registry=__webpack_require__(711);var _history=__webpack_require__(417);var _elements=__webpack_require__(61);var _app=__webpack_require__(72);var _workpad=__webpack_require__(33);var _workpad2=__webpack_require__(3332);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var mapStateToProps=function mapStateToProps(state){return{pages:(0,_workpad.getPages)(state),selectedPageNumber:(0,_workpad.getSelectedPageIndex)(state)+1,totalElementCount:(0,_workpad.getAllElements)(state).length,workpad:(0,_workpad.getWorkpad)(state),isFullscreen:(0,_app.getFullscreen)(state)}};var mapDispatchToProps={undoHistory:_history.undoHistory,redoHistory:_history.redoHistory,fetchAllRenderables:_elements.fetchAllRenderables};var Workpad=exports.Workpad=(0,_recompose.compose)((0,_recompose.getContext)({router:_propTypes2.default.object}),(0,_recompose.withState)("grid","setGrid",false),(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps),(0,_recompose.withState)("transition","setTransition",null),(0,_recompose.withState)("prevSelectedPageNumber","setPrevSelectedPageNumber",0),(0,_recompose.withProps)(function(_ref){var selectedPageNumber=_ref.selectedPageNumber,prevSelectedPageNumber=_ref.prevSelectedPageNumber,transition=_ref.transition;function getAnimation(pageNumber){if(!transition||!transition.name){return null}if(![selectedPageNumber,prevSelectedPageNumber].includes(pageNumber)){return null}var _transitionsRegistry$=_transitions_registry.transitionsRegistry.get(transition.name),enter=_transitionsRegistry$.enter,exit=_transitionsRegistry$.exit;var laterPageNumber=Math.max(selectedPageNumber,prevSelectedPageNumber);var name=pageNumber===laterPageNumber?enter:exit;var direction=prevSelectedPageNumber>selectedPageNumber?"reverse":"normal";return{name:name,direction:direction}}return{getAnimation:getAnimation}}),(0,_recompose.withHandlers)({onPageChange:function onPageChange(props){return function(pageNumber){if(pageNumber===props.selectedPageNumber){return}props.setPrevSelectedPageNumber(props.selectedPageNumber);var transitionPage=Math.max(props.selectedPageNumber,pageNumber)-1;var transition=props.workpad.pages[transitionPage].transition;if(transition){props.setTransition(transition)}props.router.navigateTo("loadWorkpad",{id:props.workpad.id,page:pageNumber})}}}),(0,_recompose.withHandlers)({onTransitionEnd:function onTransitionEnd(_ref2){var setTransition=_ref2.setTransition;return function(){return setTransition(null)}},nextPage:function nextPage(props){return function(){var pageNumber=Math.min(props.selectedPageNumber+1,props.workpad.pages.length);props.onPageChange(pageNumber)}},previousPage:function previousPage(props){return function(){var pageNumber=Math.max(1,props.selectedPageNumber-1);props.onPageChange(pageNumber)}}}))(_workpad2.Workpad)},3332:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Workpad=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactShortcuts=__webpack_require__(419);var _styleIt=__webpack_require__(715);var _styleIt2=_interopRequireDefault(_styleIt);var _workpad_page=__webpack_require__(1174);var _fullscreen=__webpack_require__(3361);var _doc_title=__webpack_require__(1159);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Workpad=exports.Workpad=function Workpad(props){var selectedPageNumber=props.selectedPageNumber,getAnimation=props.getAnimation,onTransitionEnd=props.onTransitionEnd,pages=props.pages,totalElementCount=props.totalElementCount,workpad=props.workpad,fetchAllRenderables=props.fetchAllRenderables,undoHistory=props.undoHistory,redoHistory=props.redoHistory,setGrid=props.setGrid,grid=props.grid,nextPage=props.nextPage,previousPage=props.previousPage,isFullscreen=props.isFullscreen;var height=workpad.height,width=workpad.width;var bufferStyle={height:isFullscreen?height:height+32,width:isFullscreen?width:width+32};var keyHandler=function keyHandler(action){if(action==="REFRESH"){return fetchAllRenderables()}if(action==="UNDO"){return undoHistory()}if(action==="REDO"){return redoHistory()}if(action==="GRID"){return setGrid(!grid)}if(action==="PREV"){return previousPage()}if(action==="NEXT"){return nextPage()}};(0,_doc_title.setDocTitle)(workpad.name);return _react2.default.createElement("div",{className:"canvasWorkpad__buffer",style:bufferStyle},_react2.default.createElement("div",{className:"canvasCheckered",style:{height:height,width:width}},!isFullscreen&&_react2.default.createElement(_reactShortcuts.Shortcuts,{name:"EDITOR",handler:keyHandler,targetNodeSelector:"body",global:true}),_react2.default.createElement(_fullscreen.Fullscreen,null,function(_ref){var isFullscreen=_ref.isFullscreen,windowSize=_ref.windowSize;var scale=Math.min(windowSize.height/height,windowSize.width/width);var fsStyle=isFullscreen?{transform:"scale3d("+scale+", "+scale+", 1)",WebkitTransform:"scale3d("+scale+", "+scale+", 1)",msTransform:"scale3d("+scale+", "+scale+", 1)",height:windowSize.height<height?"auto":height,width:windowSize.width<width?"auto":width}:{};return _styleIt2.default.it(workpad.css,_react2.default.createElement("div",{className:"canvasWorkpad "+(isFullscreen?"fullscreen":""),style:fsStyle,"data-shared-items-count":totalElementCount},isFullscreen&&_react2.default.createElement(_reactShortcuts.Shortcuts,{name:"PRESENTATION",handler:keyHandler,targetNodeSelector:"body",global:true}),pages.map(function(page,i){return _react2.default.createElement(_workpad_page.WorkpadPage,{key:page.id,page:page,height:height,width:width,isSelected:i+1===selectedPageNumber,animation:getAnimation(i+1),onAnimationEnd:onTransitionEnd})}),_react2.default.createElement("div",{className:"canvasGrid",style:{height:height,width:width,display:grid?"block":"none"}})))})))};Workpad.propTypes={selectedPageNumber:_propTypes2.default.number.isRequired,getAnimation:_propTypes2.default.func.isRequired,onTransitionEnd:_propTypes2.default.func.isRequired,grid:_propTypes2.default.bool.isRequired,setGrid:_propTypes2.default.func.isRequired,pages:_propTypes2.default.array.isRequired,totalElementCount:_propTypes2.default.number.isRequired,isFullscreen:_propTypes2.default.bool.isRequired,workpad:_propTypes2.default.object.isRequired,undoHistory:_propTypes2.default.func.isRequired,redoHistory:_propTypes2.default.func.isRequired,nextPage:_propTypes2.default.func.isRequired,previousPage:_propTypes2.default.func.isRequired,fetchAllRenderables:_propTypes2.default.func.isRequired,css:_propTypes2.default.object}},3333:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getClipboardData=exports.setClipboardData=undefined;var _storage=__webpack_require__(381);var _constants=__webpack_require__(229);var _get_window=__webpack_require__(245);var storage=new _storage.Storage((0,_get_window.getWindow)().localStorage);var setClipboardData=exports.setClipboardData=function setClipboardData(data){return storage.set(_constants.LOCALSTORAGE_CLIPBOARD,JSON.stringify(data))};var getClipboardData=exports.getClipboardData=function getClipboardData(){return storage.get(_constants.LOCALSTORAGE_CLIPBOARD)}},3334:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.withEventHandlers=undefined;var _recompose=__webpack_require__(19);var ancestorElement=function ancestorElement(element){if(!element){return element}do{if(element.classList&&element.classList.contains("canvasPage")){return element}}while(element=element.parentElement||element.parentNode)};var localMousePosition=function localMousePosition(box,clientX,clientY){return{x:clientX-box.left,y:clientY-box.top}};var _resetHandler=function _resetHandler(){window.onmousemove=null;window.onmouseup=null};var setupHandler=function setupHandler(commit,target){var canvasPage=ancestorElement(target);if(!canvasPage){return}var canvasOrigin=canvasPage.getBoundingClientRect();window.onmousemove=function(_ref){var target=_ref.target,buttons=_ref.buttons,clientX=_ref.clientX,clientY=_ref.clientY,altKey=_ref.altKey,metaKey=_ref.metaKey,shiftKey=_ref.shiftKey,ctrlKey=_ref.ctrlKey;var _localMousePosition=localMousePosition(canvasOrigin,clientX,clientY),x=_localMousePosition.x,y=_localMousePosition.y;if(buttons===1||ancestorElement(target)){commit("cursorPosition",{x:x,y:y,altKey:altKey,metaKey:metaKey,shiftKey:shiftKey,ctrlKey:ctrlKey})}else{commit("cursorPosition",{})}};window.onmouseup=function(e){e.stopPropagation();var clientX=e.clientX,clientY=e.clientY,altKey=e.altKey,metaKey=e.metaKey,shiftKey=e.shiftKey,ctrlKey=e.ctrlKey;var _localMousePosition2=localMousePosition(canvasOrigin,clientX,clientY),x=_localMousePosition2.x,y=_localMousePosition2.y;commit("mouseEvent",{event:"mouseUp",x:x,y:y,altKey:altKey,metaKey:metaKey,shiftKey:shiftKey,ctrlKey:ctrlKey});_resetHandler()}};var handleMouseMove=function handleMouseMove(commit,_ref2,isEditable){var target=_ref2.target,clientX=_ref2.clientX,clientY=_ref2.clientY,altKey=_ref2.altKey,metaKey=_ref2.metaKey,shiftKey=_ref2.shiftKey,ctrlKey=_ref2.ctrlKey;if(!window.onmousemove&&isEditable){var _localMousePosition3=localMousePosition(target,clientX,clientY),x=_localMousePosition3.x,y=_localMousePosition3.y;setupHandler(commit,target);commit("cursorPosition",{x:x,y:y,altKey:altKey,metaKey:metaKey,shiftKey:shiftKey,ctrlKey:ctrlKey})}};var handleWheel=function handleWheel(commit,_ref3,isEditable){var target=_ref3.target,clientX=_ref3.clientX,clientY=_ref3.clientY,altKey=_ref3.altKey,metaKey=_ref3.metaKey,shiftKey=_ref3.shiftKey,ctrlKey=_ref3.ctrlKey;if(isEditable){var _localMousePosition4=localMousePosition(target,clientX,clientY),x=_localMousePosition4.x,y=_localMousePosition4.y;setupHandler(commit,target);commit("cursorPosition",{x:x,y:y,altKey:altKey,metaKey:metaKey,shiftKey:shiftKey,ctrlKey:ctrlKey})}};var handleMouseDown=function handleMouseDown(commit,e,isEditable){e.stopPropagation();var target=e.target,clientX=e.clientX,clientY=e.clientY,buttons=e.buttons,altKey=e.altKey,metaKey=e.metaKey,shiftKey=e.shiftKey,ctrlKey=e.ctrlKey;if(buttons!==1||!isEditable){_resetHandler();return}var ancestor=ancestorElement(target);if(!ancestor){return}var _localMousePosition5=localMousePosition(ancestor,clientX,clientY),x=_localMousePosition5.x,y=_localMousePosition5.y;setupHandler(commit,ancestor);commit("mouseEvent",{event:"mouseDown",x:x,y:y,altKey:altKey,metaKey:metaKey,shiftKey:shiftKey,ctrlKey:ctrlKey})};var keyCode=function keyCode(key){return key==="Meta"?"MetaLeft":"Key"+key.toUpperCase()};var isTextInput=function isTextInput(_ref4){var tagName=_ref4.tagName,type=_ref4.type;var nonTextInputs=["button","checkbox","color","file","image","radio","range","reset","submit"];switch(tagName.toLowerCase()){case"input":return!nonTextInputs.includes(type);case"textarea":return true;default:return false}};var modifierKey=function modifierKey(key){return["KeyALT","KeyCONTROL"].indexOf(keyCode(key))>-1};var handleKeyDown=function handleKeyDown(commit,e,isEditable,remove){var key=e.key,target=e.target;if(isEditable){if((key==="Backspace"||key==="Delete")&&!isTextInput(target)){e.preventDefault();remove()}else if(!modifierKey(key)){commit("keyboardEvent",{event:"keyDown",code:keyCode(key)})}}};var handleKeyPress=function handleKeyPress(commit,e,isEditable){var key=e.key,target=e.target;var upcaseKey=key&&key.toUpperCase();if(isEditable&&!isTextInput(target)&&"GU".indexOf(upcaseKey)!==-1){commit("actionEvent",{event:upcaseKey==="G"?"group":"ungroup"})}};var handleKeyUp=function handleKeyUp(commit,_ref5,isEditable){var key=_ref5.key;if(isEditable&&!modifierKey(key)){commit("keyboardEvent",{event:"keyUp",code:keyCode(key)})}};var withEventHandlers=exports.withEventHandlers=(0,_recompose.withHandlers)({onMouseDown:function onMouseDown(props){return function(e){return handleMouseDown(props.commit,e,props.isEditable)}},onMouseMove:function onMouseMove(props){return function(e){return handleMouseMove(props.commit,e,props.isEditable)}},onKeyDown:function onKeyDown(props){return function(e){return handleKeyDown(props.commit,e,props.isEditable,props.remove)}},onKeyPress:function onKeyPress(props){return function(e){return handleKeyPress(props.commit,e,props.isEditable)}},onKeyUp:function onKeyUp(props){return function(e){return handleKeyUp(props.commit,e,props.isEditable)}},onWheel:function onWheel(props){return function(e){return handleWheel(props.commit,e,props.isEditable)}},resetHandler:function resetHandler(){return function(){return _resetHandler()}}})},3335:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadPage=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactShortcuts=__webpack_require__(419);var _element_wrapper=__webpack_require__(3336);var _alignment_guide=__webpack_require__(3351);var _hover_annotation=__webpack_require__(3353);var _rotation_handle=__webpack_require__(3355);var _border_connection=__webpack_require__(3357);var _border_resize_handle=__webpack_require__(3359);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var WorkpadPage=exports.WorkpadPage=function(_PureComponent){_inherits(WorkpadPage,_PureComponent);function WorkpadPage(){_classCallCheck(this,WorkpadPage);return _possibleConstructorReturn(this,(WorkpadPage.__proto__||Object.getPrototypeOf(WorkpadPage)).apply(this,arguments))}_createClass(WorkpadPage,[{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.resetHandler()}},{key:"render",value:function render(){var _props=this.props,page=_props.page,className=_props.className,animationStyle=_props.animationStyle,elements=_props.elements,_props$cursor=_props.cursor,cursor=_props$cursor===undefined?"auto":_props$cursor,height=_props.height,width=_props.width,isEditable=_props.isEditable,onDoubleClick=_props.onDoubleClick,onKeyDown=_props.onKeyDown,onKeyPress=_props.onKeyPress,onKeyUp=_props.onKeyUp,onMouseDown=_props.onMouseDown,onMouseMove=_props.onMouseMove,onMouseUp=_props.onMouseUp,onAnimationEnd=_props.onAnimationEnd,onWheel=_props.onWheel,copyElements=_props.copyElements,cutElements=_props.cutElements,pasteElements=_props.pasteElements;var keyHandler=function keyHandler(action){switch(action){case"COPY":copyElements();break;case"CUT":cutElements();break;case"PASTE":pasteElements();break}};return _react2.default.createElement("div",{key:page.id,id:page.id,"data-test-subj":"canvasWorkpadPage",className:"canvasPage "+className+" "+(isEditable?"canvasPage--isEditable":""),"data-shared-items-container":true,style:_extends({},page.style,animationStyle,{height:height,width:width,cursor:cursor}),onMouseMove:onMouseMove,onMouseUp:onMouseUp,onMouseDown:onMouseDown,onKeyDown:onKeyDown,onKeyPress:onKeyPress,onKeyUp:onKeyUp,onDoubleClick:onDoubleClick,onAnimationEnd:onAnimationEnd,onWheel:onWheel,tabIndex:0},isEditable&&_react2.default.createElement(_reactShortcuts.Shortcuts,{name:"ELEMENT",handler:keyHandler,targetNodeSelector:"#"+page.id,global:true}),elements.map(function(element){if(element.type==="annotation"){if(!isEditable){return}var props={key:element.id,type:element.type,transformMatrix:element.transformMatrix,width:element.width,height:element.height};switch(element.subtype){case"alignmentGuide":return _react2.default.createElement(_alignment_guide.AlignmentGuide,props);case"hoverAnnotation":return _react2.default.createElement(_hover_annotation.HoverAnnotation,props);case"rotationHandle":return _react2.default.createElement(_rotation_handle.RotationHandle,props);case"resizeHandle":return _react2.default.createElement(_border_resize_handle.BorderResizeHandle,props);case"resizeConnector":return _react2.default.createElement(_border_connection.BorderConnection,props);default:return[]}}else if(element.type!=="group"){return _react2.default.createElement(_element_wrapper.ElementWrapper,{key:element.id,element:element})}}).filter(function(element){return!!element}))}}]);return WorkpadPage}(_react.PureComponent);WorkpadPage.propTypes={page:_propTypes2.default.shape({id:_propTypes2.default.string.isRequired,style:_propTypes2.default.object}).isRequired,className:_propTypes2.default.string.isRequired,animationStyle:_propTypes2.default.object.isRequired,elements:_propTypes2.default.arrayOf(_propTypes2.default.shape({id:_propTypes2.default.string.isRequired,transformMatrix:_propTypes2.default.arrayOf(_propTypes2.default.number).isRequired,width:_propTypes2.default.number.isRequired,height:_propTypes2.default.number.isRequired,type:_propTypes2.default.string})).isRequired,cursor:_propTypes2.default.string,height:_propTypes2.default.number.isRequired,width:_propTypes2.default.number.isRequired,isEditable:_propTypes2.default.bool.isRequired,onDoubleClick:_propTypes2.default.func,onKeyDown:_propTypes2.default.func,onKeyUp:_propTypes2.default.func,onMouseDown:_propTypes2.default.func,onMouseMove:_propTypes2.default.func,onMouseUp:_propTypes2.default.func,onAnimationEnd:_propTypes2.default.func,resetHandler:_propTypes2.default.func,copyElements:_propTypes2.default.func,cutElements:_propTypes2.default.func,pasteElements:_propTypes2.default.func}},3336:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ElementWrapper=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactRedux=__webpack_require__(14);var _workpad=__webpack_require__(33);var _resolved_arg=__webpack_require__(1152);var _element_wrapper=__webpack_require__(3337);var _handlers=__webpack_require__(3350);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var mapStateToProps=function mapStateToProps(state,_ref){var element=_ref.element;return{isWriteable:(0,_workpad.isWriteable)(state),resolvedArg:(0,_workpad.getResolvedArgs)(state,element.id,"expressionRenderable"),selectedPage:(0,_workpad.getSelectedPage)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch,_ref2){var element=_ref2.element;return{createHandlers:function createHandlers(pageId){return function(){return(0,_handlers.createHandlers)(element,pageId,dispatch)}}}};var mergeProps=function mergeProps(stateProps,dispatchProps,ownProps){var resolvedArg=stateProps.resolvedArg,selectedPage=stateProps.selectedPage;var element=ownProps.element,restProps=ownProps.restProps;var id=element.id,transformMatrix=element.transformMatrix,width=element.width,height=element.height;return _extends({},restProps,{id:id,transformMatrix:transformMatrix,width:width,height:height,state:(0,_resolved_arg.getState)(resolvedArg),error:(0,_resolved_arg.getError)(resolvedArg),renderable:(0,_resolved_arg.getValue)(resolvedArg),createHandlers:dispatchProps.createHandlers(selectedPage)})};var ElementWrapper=exports.ElementWrapper=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,mergeProps)(_element_wrapper.ElementWrapper);ElementWrapper.propTypes={element:_propTypes2.default.shape({id:_propTypes2.default.string.isRequired,transformMatrix:_propTypes2.default.arrayOf(_propTypes2.default.number).isRequired,width:_propTypes2.default.number.isRequired,height:_propTypes2.default.number.isRequired}).isRequired}},3337:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ElementWrapper=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _positionable=__webpack_require__(3338);var _element_content=__webpack_require__(3340);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ElementWrapper=exports.ElementWrapper=function(_React$PureComponent){_inherits(ElementWrapper,_React$PureComponent);function ElementWrapper(){var _ref;var _temp,_this,_ret;_classCallCheck(this,ElementWrapper);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=ElementWrapper.__proto__||Object.getPrototypeOf(ElementWrapper)).call.apply(_ref,[this].concat(args))),_this),_this.state={handlers:null},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(ElementWrapper,[{key:"componentDidMount",value:function componentDidMount(){var createHandlers=this.props.createHandlers;this.setState({handlers:createHandlers()})}},{key:"render",value:function render(){if(!this.state.handlers){return null}var _props=this.props,renderable=_props.renderable,transformMatrix=_props.transformMatrix,width=_props.width,height=_props.height,state=_props.state;return _react2.default.createElement(_positionable.Positionable,{transformMatrix:transformMatrix,width:width,height:height},_react2.default.createElement(_element_content.ElementContent,{renderable:renderable,state:state,handlers:this.state.handlers}))}}]);return ElementWrapper}(_react2.default.PureComponent);ElementWrapper.propTypes={renderable:_propTypes2.default.object,transformMatrix:_propTypes2.default.arrayOf(_propTypes2.default.number).isRequired,width:_propTypes2.default.number.isRequired,height:_propTypes2.default.number.isRequired,state:_propTypes2.default.string,createHandlers:_propTypes2.default.func.isRequired}},3338:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Positionable=undefined;var _recompose=__webpack_require__(19);var _positionable=__webpack_require__(3339);var Positionable=exports.Positionable=(0,_recompose.pure)(_positionable.Positionable)},3339:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Positionable=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _aeroelastic=__webpack_require__(303);var _aeroelastic2=_interopRequireDefault(_aeroelastic);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Positionable=exports.Positionable=function Positionable(_ref){var children=_ref.children,transformMatrix=_ref.transformMatrix,width=_ref.width,height=_ref.height;_react2.default.Children.only(children);var wrappedChildren=_react2.default.Children.map(children,function(child){var newStyle={width:width,height:height,marginLeft:-width/2,marginTop:-height/2,position:"absolute",transform:_aeroelastic2.default.dom.matrixToCSS(transformMatrix.map(function(n,i){return i<12?n:Math.round(n)}))};var stepChild=_react2.default.cloneElement(child,{size:{width:width,height:height}});return _react2.default.createElement("div",{className:"canvasPositionable canvasInteractable",style:newStyle},stepChild)});return wrappedChildren};Positionable.propTypes={onChange:_propTypes2.default.func,children:_propTypes2.default.element.isRequired,transformMatrix:_propTypes2.default.arrayOf(_propTypes2.default.number).isRequired,width:_propTypes2.default.number.isRequired,height:_propTypes2.default.number.isRequired}},3340:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ElementContent=undefined;var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _lodash=__webpack_require__(1);var _render_functions_registry=__webpack_require__(1175);var _workpad=__webpack_require__(33);var _element_content=__webpack_require__(3342);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var mapStateToProps=function mapStateToProps(state){return{backgroundColor:(0,_workpad.getPageById)(state,(0,_workpad.getSelectedPage)(state)).style.background}};var ElementContent=exports.ElementContent=(0,_recompose.compose)((0,_reactRedux.connect)(mapStateToProps),(0,_recompose.withProps)(function(_ref){var renderable=_ref.renderable;return{renderFunction:_render_functions_registry.renderFunctionsRegistry.get((0,_lodash.get)(renderable,"as"))}}))(_element_content.ElementContent);ElementContent.propTypes={renderable:_propTypes2.default.shape({as:_propTypes2.default.string})}},3341:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RenderFunction=RenderFunction;function RenderFunction(config){this.name=config.name;this.displayName=config.displayName||this.name;this.help=config.help;this.validate=config.validate||function validate(){};this.reuseDomNode=Boolean(config.reuseDomNode);this.render=config.render||function render(domNode,data,done){done()}}},3342:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ElementContent=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _styleIt=__webpack_require__(715);var _styleIt2=_interopRequireDefault(_styleIt);var _common=__webpack_require__(41);var _loading=__webpack_require__(505);var _render_with_fn=__webpack_require__(3343);var _element_share_container=__webpack_require__(3346);var _invalid_expression=__webpack_require__(3348);var _invalid_element_type=__webpack_require__(3349);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var branches=[(0,_recompose.branch)(function(_ref){var renderable=_ref.renderable,state=_ref.state;return!state||!renderable},(0,_recompose.renderComponent)(function(_ref2){var backgroundColor=_ref2.backgroundColor;return _react2.default.createElement(_loading.Loading,{backgroundColor:backgroundColor})})),(0,_recompose.branch)(function(_ref3){var renderable=_ref3.renderable,renderFunction=_ref3.renderFunction;return renderable&&(0,_common.getType)(renderable)!=="render"&&!renderFunction},(0,_recompose.renderComponent)(_invalid_element_type.InvalidElementType)),(0,_recompose.branch)(function(_ref4){var renderable=_ref4.renderable,renderFunction=_ref4.renderFunction,state=_ref4.state;return state==="error"||(0,_common.getType)(renderable)!=="render"||!renderFunction},(0,_recompose.renderComponent)(_invalid_expression.InvalidExpression))];var ElementContent=exports.ElementContent=_recompose.compose.apply(undefined,[_recompose.pure].concat(branches))(function(_ref5){var renderable=_ref5.renderable,renderFunction=_ref5.renderFunction,size=_ref5.size,handlers=_ref5.handlers;var getFilter=handlers.getFilter,setFilter=handlers.setFilter,done=handlers.done,onComplete=handlers.onComplete;return _styleIt2.default.it(renderable.css,_react2.default.createElement("div",{className:"canvas__element canvasElement",style:_extends({},renderable.containerStyle,size),"data-test-subj":"canvasWorkpadPageElementContent"},_react2.default.createElement(_element_share_container.ElementShareContainer,{className:"canvasElement__content",onComplete:onComplete,functionName:renderFunction.name},_react2.default.createElement(_render_with_fn.RenderWithFn,{name:renderFunction.name,renderFn:renderFunction.render,reuseNode:renderFunction.reuseDomNode,config:renderable.value,css:renderable.css,size:size,handlers:{getFilter:getFilter,setFilter:setFilter,done:done}}))))});ElementContent.propTypes={renderable:_propTypes2.default.shape({css:_propTypes2.default.string,value:_propTypes2.default.object}),renderFunction:_propTypes2.default.shape({name:_propTypes2.default.string,render:_propTypes2.default.func,reuseDomNode:_propTypes2.default.bool}),size:_propTypes2.default.object,handlers:_propTypes2.default.shape({setFilter:_propTypes2.default.func.isRequired,getFilter:_propTypes2.default.func.isRequired,done:_propTypes2.default.func.isRequired,onComplete:_propTypes2.default.func.isRequired}).isRequired,state:_propTypes2.default.string,backgroundColor:_propTypes2.default.string}},3343:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RenderWithFn=undefined;var _recompose=__webpack_require__(19);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _notify=__webpack_require__(199);var _render_with_fn=__webpack_require__(3344);var _handlers=__webpack_require__(3345);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RenderWithFn=exports.RenderWithFn=(0,_recompose.compose)((0,_recompose.withPropsOnChange)(function(){return false},function(){return{elementHandlers:new _handlers.ElementHandlers}}),(0,_recompose.withProps)(function(_ref){var handlers=_ref.handlers,elementHandlers=_ref.elementHandlers;return{handlers:Object.assign(elementHandlers,handlers),onError:_notify.notify.error}}))(_render_with_fn.RenderWithFn);RenderWithFn.propTypes={handlers:_propTypes2.default.object,elementHandlers:_propTypes2.default.object}},3344:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RenderWithFn=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _lodash=__webpack_require__(1);var _render_to_dom=__webpack_require__(707);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var RenderWithFn=exports.RenderWithFn=function(_React$Component){_inherits(RenderWithFn,_React$Component);function RenderWithFn(){var _ref;var _temp,_this,_ret;_classCallCheck(this,RenderWithFn);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=RenderWithFn.__proto__||Object.getPrototypeOf(RenderWithFn)).call.apply(_ref,[this].concat(args))),_this),_this.callRenderFn=function(){var _this$props=_this.props,handlers=_this$props.handlers,config=_this$props.config,renderFn=_this$props.renderFn,reuseNode=_this$props.reuseNode,functionName=_this$props.name;if(!reuseNode||!_this.renderTarget){_this.resetRenderTarget(_this.domNode)}var renderConfig=(0,_lodash.cloneDeep)(config);try{renderFn(_this.renderTarget,renderConfig,handlers);_this.firstRender=false}catch(err){console.error("renderFn threw",err);_this.props.onError(err,{title:"Rendering '"+(functionName||"function")+"' failed"})}},_this.resetRenderTarget=function(domNode){var handlers=_this.props.handlers;if(!domNode){throw new Error("RenderWithFn can not reset undefined target node")}if(!_this.firstRender){handlers.destroy()}while(domNode.firstChild){domNode.removeChild(domNode.firstChild)}_this.firstRender=true;_this.renderTarget=_this.createRenderTarget();domNode.appendChild(_this.renderTarget)},_this.createRenderTarget=function(){var div=document.createElement("div");div.style.width="100%";div.style.height="100%";return div},_this.shouldFullRerender=function(prevProps){return!(0,_lodash.isEqual)(_this.props.config,prevProps.config)||!(0,_lodash.isEqual)(_this.props.renderFn.toString(),prevProps.renderFn.toString())},_this.destroy=function(){_this.props.handlers.destroy()},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(RenderWithFn,[{key:"componentDidMount",value:function componentDidMount(){this.firstRender=true;this.renderTarget=null}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(_ref2){var renderFn=_ref2.renderFn;var newRenderFunction=renderFn!==this.props.renderFn;if(newRenderFunction){this.resetRenderTarget(this.domNode)}}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(prevProps){return!(0,_lodash.isEqual)(this.props.size,prevProps.size)||this.shouldFullRerender(prevProps)}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var _props=this.props,handlers=_props.handlers,size=_props.size;if(this.shouldFullRerender(prevProps)){this.callRenderFn()}if(!(0,_lodash.isEqual)(size,prevProps.size)){return handlers.resize(size)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.handlers.destroy()}},{key:"render",value:function render(){var _this2=this;return _react2.default.createElement("div",{className:"canvasWorkpad--element_render canvasRenderEl",style:{height:"100%",width:"100%"}},_react2.default.createElement(_render_to_dom.RenderToDom,{style:{height:"100%",width:"100%"},render:function render(domNode){_this2.domNode=domNode;_this2.callRenderFn()}}))}}]);return RenderWithFn}(_react2.default.Component);RenderWithFn.propTypes={name:_propTypes2.default.string.isRequired,renderFn:_propTypes2.default.func.isRequired,reuseNode:_propTypes2.default.bool,handlers:_propTypes2.default.shape({setFilter:_propTypes2.default.func.isRequired,getFilter:_propTypes2.default.func.isRequired,done:_propTypes2.default.func.isRequired,resize:_propTypes2.default.func.isRequired,onResize:_propTypes2.default.func.isRequired,destroy:_propTypes2.default.func.isRequired,onDestroy:_propTypes2.default.func.isRequired}),config:_propTypes2.default.object.isRequired,size:_propTypes2.default.object.isRequired,onError:_propTypes2.default.func.isRequired};RenderWithFn.defaultProps={reuseNode:false};RenderWithFn.domNode=null},3345:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var ElementHandlers=exports.ElementHandlers=function(){function ElementHandlers(){_classCallCheck(this,ElementHandlers)}_createClass(ElementHandlers,[{key:"resize",value:function resize(){}},{key:"destroy",value:function destroy(){}},{key:"onResize",value:function onResize(fn){this.resize=fn}},{key:"onDestroy",value:function onDestroy(fn){this.destroy=fn}}]);return ElementHandlers}()},3346:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _element_share_container=__webpack_require__(3347);Object.defineProperty(exports,"ElementShareContainer",{enumerable:true,get:function get(){return _element_share_container.ElementShareContainer}})},3347:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ElementShareContainer=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ElementShareContainer=exports.ElementShareContainer=function(_React$PureComponent){_inherits(ElementShareContainer,_React$PureComponent);function ElementShareContainer(){var _ref;var _temp,_this,_ret;_classCallCheck(this,ElementShareContainer);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=ElementShareContainer.__proto__||Object.getPrototypeOf(ElementShareContainer)).call.apply(_ref,[this].concat(args))),_this),_this.state={renderComplete:false},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(ElementShareContainer,[{key:"componentDidMount",value:function componentDidMount(){var _this2=this;var _props=this.props,functionName=_props.functionName,onComplete=_props.onComplete;var isDevelopment="production"!=="production";if(isDevelopment){var timeout=15;this.timeout=setTimeout(function(){console.warn("done handler not called in render function after "+timeout+" seconds: "+functionName)},timeout*1e3)}onComplete(function(){clearTimeout(_this2.timeout);if(!_this2.sharedItemRef){return}var ev=new CustomEvent("renderComplete");_this2.sharedItemRef.dispatchEvent(ev);_this2.setState({renderComplete:true})})}},{key:"componentWillUnmount",value:function componentWillUnmount(){clearTimeout(this.timeout)}},{key:"render",value:function render(){var _this3=this;return _react2.default.createElement("div",{"data-shared-item":true,"data-render-complete":this.state.renderComplete,className:this.props.className,ref:function ref(_ref2){return _this3.sharedItemRef=_ref2}},this.props.children)}}]);return ElementShareContainer}(_react2.default.PureComponent);ElementShareContainer.propTypes={functionName:_propTypes2.default.string.isRequired,onComplete:_propTypes2.default.func.isRequired,className:_propTypes2.default.string,children:_propTypes2.default.node.isRequired}},3348:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.InvalidExpression=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var InvalidExpression=exports.InvalidExpression=function InvalidExpression(_ref){var selectElement=_ref.selectElement;return _react2.default.createElement("h3",{onClick:selectElement},"Invalid expression")};InvalidExpression.propTypes={selectElement:_propTypes2.default.func}},3349:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.InvalidElementType=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var InvalidElementType=exports.InvalidElementType=function InvalidElementType(_ref){var renderableType=_ref.renderableType,selectElement=_ref.selectElement;return _react2.default.createElement("h3",{onClick:selectElement},"Element not found: ",renderableType)};InvalidElementType.propTypes={renderableType:_propTypes2.default.string,selectElement:_propTypes2.default.func}},3350:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createHandlers=createHandlers;var _elements=__webpack_require__(61);function createHandlers(element,pageId,dispatch){var isComplete=false;var completeFn=function completeFn(){};return{setFilter:function setFilter(text){dispatch((0,_elements.setFilter)(text,element.id,pageId,true))},getFilter:function getFilter(){return element.filter},onComplete:function onComplete(fn){completeFn=fn},done:function done(){if(isComplete){return}isComplete=true;completeFn()}}}},3351:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AlignmentGuide=undefined;var _recompose=__webpack_require__(19);var _alignment_guide=__webpack_require__(3352);var AlignmentGuide=exports.AlignmentGuide=(0,_recompose.pure)(_alignment_guide.AlignmentGuide)},3352:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AlignmentGuide=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _aeroelastic=__webpack_require__(303);var _aeroelastic2=_interopRequireDefault(_aeroelastic);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var AlignmentGuide=exports.AlignmentGuide=function AlignmentGuide(_ref){var transformMatrix=_ref.transformMatrix,width=_ref.width,height=_ref.height;var newStyle={width:width,height:height,marginLeft:-width/2,marginTop:-height/2,background:"magenta",position:"absolute",transform:_aeroelastic2.default.dom.matrixToCSS(transformMatrix)};return _react2.default.createElement("div",{className:"canvasAlignmentGuide canvasInteractable canvasLayoutAnnotation",style:newStyle})};AlignmentGuide.propTypes={transformMatrix:_propTypes2.default.arrayOf(_propTypes2.default.number).isRequired,width:_propTypes2.default.number.isRequired,height:_propTypes2.default.number.isRequired}},3353:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.HoverAnnotation=undefined;var _recompose=__webpack_require__(19);var _hover_annotation=__webpack_require__(3354);var HoverAnnotation=exports.HoverAnnotation=(0,_recompose.pure)(_hover_annotation.HoverAnnotation)},3354:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.HoverAnnotation=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _aeroelastic=__webpack_require__(303);var _aeroelastic2=_interopRequireDefault(_aeroelastic);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var HoverAnnotation=exports.HoverAnnotation=function HoverAnnotation(_ref){var transformMatrix=_ref.transformMatrix,width=_ref.width,height=_ref.height;var newStyle={width:width,height:height,marginLeft:-width/2,marginTop:-height/2,transform:_aeroelastic2.default.dom.matrixToCSS(transformMatrix)};return _react2.default.createElement("div",{className:"canvasHoverAnnotation canvasLayoutAnnotation",style:newStyle})};HoverAnnotation.propTypes={transformMatrix:_propTypes2.default.arrayOf(_propTypes2.default.number).isRequired,width:_propTypes2.default.number.isRequired,height:_propTypes2.default.number.isRequired}},3355:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RotationHandle=undefined;var _recompose=__webpack_require__(19);var _rotation_handle=__webpack_require__(3356);var RotationHandle=exports.RotationHandle=(0,_recompose.pure)(_rotation_handle.RotationHandle)},3356:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RotationHandle=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _aeroelastic=__webpack_require__(303);var _aeroelastic2=_interopRequireDefault(_aeroelastic);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var RotationHandle=exports.RotationHandle=function RotationHandle(_ref){var transformMatrix=_ref.transformMatrix;return _react2.default.createElement("div",{className:"canvasRotationHandle canvasRotationHandle--connector canvasLayoutAnnotation",style:{transform:_aeroelastic2.default.dom.matrixToCSS(transformMatrix)}},_react2.default.createElement("div",{className:"canvasRotationHandle--handle"}))};RotationHandle.propTypes={transformMatrix:_propTypes2.default.arrayOf(_propTypes2.default.number).isRequired}},3357:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BorderConnection=undefined;var _recompose=__webpack_require__(19);var _border_connection=__webpack_require__(3358);var BorderConnection=exports.BorderConnection=(0,_recompose.pure)(_border_connection.BorderConnection)},3358:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BorderConnection=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _aeroelastic=__webpack_require__(303);var _aeroelastic2=_interopRequireDefault(_aeroelastic);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var BorderConnection=exports.BorderConnection=function BorderConnection(_ref){var transformMatrix=_ref.transformMatrix,width=_ref.width,height=_ref.height;var newStyle={width:width,height:height,marginLeft:-width/2,marginTop:-height/2,position:"absolute",transform:_aeroelastic2.default.dom.matrixToCSS(transformMatrix)};return _react2.default.createElement("div",{className:"canvasBorder--connection canvasLayoutAnnotation",style:newStyle})};BorderConnection.propTypes={width:_propTypes2.default.number.isRequired,height:_propTypes2.default.number.isRequired,transformMatrix:_propTypes2.default.arrayOf(_propTypes2.default.number).isRequired}},3359:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BorderResizeHandle=undefined;var _recompose=__webpack_require__(19);var _border_resize_handle=__webpack_require__(3360);var BorderResizeHandle=exports.BorderResizeHandle=(0,_recompose.pure)(_border_resize_handle.BorderResizeHandle)},3360:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BorderResizeHandle=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _aeroelastic=__webpack_require__(303);var _aeroelastic2=_interopRequireDefault(_aeroelastic);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var BorderResizeHandle=exports.BorderResizeHandle=function BorderResizeHandle(_ref){var transformMatrix=_ref.transformMatrix;return _react2.default.createElement("div",{className:"canvasBorderResizeHandle canvasLayoutAnnotation",style:{transform:_aeroelastic2.default.dom.matrixToCSS(transformMatrix)}})};BorderResizeHandle.propTypes={transformMatrix:_propTypes2.default.arrayOf(_propTypes2.default.number).isRequired}},3361:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Fullscreen=undefined;var _reactRedux=__webpack_require__(14);var _app=__webpack_require__(72);var _fullscreen=__webpack_require__(3362);var mapStateToProps=function mapStateToProps(state){return{isFullscreen:(0,_app.getFullscreen)(state)}};var Fullscreen=exports.Fullscreen=(0,_reactRedux.connect)(mapStateToProps)(_fullscreen.Fullscreen)},3362:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Fullscreen=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _lodash=__webpack_require__(1);var _get_window=__webpack_require__(245);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Fullscreen=exports.Fullscreen=function(_React$Component){_inherits(Fullscreen,_React$Component);function Fullscreen(){var _ref;var _temp,_this,_ret;_classCallCheck(this,Fullscreen);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=Fullscreen.__proto__||Object.getPrototypeOf(Fullscreen)).call.apply(_ref,[this].concat(args))),_this),_this.state={width:0,height:0},_this.getWindowSize=function(){return{width:_this.win.innerWidth,height:_this.win.innerHeight}},_this.onWindowResize=(0,_lodash.debounce)(function(){var _this$getWindowSize=_this.getWindowSize(),width=_this$getWindowSize.width,height=_this$getWindowSize.height;_this.setState({width:width,height:height})},100),_temp),_possibleConstructorReturn(_this,_ret)}_createClass(Fullscreen,[{key:"componentWillMount",value:function componentWillMount(){this.win=(0,_get_window.getWindow)();this.setState({width:this.win.innerWidth,height:this.win.innerHeight})}},{key:"componentDidMount",value:function componentDidMount(){this.win.addEventListener("resize",this.onWindowResize)}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.win.removeEventListener("resize",this.onWindowResize)}},{key:"render",value:function render(){var _props=this.props,isFullscreen=_props.isFullscreen,children=_props.children;var windowSize={width:this.state.width,height:this.state.height};return children({isFullscreen:isFullscreen,windowSize:windowSize})}}]);return Fullscreen}(_react2.default.Component);Fullscreen.propTypes={isFullscreen:_propTypes2.default.bool,children:_propTypes2.default.func}},3363:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadHeader=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _recompose=__webpack_require__(19);var _reactRedux=__webpack_require__(14);var _app=__webpack_require__(72);var _workpad=__webpack_require__(33);var _workpad2=__webpack_require__(180);var _assets=__webpack_require__(304);var _elements=__webpack_require__(61);var _workpad_header=__webpack_require__(3364);var mapStateToProps=function mapStateToProps(state){return{isWriteable:(0,_workpad.isWriteable)(state)&&(0,_app.canUserWrite)(state),canUserWrite:(0,_app.canUserWrite)(state),workpadName:(0,_workpad.getWorkpadName)(state),selectedPage:(0,_workpad.getSelectedPage)(state),hasAssets:Object.keys((0,_assets.getAssets)(state)).length?true:false}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setWriteable:function setWriteable(isWriteable){return dispatch((0,_workpad2.setWriteable)(isWriteable))},addElement:function addElement(pageId){return function(partialElement){return dispatch((0,_elements.addElement)(pageId,partialElement))}}}};var mergeProps=function mergeProps(stateProps,dispatchProps,ownProps){return _extends({},stateProps,dispatchProps,ownProps,{addElement:dispatchProps.addElement(stateProps.selectedPage),toggleWriteable:function toggleWriteable(){return dispatchProps.setWriteable(!stateProps.isWriteable)}})};var WorkpadHeader=exports.WorkpadHeader=(0,_recompose.compose)((0,_recompose.withState)("showElementModal","setShowElementModal",false),(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,mergeProps))(_workpad_header.WorkpadHeader)},3364:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadHeader=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactShortcuts=__webpack_require__(419);var _eui=__webpack_require__(2);var _asset_manager=__webpack_require__(3365);var _element_types=__webpack_require__(3374);var _workpad_export=__webpack_require__(3377);var _fullscreen_control=__webpack_require__(3380);var _refresh_control=__webpack_require__(3382);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var WorkpadHeader=exports.WorkpadHeader=function WorkpadHeader(_ref){var isWriteable=_ref.isWriteable,canUserWrite=_ref.canUserWrite,toggleWriteable=_ref.toggleWriteable,hasAssets=_ref.hasAssets,addElement=_ref.addElement,setShowElementModal=_ref.setShowElementModal,showElementModal=_ref.showElementModal;var keyHandler=function keyHandler(action){if(action==="EDITING"){toggleWriteable()}};var elementAdd=_react2.default.createElement(_eui.EuiOverlayMask,null,_react2.default.createElement(_eui.EuiModal,{onClose:function onClose(){return setShowElementModal(false)},className:"canvasModal--fixedSize",maxWidth:"1000px",initialFocus:".canvasElements__filter"},_react2.default.createElement(_element_types.ElementTypes,{onClick:function onClick(element){addElement(element);setShowElementModal(false)}}),_react2.default.createElement(_eui.EuiModalFooter,null,_react2.default.createElement(_eui.EuiButton,{size:"s",onClick:function onClick(){return setShowElementModal(false)}},"Dismiss"))));var readOnlyToolTip="";if(!canUserWrite){readOnlyToolTip="You don't have permission to edit this workpad"}else{readOnlyToolTip=isWriteable?"Hide editing controls":"Show editing controls"}return _react2.default.createElement("div",null,showElementModal?elementAdd:null,_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s",alignItems:"center",justifyContent:"spaceBetween"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_refresh_control.RefreshControl,null)),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_fullscreen_control.FullscreenControl,null,function(_ref2){var toggleFullscreen=_ref2.toggleFullscreen;return _react2.default.createElement(_eui.EuiToolTip,{position:"bottom",content:"Toggle fullscreen mode"},_react2.default.createElement(_eui.EuiButtonIcon,{iconType:"fullScreen","aria-label":"View fullscreen",onClick:toggleFullscreen}))})),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_workpad_export.WorkpadExport,null)),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},canUserWrite&&_react2.default.createElement(_reactShortcuts.Shortcuts,{name:"EDITOR",handler:keyHandler,targetNodeSelector:"body",global:true}),_react2.default.createElement(_eui.EuiToolTip,{position:"bottom",content:readOnlyToolTip},_react2.default.createElement(_eui.EuiButtonIcon,{iconType:isWriteable?"lockOpen":"lock",onClick:function onClick(){toggleWriteable()},size:"s","aria-label":readOnlyToolTip,isDisabled:!canUserWrite}))))),isWriteable?_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},hasAssets&&_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_asset_manager.AssetManager,null)),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButton,{fill:true,size:"s",iconType:"vector",onClick:function onClick(){return setShowElementModal(true)}},"Add element")))):null))};WorkpadHeader.propTypes={isWriteable:_propTypes2.default.bool,toggleWriteable:_propTypes2.default.func,hasAssets:_propTypes2.default.bool,addElement:_propTypes2.default.func.isRequired,showElementModal:_propTypes2.default.bool,setShowElementModal:_propTypes2.default.func}},3365:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AssetManager=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);var _notify=__webpack_require__(199);var _assets=__webpack_require__(304);var _assets2=__webpack_require__(306);var _elements_registry=__webpack_require__(713);var _elements=__webpack_require__(61);var _workpad=__webpack_require__(33);var _asset_manager=__webpack_require__(3368);var mapStateToProps=function mapStateToProps(state){return{assets:Object.values((0,_assets.getAssets)(state)),selectedPage:(0,_workpad.getSelectedPage)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{addImageElement:function addImageElement(pageId){return function(assetId){var imageElement=_elements_registry.elementsRegistry.get("image");var elementAST=(0,_common.fromExpression)(imageElement.expression);var selector=["chain","0","arguments","dataurl"];var subExp=[{type:"expression",chain:[{type:"function",function:"asset",arguments:{_:[assetId]}}]}];var newAST=(0,_lodash.set)(elementAST,selector,subExp);imageElement.expression=(0,_common.toExpression)(newAST);dispatch((0,_elements.addElement)(pageId,imageElement))}},removeAsset:function removeAsset(assetId){return dispatch((0,_assets2.removeAsset)(assetId))}}};var mergeProps=function mergeProps(stateProps,dispatchProps,ownProps){return _extends({},ownProps,stateProps,dispatchProps,{addImageElement:dispatchProps.addImageElement(stateProps.selectedPage)})};var AssetManager=exports.AssetManager=(0,_recompose.compose)((0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,mergeProps),(0,_recompose.withProps)({copyAsset:function copyAsset(assetId){return _notify.notify.success("Copied '"+assetId+"' to clipboard")}}))(_asset_manager.AssetManager)},3366:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Element=Element;var _default_header=__webpack_require__(3367);var _default_header2=_interopRequireDefault(_default_header);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function Element(config){this.name=config.name;this.displayName=config.displayName||this.name;this.image=config.image||_default_header2.default;this.help=config.help;if(!config.expression){throw new Error("Element types must have a default expression")}this.expression=config.expression;this.filter=config.filter;this.width=config.width||500;this.height=config.height||300}},3367:function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAACgBAMAAADQnCfmAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAASUExURUdwTAB4pgB6pwB5pgB5pgB4pSFSg2UAAAAFdFJOUwDXMaFmT4xB8wAAAepJREFUeNrtms1OwlAQRkt/9qB2DybdN/7sUcKeIvP+ryIYbS90Kpq48Juc8wQc7sx8t9NmGQAAAAAAAAD8kvx+GUBis7Aj3e2rtsemti/e1roa5aBx4iGIh9mNaHtceqiajD3MFPtk5XjYm2CDmItecT37Ip1aNhY2wTzGgRyPJESHnGilRJppkb1qhnSPT5tatbaSVr/7GFMvoqHYjHJjO4jsFGfWwbl4CaV77pRRodgkxehAzvp/qdciaWZUgknSt4ifkTq3lNqprKS29nK9fv7Xb831U7honUdfJSdS+OOpkAuSmf+DSzmRxi+hXC4Rt/500hW5vB2aFy8KeTiPItJOiHTiIno9UgcX0cuRxSfrTDzZrwS+zl3rSryIbbbGyK5/p+7EYkvT6Qd5oeXD9w/yXZTKOgQ5EPFeT9bayyAHol1ZK4sxfJNdvPbMaixGq5fC79n966LsB0LjA8mCHEgb5EC0nw0r7c+14oV6HuWWNYsxepOZpZ2FSWWJL0/KICNraBH1/WITZAk09Lq4Rx+H6gvf/h3DXF0kSovkQfakfYx0WRAR9RTpN4yHKCL7KCI7dZFZlBhB5L+KtIgAAAAA/DVVlI+0EEEEEUQQQQQRRBBBBBFEEAEAAAAAAAAAAAAAAACAH/EOe5WV1HX1GeIAAAAASUVORK5CYII="},3368:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AssetManager=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _confirm_modal=__webpack_require__(702);var _clipboard=__webpack_require__(1176);var _download=__webpack_require__(3370);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var AssetManager=exports.AssetManager=function(_React$PureComponent){_inherits(AssetManager,_React$PureComponent);function AssetManager(){var _ref;var _temp,_this,_ret;_classCallCheck(this,AssetManager);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=AssetManager.__proto__||Object.getPrototypeOf(AssetManager)).call.apply(_ref,[this].concat(args))),_this),_this.state={deleteId:null,isModalVisible:false},_this.showModal=function(){return _this.setState({isModalVisible:true})},_this.closeModal=function(){return _this.setState({isModalVisible:false})},_this.doDelete=function(){_this.resetDelete();_this.props.removeAsset(_this.state.deleteId)},_this.addElement=function(assetId){_this.props.addImageElement(assetId)},_this.resetDelete=function(){return _this.setState({deleteId:null})},_this.renderAsset=function(asset){return _react2.default.createElement(_eui.EuiFlexItem,{key:asset.id},_react2.default.createElement(_eui.EuiPanel,{className:"canvasAssetManager__asset",paddingSize:"s"},_react2.default.createElement("div",{className:"canvasAssetManager__thumb canvasCheckered"},_react2.default.createElement(_eui.EuiImage,{className:"canvasAssetManager__img",size:"original",url:asset.value,fullScreenIconColor:"dark",alt:"Asset thumbnail",style:{backgroundImage:"url("+asset.value+")"}})),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,{size:"xs",className:"eui-textBreakAll"},_react2.default.createElement("p",{className:"eui-textBreakAll"},_react2.default.createElement("strong",null,asset.id),_react2.default.createElement("br",null),_react2.default.createElement(_eui.EuiTextColor,{color:"subdued"},_react2.default.createElement("small",null,"(",Math.round(asset.value.length/1024)," kb)")))),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"baseline",justifyContent:"center",responsive:false},_react2.default.createElement(_eui.EuiFlexItem,{className:"asset-create-image",grow:false},_react2.default.createElement(_eui.EuiToolTip,{content:"Create image element"},_react2.default.createElement(_eui.EuiButtonIcon,{iconType:"vector","aria-label":"Create image element",onClick:function onClick(){_this.addElement(asset.id);_this.closeModal()}}))),_react2.default.createElement(_eui.EuiFlexItem,{className:"asset-download",grow:false},_react2.default.createElement(_eui.EuiToolTip,{content:"Download"},_react2.default.createElement(_download.Download,{fileName:asset.id,content:asset.value},_react2.default.createElement(_eui.EuiButtonIcon,{iconType:"sortDown","aria-label":"Download"})))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{content:"Copy id to clipboard"},_react2.default.createElement(_clipboard.Clipboard,{content:asset.id,onCopy:function onCopy(result){return result&&_this.props.copyAsset(asset.id)}},_react2.default.createElement(_eui.EuiButtonIcon,{iconType:"copyClipboard","aria-label":"Copy id to clipboard"})))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiToolTip,{content:"Delete"},_react2.default.createElement(_eui.EuiButtonIcon,{color:"danger",iconType:"trash","aria-label":"Delete",onClick:function onClick(){return _this.setState({deleteId:asset.id})}}))))))},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(AssetManager,[{key:"render",value:function render(){var isModalVisible=this.state.isModalVisible;var assetMaxLimit=25e3;var assetsTotal=Math.round(this.props.assets.reduce(function(total,asset){return total+asset.value.length},0)/1024);var percentageUsed=Math.round(assetsTotal/assetMaxLimit*100);var assetModal=isModalVisible?_react2.default.createElement(_eui.EuiOverlayMask,null,_react2.default.createElement(_eui.EuiModal,{onClose:this.closeModal,className:"canvasAssetManager canvasModal--fixedSize",maxWidth:"1000px"},_react2.default.createElement(_eui.EuiModalHeader,{className:"canvasAssetManager__modalHeader"},_react2.default.createElement(_eui.EuiModalHeaderTitle,{className:"canvasAssetManager__modalHeaderTitle"},"Manage workpad assets"),_react2.default.createElement(_eui.EuiFlexGroup,{className:"canvasAssetManager__meterWrapper",responsive:false},_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiProgress,{value:assetsTotal,max:assetMaxLimit,color:percentageUsed<90?"secondary":"danger",size:"s","aria-labelledby":"CanvasAssetManagerLabel"})),_react2.default.createElement(_eui.EuiFlexItem,{grow:false,className:"eui-textNoWrap"},_react2.default.createElement(_eui.EuiText,{id:"CanvasAssetManagerLabel"},percentageUsed,"% space used")))),_react2.default.createElement(_eui.EuiModalBody,null,_react2.default.createElement(_eui.EuiText,{size:"s",color:"subdued"},_react2.default.createElement("p",null,"Below are the image assets that you added to this workpad. To reclaim space, delete assets that you no longer need. Unfortunately, any assets that are actually in use cannot be determined at this time.")),_react2.default.createElement(_eui.EuiFlexGrid,{responsive:false,columns:4},this.props.assets.map(this.renderAsset))),_react2.default.createElement(_eui.EuiModalFooter,null,_react2.default.createElement(_eui.EuiButton,{size:"s",onClick:this.closeModal},"Close")))):null;return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiButtonEmpty,{size:"s",onClick:this.showModal},"Manage assets"),assetModal,_react2.default.createElement(_confirm_modal.ConfirmModal,{isOpen:this.state.deleteId!=null,title:"Remove Asset",message:"Are you sure you want to remove this asset?",confirmButtonText:"Remove",onConfirm:this.doDelete,onCancel:this.resetDelete}))}}]);return AssetManager}(_react2.default.PureComponent);AssetManager.propTypes={assets:_propTypes2.default.array,addImageElement:_propTypes2.default.func,removeAsset:_propTypes2.default.func,copyAsset:_propTypes2.default.func}},3369:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Clipboard=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _copyToClipboard=__webpack_require__(1178);var _copyToClipboard2=_interopRequireDefault(_copyToClipboard);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Clipboard=exports.Clipboard=function(_React$PureComponent){_inherits(Clipboard,_React$PureComponent);function Clipboard(){var _ref;var _temp,_this,_ret;_classCallCheck(this,Clipboard);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=Clipboard.__proto__||Object.getPrototypeOf(Clipboard)).call.apply(_ref,[this].concat(args))),_this),_this.onClick=function(ev){var _this$props=_this.props,content=_this$props.content,onCopy=_this$props.onCopy;ev.preventDefault();var result=(0,_copyToClipboard2.default)(content,{debug:true});if(typeof onCopy==="function"){onCopy(result)}},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(Clipboard,[{key:"render",value:function render(){return _react2.default.createElement("div",{className:"canvas_clipboard",onClick:this.onClick},this.props.children)}}]);return Clipboard}(_react2.default.PureComponent);Clipboard.propTypes={children:_propTypes2.default.element.isRequired,content:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.number]).isRequired,onCopy:_propTypes2.default.func}},3370:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Download=undefined;var _download=__webpack_require__(3371);var Download=exports.Download=_download.Download},3371:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Download=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _fileSaver=__webpack_require__(1177);var _fileSaver2=_interopRequireDefault(_fileSaver);var _base64Js=__webpack_require__(1182);var _dataurl=__webpack_require__(3372);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Download=exports.Download=function(_React$PureComponent){_inherits(Download,_React$PureComponent);function Download(){var _ref;var _temp,_this,_ret;_classCallCheck(this,Download);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=Download.__proto__||Object.getPrototypeOf(Download)).call.apply(_ref,[this].concat(args))),_this),_this.onClick=function(){var _this$props=_this.props,fileName=_this$props.fileName,content=_this$props.content;var asset=(0,_dataurl.parseDataUrl)(content,true);var assetBlob=new Blob([(0,_base64Js.toByteArray)(asset.data)],{type:asset.mimetype});var ext=asset.extension?"."+asset.extension:"";_fileSaver2.default.saveAs(assetBlob,"canvas-"+fileName+ext)},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(Download,[{key:"render",value:function render(){return _react2.default.createElement("div",{className:"canvas_download",onClick:this.onClick},this.props.children)}}]);return Download}(_react2.default.PureComponent);Download.propTypes={children:_propTypes2.default.element.isRequired,fileName:_propTypes2.default.string,content:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.number]).isRequired,onCopy:_propTypes2.default.func}},3372:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.imageTypes=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();exports.parseDataUrl=parseDataUrl;exports.isValidDataUrl=isValidDataUrl;exports.encode=encode;var _base64Js=__webpack_require__(1182);var _lite=__webpack_require__(5017);var _lite2=_interopRequireDefault(_lite);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var dataurlRegex=/^data:([a-z]+\/[a-z0-9-+.]+)(;[a-z-]+=[a-z0-9-]+)?(;([a-z0-9]+))?,/;var imageTypes=exports.imageTypes=["image/svg+xml","image/jpeg","image/png","image/gif"];function parseDataUrl(str){var withData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(typeof str!=="string"){return}var matches=str.match(dataurlRegex);if(!matches){return}var _matches=_slicedToArray(matches,5),mimetype=_matches[1],charset=_matches[2],encoding=_matches[4];var imageTypeIndex=imageTypes.indexOf(matches[1]);if(imageTypeIndex>0&&encoding!=="base64"){return}return{mimetype:mimetype,encoding:encoding,charset:charset&&charset.split("=")[1],data:!withData?null:str.split(",")[1],isImage:imageTypeIndex>=0,extension:_lite2.default.getExtension(mimetype)}}function isValidDataUrl(str){return dataurlRegex.test(str)}function encode(data){var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"text/plain";if(FileReader){return new Promise(function(resolve,reject){var reader=new FileReader;reader.onloadend=function(){return resolve(reader.result)};reader.onerror=function(err){return reject(err)};reader.readAsDataURL(data)})}return Promise.resolve("data:"+type+";base64,"+(0,_base64Js.fromByteArray)(data))}},3374:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ElementTypes=undefined;var _recompose=__webpack_require__(19);var _elements_registry=__webpack_require__(713);var _element_types=__webpack_require__(3375);var elementTypesState=(0,_recompose.withState)("search","setSearch");var elementTypeProps=(0,_recompose.withProps)(function(){return{elements:_elements_registry.elementsRegistry.toJS()}});var ElementTypes=exports.ElementTypes=(0,_recompose.compose)(_recompose.pure,elementTypesState,elementTypeProps)(_element_types.ElementTypes)},3375:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ElementTypes=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(5018);var _lodash2=_interopRequireDefault(_lodash);var _lodash3=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ElementTypes=exports.ElementTypes=function ElementTypes(_ref){var elements=_ref.elements,onClick=_ref.onClick,search=_ref.search,setSearch=_ref.setSearch;search=(0,_lodash2.default)(search);elements=(0,_lodash3.sortBy)((0,_lodash3.map)(elements,function(element,name){return _extends({name:name},element)}),"displayName");var elementList=(0,_lodash3.map)(elements,function(element,name){var help=element.help,displayName=element.displayName,expression=element.expression,filter=element.filter,width=element.width,height=element.height,image=element.image;var whenClicked=function whenClicked(){return onClick({expression:expression,filter:filter,width:width,height:height})};var card=_react2.default.createElement(_eui.EuiFlexItem,{key:name},_react2.default.createElement(_eui.EuiCard,{textAlign:"left",image:image,title:displayName,description:help,onClick:whenClicked,className:"canvasCard"}));if(!search){return card}if((0,_lodash3.includes)((0,_lodash2.default)(name),search)){return card}if((0,_lodash3.includes)((0,_lodash2.default)(displayName),search)){return card}if((0,_lodash3.includes)((0,_lodash2.default)(help),search)){return card}return null});return _react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiModalHeader,null,_react2.default.createElement(_eui.EuiFlexGroup,null,_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiFieldSearch,{className:"canvasElements__filter",placeholder:"Filter elements",onChange:function onChange(e){return setSearch(e.target.value)},value:search})))),_react2.default.createElement(_eui.EuiModalBody,null,_react2.default.createElement(_eui.EuiFlexGrid,{gutterSize:"l",columns:4},elementList)))};ElementTypes.propTypes={elements:_propTypes2.default.object,onClick:_propTypes2.default.func,search:_propTypes2.default.string,setSearch:_propTypes2.default.func}},3377:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadExport=undefined;var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _job_completion_notifications=__webpack_require__(569);var _workpad=__webpack_require__(33);var _app=__webpack_require__(72);var _notify=__webpack_require__(199);var _get_window=__webpack_require__(245);var _workpad_export=__webpack_require__(3378);var _utils=__webpack_require__(3379);var mapStateToProps=function mapStateToProps(state){return{workpad:(0,_workpad.getWorkpad)(state),pageCount:(0,_workpad.getPages)(state).length,enabled:(0,_app.getReportingBrowserType)(state)==="chromium"}};var getAbsoluteUrl=function getAbsoluteUrl(path){var _getWindow=(0,_get_window.getWindow)(),location=_getWindow.location;if(!location){return path}var protocol=location.protocol,hostname=location.hostname,port=location.port;return protocol+"//"+hostname+":"+port+path};var WorkpadExport=exports.WorkpadExport=(0,_recompose.compose)((0,_reactRedux.connect)(mapStateToProps),(0,_recompose.withProps)(function(_ref){var workpad=_ref.workpad,pageCount=_ref.pageCount;return{getExportUrl:function getExportUrl(type){if(type==="pdf"){return getAbsoluteUrl((0,_utils.getPdfUrl)(workpad,{pageCount:pageCount}))}throw new Error("Unknown export type: "+type)},onCopy:function onCopy(type){if(type==="pdf"){return _notify.notify.info("The PDF generation URL was copied to your clipboard.")}throw new Error("Unknown export type: "+type)},onExport:function onExport(type){if(type==="pdf"){return(0,_utils.createPdf)(workpad,{pageCount:pageCount}).then(function(_ref2){var data=_ref2.data;_notify.notify.info("Exporting PDF. You can track the progress in Management.",{title:"PDF export of workpad '"+workpad.name+"'"});_job_completion_notifications.jobCompletionNotifications.add(data.job.id)}).catch(function(err){_notify.notify.error(err,{title:"Failed to create PDF for '"+workpad.name+"'"})})}throw new Error("Unknown export type: "+type)}}}))(_workpad_export.WorkpadExport)},3378:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.WorkpadExport=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _popover=__webpack_require__(504);var _clipboard=__webpack_require__(1176);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var WorkpadExport=exports.WorkpadExport=function(_React$PureComponent){_inherits(WorkpadExport,_React$PureComponent);function WorkpadExport(){var _ref;var _temp,_this,_ret;_classCallCheck(this,WorkpadExport);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=WorkpadExport.__proto__||Object.getPrototypeOf(WorkpadExport)).call.apply(_ref,[this].concat(args))),_this),_this.exportPdf=function(){_this.props.onExport("pdf")},_this.renderControls=function(closePopover){var pdfUrl=_this.props.getExportUrl("pdf");return _react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiFlexGroup,{justifyContent:"spaceAround"},_react2.default.createElement(_eui.EuiFlexItem,{grow:true},_react2.default.createElement(_eui.EuiFormRow,{label:"Click below to create a PDF. You'll be notified when the export is complete"},_react2.default.createElement(_eui.EuiButton,{onClick:function onClick(){_this.exportPdf();closePopover()}},"Export as PDF")))),_react2.default.createElement(_eui.EuiHorizontalRule,{size:"half"}),_react2.default.createElement(_eui.EuiFormRow,{label:"To generate a PDF from a script or with Watcher, use this URL."},_react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center"},_react2.default.createElement(_eui.EuiFlexItem,{style:{overflow:"auto"}},_react2.default.createElement(_eui.EuiCodeBlock,{style:{whiteSpace:"nowrap"},paddingSize:"s"},pdfUrl)),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_clipboard.Clipboard,{content:pdfUrl,onCopy:function onCopy(){_this.props.onCopy("pdf");closePopover()}},_react2.default.createElement(_eui.EuiButtonIcon,{"aria-label":"Copy to clipboard",iconType:"copy"}))))))},_this.renderDisabled=function(){return _react2.default.createElement("div",null,"Export to PDF is disabled. You must configure reporting to use the Chromium browser. Add this to your kibana.yml file.",_react2.default.createElement(_eui.EuiSpacer,null),_react2.default.createElement(_eui.EuiCodeBlock,{paddingSize:"s",language:"yml"},"xpack.reporting.capture.browser.type: chromium"))},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(WorkpadExport,[{key:"render",value:function render(){var _this2=this;var exportControl=function exportControl(togglePopover){return _react2.default.createElement(_eui.EuiButtonIcon,{iconType:"exportAction","aria-label":"Create PDF",onClick:togglePopover})};return _react2.default.createElement(_popover.Popover,{button:exportControl,tooltip:"Export workpad",tooltipPosition:"bottom"},function(_ref2){var closePopover=_ref2.closePopover;return _react2.default.createElement(_eui.EuiFlexGroup,{justifyContent:"flexEnd"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false,style:{maxWidth:"300px"}},_this2.props.enabled&&_this2.renderControls(closePopover),!_this2.props.enabled&&_this2.renderDisabled()))})}}]);return WorkpadExport}(_react2.default.PureComponent);WorkpadExport.propTypes={enabled:_propTypes2.default.bool.isRequired,onCopy:_propTypes2.default.func.isRequired,onExport:_propTypes2.default.func.isRequired,getExportUrl:_propTypes2.default.func.isRequired}},3379:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getPdfUrl=getPdfUrl;exports.createPdf=createPdf;var _chrome=__webpack_require__(8);var _chrome2=_interopRequireDefault(_chrome);var _query_string=__webpack_require__(552);var _risonNode=__webpack_require__(206);var _risonNode2=_interopRequireDefault(_risonNode);var _fetch=__webpack_require__(501);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var PDF_LAYOUT_TYPE="preserve_layout";function getPdfUrl(_ref,_ref2){var id=_ref.id,title=_ref.name,width=_ref.width,height=_ref.height;var pageCount=_ref2.pageCount;var reportingEntry=_chrome2.default.addBasePath("/api/reporting/generate");var canvasEntry="/app/canvas#";var workpadUrls=[];for(var i=1;i<=pageCount;i++){workpadUrls.push(_risonNode2.default.encode(canvasEntry+"/export/workpad/pdf/"+id+"/page/"+i))}var jobParams={browserTimezone:"America/Phoenix",layout:{dimensions:{width:width,height:height},id:PDF_LAYOUT_TYPE},objectType:"canvas workpad",relativeUrls:workpadUrls,title:title};return reportingEntry+"/printablePdf?"+_query_string.QueryString.param("jobParams",_risonNode2.default.encode(jobParams))}function createPdf(){var createPdfUri=getPdfUrl.apply(undefined,arguments);return _fetch.fetch.post(createPdfUri)}},3380:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FullscreenControl=undefined;var _reactRedux=__webpack_require__(14);var _transient=__webpack_require__(230);var _app=__webpack_require__(72);var _fullscreen_control=__webpack_require__(3381);var mapStateToProps=function mapStateToProps(state){return{isFullscreen:(0,_app.getFullscreen)(state)}};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setFullscreen:function setFullscreen(value){dispatch((0,_transient.setFullscreen)(value));value&&dispatch((0,_transient.selectElement)(null))}}};var FullscreenControl=exports.FullscreenControl=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(_fullscreen_control.FullscreenControl)},3381:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FullscreenControl=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _reactShortcuts=__webpack_require__(419);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var FullscreenControl=exports.FullscreenControl=function(_React$PureComponent){_inherits(FullscreenControl,_React$PureComponent);function FullscreenControl(){var _ref;var _temp,_this,_ret;_classCallCheck(this,FullscreenControl);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=FullscreenControl.__proto__||Object.getPrototypeOf(FullscreenControl)).call.apply(_ref,[this].concat(args))),_this),_this.toggleFullscreen=function(){var _this$props=_this.props,setFullscreen=_this$props.setFullscreen,isFullscreen=_this$props.isFullscreen;setFullscreen(!isFullscreen)},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(FullscreenControl,[{key:"render",value:function render(){var _this2=this;var _props=this.props,children=_props.children,isFullscreen=_props.isFullscreen;var keyHandler=function keyHandler(action){if(action==="FULLSCREEN"||isFullscreen&&action==="FULLSCREEN_EXIT"){_this2.toggleFullscreen()}};return _react2.default.createElement("span",null,_react2.default.createElement(_reactShortcuts.Shortcuts,{name:"EDITOR",handler:keyHandler,targetNodeSelector:"body",global:true,isolate:true}),children({isFullscreen:isFullscreen,toggleFullscreen:this.toggleFullscreen}))}}]);return FullscreenControl}(_react2.default.PureComponent);FullscreenControl.propTypes={setFullscreen:_propTypes2.default.func.isRequired,isFullscreen:_propTypes2.default.bool.isRequired,children:_propTypes2.default.func.isRequired}},3382:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RefreshControl=undefined;var _reactRedux=__webpack_require__(14);var _elements=__webpack_require__(61);var _workpad=__webpack_require__(180);var _resolved_args=__webpack_require__(701);var _workpad2=__webpack_require__(33);var _refresh_control=__webpack_require__(3383);var mapStateToProps=function mapStateToProps(state){return{inFlight:(0,_resolved_args.getInFlight)(state),refreshInterval:(0,_workpad2.getRefreshInterval)(state)}};var mapDispatchToProps={doRefresh:_elements.fetchAllRenderables,setRefreshInterval:_workpad.setRefreshInterval};var RefreshControl=exports.RefreshControl=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(_refresh_control.RefreshControl)},3383:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RefreshControl=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _popover=__webpack_require__(504);var _auto_refresh_controls=__webpack_require__(3384);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var getRefreshInterval=function getRefreshInterval(){var val=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";if(!isNaN(Number(val))){return val}var match=String(val).match(/^([0-9]{1,})([hmsd])$/);if(!match){return}switch(match[2]){case"s":return match[1]*1e3;case"m":return match[1]*1e3*60;case"h":return match[1]*1e3*60*60;case"d":return match[1]*1e3*60*60*24}};var RefreshControl=exports.RefreshControl=function RefreshControl(_ref){var inFlight=_ref.inFlight,setRefreshInterval=_ref.setRefreshInterval,refreshInterval=_ref.refreshInterval,doRefresh=_ref.doRefresh;var _setRefresh=function _setRefresh(val){return setRefreshInterval(getRefreshInterval(val))};var popoverButton=function popoverButton(handleClick){return _react2.default.createElement(_eui.EuiButtonEmpty,{size:"s",onClick:handleClick},_react2.default.createElement("div",{style:{display:"flex",alignItems:"center"}},inFlight&&_react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiLoadingSpinner,{size:"m"})," "),"Refresh"))};var autoRefreshControls=_react2.default.createElement(_popover.Popover,{id:"auto-refresh-popover",button:popoverButton,panelClassName:"canvasRefreshControl__popover"},function(_ref2){var closePopover=_ref2.closePopover;return _react2.default.createElement("div",null,_react2.default.createElement(_auto_refresh_controls.AutoRefreshControls,{inFlight:inFlight,refreshInterval:refreshInterval,setRefresh:function setRefresh(val){_setRefresh(val);closePopover()},doRefresh:doRefresh,disableInterval:function disableInterval(){_setRefresh(0);closePopover()}}))});return autoRefreshControls};RefreshControl.propTypes={inFlight:_propTypes2.default.bool.isRequired,doRefresh:_propTypes2.default.func.isRequired,refreshInterval:_propTypes2.default.number,setRefreshInterval:_propTypes2.default.func.isRequired}},3384:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AutoRefreshControls=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _time_duration=__webpack_require__(3385);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var AutoRefreshControls=exports.AutoRefreshControls=function(_Component){_inherits(AutoRefreshControls,_Component);function AutoRefreshControls(){var _ref;var _temp,_this,_ret;_classCallCheck(this,AutoRefreshControls);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=AutoRefreshControls.__proto__||Object.getPrototypeOf(AutoRefreshControls)).call.apply(_ref,[this].concat(args))),_this),_this.refreshInput=null,_temp),_possibleConstructorReturn(_this,_ret)}_createClass(AutoRefreshControls,[{key:"render",value:function render(){var _this2=this;var _props=this.props,inFlight=_props.inFlight,refreshInterval=_props.refreshInterval,setRefresh=_props.setRefresh,doRefresh=_props.doRefresh,disableInterval=_props.disableInterval;return _react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceAround",gutterSize:"xs"},_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiDescriptionList,{textStyle:"reverse"},_react2.default.createElement(_eui.EuiDescriptionListTitle,null,"Refresh this page"),_react2.default.createElement(_eui.EuiDescriptionListDescription,null,refreshInterval>0?_react2.default.createElement(_react.Fragment,null,_react2.default.createElement("span",null,"Every ",(0,_time_duration.timeDurationString)(refreshInterval)),_react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiLink,{size:"s",onClick:disableInterval},"Disable auto-refresh"))):_react2.default.createElement("span",null,"Manually")))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButton,{size:"s",fill:true,iconType:"refresh",onClick:doRefresh,isDisabled:inFlight},"Refresh"))),_react2.default.createElement(_eui.EuiHorizontalRule,{margin:"m"}),_react2.default.createElement(_eui.EuiFormLabel,null,"Change auto-refresh interval"),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,{size:"s"},_react2.default.createElement(_eui.EuiFlexGrid,{gutterSize:"s",columns:2},_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(5e3)}},"5 Seconds")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(15e3)}},"15 Seconds")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(3e4)}},"30 Seconds")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(6e4)}},"1 Minute")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(3e5)}},"5 Minutes")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(9e5)}},"15 Minutes")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(18e5)}},"30 Minutes")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(36e5)}},"1 Hour")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(72e5)}},"2 Hours")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(216e5)}},"6 Hours")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(432e5)}},"12 Hours")),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return setRefresh(864e5)}},"24 Hours")))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement("form",{onSubmit:function onSubmit(ev){ev.preventDefault();setRefresh(_this2.refreshInput.value)}},_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiFormRow,{label:"Set a custom interval",helpText:"Use shorthand notation, like 30s, 10m, or 1h",compressed:true},_react2.default.createElement(_eui.EuiFieldText,{inputRef:function inputRef(i){return _this2.refreshInput=i}}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiFormRow,{label:""},_react2.default.createElement(_eui.EuiButton,{size:"s",type:"submit",style:{minWidth:"auto"}},"Set"))))))}}]);return AutoRefreshControls}(_react.Component);AutoRefreshControls.propTypes={inFlight:_propTypes2.default.bool.isRequired,refreshInterval:_propTypes2.default.number,setRefresh:_propTypes2.default.func.isRequired,disableInterval:_propTypes2.default.func.isRequired,doRefresh:_propTypes2.default.func.isRequired}},3385:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var getLabel=function getLabel(label,val){return val>1||val===0?label+"s":label};var timeDuration=exports.timeDuration=function timeDuration(time,format){var seconds=time/1e3;var minutes=seconds/60;var hours=minutes/60;var days=hours/24;if(format==="days"||days>=1){return{length:days,format:getLabel("day",days)}}if(format==="hours"||hours>=1){return{length:hours,format:getLabel("hour",hours)}}if(format==="minutes"||minutes>=1){return{length:seconds/60,format:getLabel("minute",minutes)}}return{length:seconds,format:getLabel("second",seconds)}};var timeDurationString=exports.timeDurationString=function timeDurationString(time,format){var _timeDuration=timeDuration(time,format),length=_timeDuration.length,fmt=_timeDuration.format;return length+" "+fmt}},3386:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _routes=__webpack_require__(3387);Object.defineProperty(exports,"routes",{enumerable:true,get:function get(){return _routes.routes}});var _export=__webpack_require__(1179);Object.defineProperty(exports,"ExportApp",{enumerable:true,get:function get(){return _export.ExportApp}})},3387:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.routes=undefined;var _workpad_service=__webpack_require__(353);var workpadService=_interopRequireWildcard(_workpad_service);var _workpad=__webpack_require__(180);var _elements=__webpack_require__(61);var _pages=__webpack_require__(305);var _assets=__webpack_require__(306);var _export=__webpack_require__(1179);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}var routes=[{path:"/export/workpad",children:[{name:"exportWorkpad",path:"/pdf/:id/page/:page",action:function action(dispatch){return function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee(_ref){var params=_ref.params,router=_ref.router;var fetchedWorkpad,pageNumber,assets,workpad;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return workpadService.get(params.id);case 2:fetchedWorkpad=_context.sent;pageNumber=parseInt(params.page,10);if(!(fetchedWorkpad==null&&isNaN(pageNumber))){_context.next=6;break}return _context.abrupt("return",router.redirectTo("home"));case 6:assets=fetchedWorkpad.assets,workpad=_objectWithoutProperties(fetchedWorkpad,["assets"]);dispatch((0,_assets.setAssets)(assets));dispatch((0,_workpad.setWorkpad)(workpad,{loadPages:false}));dispatch((0,_pages.setPage)(pageNumber-1));dispatch((0,_elements.fetchAllRenderables)({onlyActivePage:true}));case 11:case"end":return _context.stop()}}},_callee,undefined)}));return function(_x){return _ref2.apply(this,arguments)}}()},meta:{component:_export.ExportApp}}]}];exports.routes=routes},3388:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LoadWorkpad=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var LoadWorkpad=exports.LoadWorkpad=function LoadWorkpad(){return _react2.default.createElement("div",null,"Load a workpad...")}},3389:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExportApp=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _workpad_page=__webpack_require__(1174);var _link=__webpack_require__(703);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ExportApp=exports.ExportApp=function(_React$PureComponent){_inherits(ExportApp,_React$PureComponent);function ExportApp(){_classCallCheck(this,ExportApp);return _possibleConstructorReturn(this,(ExportApp.__proto__||Object.getPrototypeOf(ExportApp)).apply(this,arguments))}_createClass(ExportApp,[{key:"componentDidMount",value:function componentDidMount(){this.props.initializeWorkpad()}},{key:"render",value:function render(){var _props=this.props,workpad=_props.workpad,selectedPageId=_props.selectedPageId;var pages=workpad.pages,height=workpad.height,width=workpad.width;var activePage=pages.find(function(page){return page.id===selectedPageId});return _react2.default.createElement("div",{className:"canvasExport"},_react2.default.createElement("div",{className:"canvasExport__stage"},_react2.default.createElement("div",{className:"canvasLayout__stageHeader"},_react2.default.createElement(_link.Link,{name:"loadWorkpad",params:{id:this.props.workpad.id}},"Edit Workpad")),_react2.default.createElement("div",{className:"canvasExport__stageContent"},_react2.default.createElement(_workpad_page.WorkpadPage,{isSelected:true,page:activePage,height:height,width:width}))))}}]);return ExportApp}(_react2.default.PureComponent);ExportApp.propTypes={workpad:_propTypes2.default.shape({id:_propTypes2.default.string.isRequired,pages:_propTypes2.default.array.isRequired}).isRequired,selectedPageId:_propTypes2.default.string.isRequired,initializeWorkpad:_propTypes2.default.func.isRequired}},3393:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.inFlight=undefined;var _modify_path=__webpack_require__(499);var _resolved_args=__webpack_require__(416);var inFlight=exports.inFlight=function inFlight(_ref){var dispatch=_ref.dispatch;return function(next){var pendingCache=[];return function(action){var isLoading=action.type===_resolved_args.setLoading.toString();var isSetting=action.type===_resolved_args.setValue.toString();if(isLoading||isSetting){var cacheKey=(0,_modify_path.convert)(action.payload.path).join("/");if(isLoading){pendingCache.push(cacheKey);dispatch((0,_resolved_args.inFlightActive)())}else if(isSetting){var idx=pendingCache.indexOf(cacheKey);pendingCache.splice(idx,1);if(pendingCache.length===0){dispatch((0,_resolved_args.inFlightComplete)())}}}next(action)}}}},3394:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.workpadUpdate=undefined;var _pages=__webpack_require__(305);var _elements=__webpack_require__(61);var _workpad=__webpack_require__(180);var _workpad2=__webpack_require__(33);var _get_window=__webpack_require__(245);var workpadUpdate=exports.workpadUpdate=function workpadUpdate(_ref){var dispatch=_ref.dispatch,getState=_ref.getState;return function(next){return function(action){var oldIsWriteable=(0,_workpad2.isWriteable)(getState());next(action);if(action.type===_pages.duplicatePage.toString()){var pages=(0,_workpad2.getPages)(getState());var newPage=pages[pages.length-1];return newPage.elements.forEach(function(element){return dispatch((0,_elements.fetchRenderable)(element))})}if(action.type===_workpad.setWriteable.toString()&&oldIsWriteable!==(0,_workpad2.isWriteable)(getState())){var win=(0,_get_window.getWindow)();if(typeof win.getSelection!=="function"){return}win.getSelection().collapse(document.querySelector("body"),0)}}}}},3395:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.workpadRefresh=undefined;var _elements=__webpack_require__(61);var _workpad=__webpack_require__(180);var _resolved_args=__webpack_require__(416);var _resolved_args2=__webpack_require__(701);var workpadRefresh=exports.workpadRefresh=function workpadRefresh(_ref){var dispatch=_ref.dispatch,getState=_ref.getState;return function(next){var refreshTimeout=void 0;var refreshInterval=0;function updateWorkpad(){if(refreshInterval===0){return}var inFlightActive=(0,_resolved_args2.getInFlight)(getState());if(inFlightActive){startDelayedUpdate()}else{dispatch((0,_elements.fetchAllRenderables)())}}function startDelayedUpdate(){clearTimeout(refreshTimeout);refreshTimeout=setTimeout(function(){updateWorkpad()},refreshInterval)}return function(action){next(action);if(action.type===_resolved_args.inFlightComplete.toString()&&refreshInterval>0){startDelayedUpdate()}if(action.type===_workpad.setRefreshInterval.toString()){refreshInterval=action.payload;clearTimeout(refreshTimeout);if(refreshInterval>0){startDelayedUpdate()}}}}}},3396:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.appReady=undefined;var _app=__webpack_require__(72);var _app2=__webpack_require__(500);var appReady=exports.appReady=function appReady(_ref){var dispatch=_ref.dispatch,getState=_ref.getState;return function(next){return function(action){next(action);var state=getState();if(state.app.ready){return}if((0,_app.isAppReady)(state)){dispatch((0,_app2.appReady)())}}}}},3397:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getRootReducer=getRootReducer;var _redux=__webpack_require__(28);var _reduceReducers=__webpack_require__(819);var _reduceReducers2=_interopRequireDefault(_reduceReducers);var _lodash=__webpack_require__(1);var _app=__webpack_require__(3398);var _transient=__webpack_require__(3399);var _resolved_args=__webpack_require__(3400);var _workpad=__webpack_require__(3401);var _pages=__webpack_require__(3402);var _elements=__webpack_require__(3403);var _assets=__webpack_require__(3404);var _history=__webpack_require__(3405);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getRootReducer(initialState){return(0,_redux.combineReducers)({assets:_assets.assetsReducer,app:_app.appReducer,transient:(0,_reduceReducers2.default)(_transient.transientReducer,_resolved_args.resolvedArgsReducer),persistent:(0,_reduceReducers2.default)(_history.historyReducer,(0,_redux.combineReducers)({workpad:(0,_reduceReducers2.default)(_workpad.workpadReducer,_pages.pagesReducer,_elements.elementsReducer),schemaVersion:function schemaVersion(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:(0,_lodash.get)(initialState,"persistent.schemaVersion");return state}}))})}},3398:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.appReducer=undefined;var _handleActions;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _reduxActions=__webpack_require__(25);var _app=__webpack_require__(500);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var appReducer=exports.appReducer=(0,_reduxActions.handleActions)((_handleActions={},_defineProperty(_handleActions,_app.appReady,function(appState){return _extends({},appState,{ready:true})}),_defineProperty(_handleActions,_app.appError,function(appState,_ref){var payload=_ref.payload;return _extends({},appState,{ready:payload})}),_handleActions),{})},3399:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.transientReducer=undefined;var _handleActions;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _reduxActions=__webpack_require__(25);var _objectPathImmutable=__webpack_require__(265);var _history=__webpack_require__(417);var _transient=__webpack_require__(230);var actions=_interopRequireWildcard(_transient);var _elements=__webpack_require__(61);var _workpad=__webpack_require__(180);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var transientReducer=exports.transientReducer=(0,_reduxActions.handleActions)((_handleActions={},_defineProperty(_handleActions,_history.restoreHistory,function(transientState){return(0,_objectPathImmutable.set)(transientState,"resolvedArgs",{})}),_defineProperty(_handleActions,_elements.removeElements,function(transientState,_ref){var elementIds=_ref.payload.elementIds;var selectedElement=transientState.selectedElement;return(0,_objectPathImmutable.del)(_extends({},transientState,{selectedElement:elementIds.indexOf(selectedElement)===-1?selectedElement:null}),["resolvedArgs",elementIds])}),_defineProperty(_handleActions,actions.setCanUserWrite,function(transientState,_ref2){var payload=_ref2.payload;return(0,_objectPathImmutable.set)(transientState,"canUserWrite",Boolean(payload))}),_defineProperty(_handleActions,actions.setFullscreen,function(transientState,_ref3){var payload=_ref3.payload;return(0,_objectPathImmutable.set)(transientState,"fullscreen",Boolean(payload))}),_defineProperty(_handleActions,actions.selectElement,function(transientState,_ref4){var payload=_ref4.payload;return _extends({},transientState,{selectedElement:payload||null})}),_defineProperty(_handleActions,_workpad.setRefreshInterval,function(transientState,_ref5){var payload=_ref5.payload;return _extends({},transientState,{refresh:{interval:Number(payload)||0}})}),_handleActions),{})},3400:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.resolvedArgsReducer=undefined;var _handleActions;var _reduxActions=__webpack_require__(25);var _objectPathImmutable=__webpack_require__(265);var _lodash=__webpack_require__(1);var _modify_path=__webpack_require__(499);var _resolved_args=__webpack_require__(416);var actions=_interopRequireWildcard(_resolved_args);var _elements=__webpack_require__(61);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _getState(hasError,loading){if(hasError){return"error"}if(Boolean(loading)){return"pending"}return"ready"}function _getValue(hasError,value,oldVal){if(hasError||value==null){return oldVal&&oldVal.value}return value}function getContext(value){var loading=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var oldVal=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var hasError=value instanceof Error;return{state:_getState(hasError,loading),value:_getValue(hasError,value,oldVal),error:hasError?value:null}}function getFullPath(path){var isArray=Array.isArray(path);var isString=typeof path==="string";if(!isArray&&!isString){throw new Error("Resolved argument path is invalid: "+path)}return(0,_modify_path.prepend)(path,"resolvedArgs")}var resolvedArgsReducer=exports.resolvedArgsReducer=(0,_reduxActions.handleActions)((_handleActions={},_defineProperty(_handleActions,actions.setLoading,function(transientState,_ref){var payload=_ref.payload;var path=payload.path,_payload$loading=payload.loading,loading=_payload$loading===undefined?true:_payload$loading;var fullPath=getFullPath(path);var oldVal=(0,_lodash.get)(transientState,fullPath,null);return(0,_objectPathImmutable.set)(transientState,fullPath,getContext((0,_lodash.get)(oldVal,"value",null),loading))}),_defineProperty(_handleActions,actions.setValue,function(transientState,_ref2){var payload=_ref2.payload;var path=payload.path,value=payload.value;var fullPath=getFullPath(path);var oldVal=(0,_lodash.get)(transientState,fullPath,null);return(0,_objectPathImmutable.set)(transientState,fullPath,getContext(value,false,oldVal))}),_defineProperty(_handleActions,actions.setValues,function(transientState,_ref3){var payload=_ref3.payload;return payload.reduce(function(acc,setValueObj){var fullPath=getFullPath(setValueObj.path);var oldVal=(0,_lodash.get)(acc,fullPath,null);return(0,_objectPathImmutable.set)(acc,fullPath,getContext(setValueObj.value,false,oldVal))},transientState)}),_defineProperty(_handleActions,actions.clear,function(transientState,_ref4){var payload=_ref4.payload;var path=payload.path;return(0,_objectPathImmutable.del)(transientState,getFullPath(path))}),_defineProperty(_handleActions,actions.inFlightActive,function(transientState){return(0,_objectPathImmutable.set)(transientState,"inFlight",true)}),_defineProperty(_handleActions,actions.inFlightComplete,function(transientState){return(0,_objectPathImmutable.set)(transientState,"inFlight",false)}),_defineProperty(_handleActions,_elements.flushContext,function(transientState,_ref5){var elementId=_ref5.payload;return(0,_objectPathImmutable.del)(transientState,getFullPath([elementId,"expressionContext"]))}),_defineProperty(_handleActions,_elements.flushContextAfterIndex,function(transientState,_ref6){var payload=_ref6.payload;var elementId=payload.elementId,index=payload.index;var expressionContext=(0,_lodash.get)(transientState,getFullPath([elementId,"expressionContext"]));if(!expressionContext){return transientState}return Object.keys(expressionContext).reduce(function(state,indexKey){var indexAsNum=parseInt(indexKey,10);if(indexAsNum>=index){return(0,_objectPathImmutable.del)(state,getFullPath([elementId,"expressionContext",indexKey]))}return state},transientState)}),_handleActions),{})},3401:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.workpadReducer=undefined;var _handleActions;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _persisted_log=__webpack_require__(193);var _reduxActions=__webpack_require__(25);var _workpad=__webpack_require__(180);var _constants=__webpack_require__(229);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var workpadReducer=exports.workpadReducer=(0,_reduxActions.handleActions)((_handleActions={},_defineProperty(_handleActions,_workpad.setWorkpad,function(workpadState,_ref){var payload=_ref.payload;_persisted_log.recentlyAccessed.add(_constants.APP_ROUTE_WORKPAD+"/"+payload.id,payload.name,payload.id);return payload}),_defineProperty(_handleActions,_workpad.sizeWorkpad,function(workpadState,_ref2){var payload=_ref2.payload;return _extends({},workpadState,payload)}),_defineProperty(_handleActions,_workpad.setColors,function(workpadState,_ref3){var payload=_ref3.payload;return _extends({},workpadState,{colors:payload})}),_defineProperty(_handleActions,_workpad.setName,function(workpadState,_ref4){var payload=_ref4.payload;_persisted_log.recentlyAccessed.add(_constants.APP_ROUTE_WORKPAD+"/"+workpadState.id,payload,workpadState.id);return _extends({},workpadState,{name:payload})}),_defineProperty(_handleActions,_workpad.setWriteable,function(workpadState,_ref5){var payload=_ref5.payload;return _extends({},workpadState,{isWriteable:Boolean(payload)})}),_defineProperty(_handleActions,_workpad.setWorkpadCSS,function(workpadState,_ref6){var payload=_ref6.payload;return _extends({},workpadState,{css:payload})}),_handleActions),{})},3402:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.pagesReducer=undefined;var _handleActions;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _reduxActions=__webpack_require__(25);var _objectPathImmutable=__webpack_require__(265);var _clone_subgraphs=__webpack_require__(706);var _get_id=__webpack_require__(228);var _router_provider=__webpack_require__(714);var _defaults=__webpack_require__(415);var _pages=__webpack_require__(305);var actions=_interopRequireWildcard(_pages);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function setPageIndex(workpadState,index){if(index<0||!workpadState.pages[index]){return workpadState}return(0,_objectPathImmutable.set)(workpadState,"page",index)}function getPageIndexById(workpadState,id){return workpadState.pages.findIndex(function(page){return page.id===id})}function addPage(workpadState,payload){var srcIndex=arguments.length>2&&arguments[2]!==undefined?arguments[2]:workpadState.pages.length-1;return(0,_objectPathImmutable.insert)(workpadState,"pages",payload||(0,_defaults.getDefaultPage)(),srcIndex+1)}function clonePage(page){var elements=page.elements;var groups=page.groups||[];var nodes=elements.concat(groups);var newNodes=(0,_clone_subgraphs.cloneSubgraphs)(nodes);return _extends({},page,{id:(0,_get_id.getId)("page"),groups:newNodes.filter(function(n){return n.position.type==="group"}),elements:newNodes.filter(function(n){return n.position.type!=="group"})})}var pagesReducer=exports.pagesReducer=(0,_reduxActions.handleActions)((_handleActions={},_defineProperty(_handleActions,actions.addPage,function(workpadState,_ref){var payload=_ref.payload;var activePage=workpadState.page;var withNewPage=addPage(workpadState,payload,activePage);var newState=setPageIndex(withNewPage,activePage+1);var router=(0,_router_provider.routerProvider)();router.navigateTo("loadWorkpad",{id:newState.id,page:newState.page+1});return newState}),_defineProperty(_handleActions,actions.duplicatePage,function(workpadState,_ref2){var payload=_ref2.payload;var srcPage=workpadState.pages.find(function(page){return page.id===payload});if(!srcPage){return workpadState}var srcIndex=workpadState.pages.indexOf(srcPage);var newPageIndex=srcIndex+1;var insertedWorkpadState=addPage(workpadState,clonePage(srcPage),srcIndex);var newState=setPageIndex(insertedWorkpadState,newPageIndex);var router=(0,_router_provider.routerProvider)();router.navigateTo("loadWorkpad",{id:newState.id,page:newPageIndex+1});return newState}),_defineProperty(_handleActions,actions.setPage,function(workpadState,_ref3){var payload=_ref3.payload;return setPageIndex(workpadState,payload)}),_defineProperty(_handleActions,actions.gotoPage,function(workpadState,_ref4){var payload=_ref4.payload;var newState=setPageIndex(workpadState,payload);var router=(0,_router_provider.routerProvider)();router.navigateTo("loadWorkpad",{id:newState.id,page:newState.page+1});return newState}),_defineProperty(_handleActions,actions.movePage,function(workpadState,_ref5){var payload=_ref5.payload;var id=payload.id,position=payload.position;var pageIndex=getPageIndexById(workpadState,id);var newIndex=pageIndex+position;if(pageIndex<0){return workpadState}if(newIndex<0||newIndex>=workpadState.pages.length){return workpadState}var page=_extends({},workpadState.pages[pageIndex]);var newState=(0,_objectPathImmutable.insert)((0,_objectPathImmutable.del)(workpadState,"pages."+pageIndex),"pages",page,newIndex);var selectedId=workpadState.pages[workpadState.page].id;var newSelectedIndex=newState.pages.findIndex(function(page){return page.id===selectedId});newState=(0,_objectPathImmutable.set)(newState,"page",newSelectedIndex);var router=(0,_router_provider.routerProvider)();router.navigateTo("loadWorkpad",{id:newState.id,page:newState.page+1});return newState}),_defineProperty(_handleActions,actions.removePage,function(workpadState,_ref6){var payload=_ref6.payload;var curIndex=workpadState.page;var delIndex=getPageIndexById(workpadState,payload);if(delIndex>=0){var newState=(0,_objectPathImmutable.del)(workpadState,"pages."+delIndex);var router=(0,_router_provider.routerProvider)();var wasSelected=curIndex===delIndex;var wasOnlyPage=newState.pages.length===0;var newSelectedPage=curIndex>=delIndex?curIndex-1:curIndex;if(wasOnlyPage){newState=addPage(newState)}if(wasOnlyPage||wasSelected){newState=(0,_objectPathImmutable.set)(newState,"page",0)}else{newState=(0,_objectPathImmutable.set)(newState,"page",newSelectedPage)}router.navigateTo("loadWorkpad",{id:newState.id,page:newState.page+1});return newState}}),_defineProperty(_handleActions,actions.stylePage,function(workpadState,_ref7){var payload=_ref7.payload;var pageIndex=workpadState.pages.findIndex(function(page){return page.id===payload.pageId});return(0,_objectPathImmutable.set)(workpadState,["pages",pageIndex,"style"],payload.style)}),_defineProperty(_handleActions,actions.setPageTransition,function(workpadState,_ref8){var payload=_ref8.payload;var pageIndex=workpadState.pages.findIndex(function(page){return page.id===payload.pageId});return(0,_objectPathImmutable.set)(workpadState,["pages",pageIndex,"transition"],payload.transition)}),_handleActions),{})},3403:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.elementsReducer=undefined;var _handleActions;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _reduxActions=__webpack_require__(25);var _objectPathImmutable=__webpack_require__(265);var _lodash=__webpack_require__(1);var _elements=__webpack_require__(61);var actions=_interopRequireWildcard(_elements);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var getLocation=function getLocation(type){return type==="group"?"groups":"elements"};var firstOccurrence=function firstOccurrence(element,index,array){return array.indexOf(element)===index};var getLocationFromIds=function getLocationFromIds(workpadState,pageId,nodeId){var page=workpadState.pages.find(function(p){return p.id===pageId});var groups=page==null?[]:page.groups||[];return groups.find(function(e){return e.id===nodeId})?"groups":"elements"};function getPageIndexById(workpadState,pageId){return(0,_lodash.get)(workpadState,"pages",[]).findIndex(function(page){return page.id===pageId})}function getNodeIndexById(page,nodeId,location){return page[location].findIndex(function(node){return node.id===nodeId})}function assignNodeProperties(workpadState,pageId,nodeId,props){var pageIndex=getPageIndexById(workpadState,pageId);var location=getLocationFromIds(workpadState,pageId,nodeId);var nodesPath=["pages",pageIndex,location];var nodeIndex=(0,_lodash.get)(workpadState,nodesPath,[]).findIndex(function(node){return node.id===nodeId});if(pageIndex===-1||nodeIndex===-1){return workpadState}var cleanWorkpadState=(0,_objectPathImmutable.del)(workpadState,nodesPath.concat([nodeIndex,"ast"]));return(0,_objectPathImmutable.assign)(cleanWorkpadState,nodesPath.concat(nodeIndex),props)}function moveNodeLayer(workpadState,pageId,nodeId,movement,location){var pageIndex=getPageIndexById(workpadState,pageId);var nodeIndex=getNodeIndexById(workpadState.pages[pageIndex],nodeId,location);var nodes=(0,_lodash.get)(workpadState,["pages",pageIndex,location]);var from=nodeIndex;var to=function(){if(movement<Infinity&&movement>-Infinity){return nodeIndex+movement}if(movement===Infinity){return nodes.length-1}if(movement===-Infinity){return 0}throw new Error("Invalid element layer movement")}();if(to>nodes.length-1||to<0){return workpadState}var newNodes=nodes.slice(0);newNodes.splice(to,0,newNodes.splice(from,1)[0]);return(0,_objectPathImmutable.set)(workpadState,["pages",pageIndex,location],newNodes)}var trimPosition=function trimPosition(_ref){var left=_ref.left,top=_ref.top,width=_ref.width,height=_ref.height,angle=_ref.angle,parent=_ref.parent;return{left:left,top:top,width:width,height:height,angle:angle,parent:parent}};var trimElement=function trimElement(_ref2){var id=_ref2.id,position=_ref2.position,expression=_ref2.expression,filter=_ref2.filter;return _extends({id:id,position:trimPosition(position)},position.type!=="group"&&{expression:expression},filter!==void 0&&{filter:filter})};var elementsReducer=exports.elementsReducer=(0,_reduxActions.handleActions)((_handleActions={},_defineProperty(_handleActions,actions.setExpression,function(workpadState,_ref3){var payload=_ref3.payload;var expression=payload.expression,pageId=payload.pageId,elementId=payload.elementId;return assignNodeProperties(workpadState,pageId,elementId,{expression:expression})}),_defineProperty(_handleActions,actions.setFilter,function(workpadState,_ref4){var payload=_ref4.payload;var filter=payload.filter,pageId=payload.pageId,elementId=payload.elementId;return assignNodeProperties(workpadState,pageId,elementId,{filter:filter})}),_defineProperty(_handleActions,actions.setMultiplePositions,function(workpadState,_ref5){var payload=_ref5.payload;return payload.repositionedElements.reduce(function(previousWorkpadState,_ref6){var position=_ref6.position,pageId=_ref6.pageId,elementId=_ref6.elementId;return assignNodeProperties(previousWorkpadState,pageId,elementId,{position:trimPosition(position)})},workpadState)}),_defineProperty(_handleActions,actions.elementLayer,function(workpadState,_ref7){var _ref7$payload=_ref7.payload,pageId=_ref7$payload.pageId,elementId=_ref7$payload.elementId,movement=_ref7$payload.movement;var location=getLocationFromIds(workpadState,pageId,elementId);return moveNodeLayer(workpadState,pageId,elementId,movement,location)}),_defineProperty(_handleActions,actions.addElement,function(workpadState,_ref8){var _ref8$payload=_ref8.payload,pageId=_ref8$payload.pageId,element=_ref8$payload.element;var pageIndex=getPageIndexById(workpadState,pageId);if(pageIndex<0){return workpadState}return(0,_objectPathImmutable.push)(workpadState,["pages",pageIndex,getLocation(element.position.type)],trimElement(element))}),_defineProperty(_handleActions,actions.insertNodes,function(workpadState,_ref9){var _ref9$payload=_ref9.payload,pageId=_ref9$payload.pageId,elements=_ref9$payload.elements;var pageIndex=getPageIndexById(workpadState,pageId);if(pageIndex<0){return workpadState}return elements.reduce(function(state,element){return(0,_objectPathImmutable.push)(state,["pages",pageIndex,getLocation(element.position.type)],trimElement(element))},workpadState)}),_defineProperty(_handleActions,actions.removeElements,function(workpadState,_ref10){var _ref10$payload=_ref10.payload,pageId=_ref10$payload.pageId,elementIds=_ref10$payload.elementIds;var pageIndex=getPageIndexById(workpadState,pageId);if(pageIndex<0){return workpadState}var nodeIndices=elementIds.filter(firstOccurrence).map(function(nodeId){var location=getLocationFromIds(workpadState,pageId,nodeId);return{location:location,index:getNodeIndexById(workpadState.pages[pageIndex],nodeId,location)}}).sort(function(a,b){return b.index-a.index});return nodeIndices.reduce(function(state,_ref11){var location=_ref11.location,index=_ref11.index;return(0,_objectPathImmutable.del)(state,["pages",pageIndex,location,index])},workpadState)}),_handleActions),{})},3404:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.assetsReducer=undefined;var _handleActions;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _reduxActions=__webpack_require__(25);var _objectPathImmutable=__webpack_require__(265);var _lodash=__webpack_require__(1);var _assets=__webpack_require__(306);var _get_id=__webpack_require__(228);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var assetsReducer=exports.assetsReducer=(0,_reduxActions.handleActions)((_handleActions={},_defineProperty(_handleActions,_assets.createAsset,function(assetState,_ref){var payload=_ref.payload;var asset=_extends({id:(0,_get_id.getId)("asset"),"@created":(new Date).toISOString()},payload);return(0,_objectPathImmutable.set)(assetState,asset.id,asset)}),_defineProperty(_handleActions,_assets.setAssetValue,function(assetState,_ref2){var payload=_ref2.payload;var id=payload.id,value=payload.value;var asset=(0,_lodash.get)(assetState,[id]);if(!asset){throw new Error("Can not set asset data, id not found: "+id)}return(0,_objectPathImmutable.assign)(assetState,id,{value:value})}),_defineProperty(_handleActions,_assets.removeAsset,function(assetState,_ref3){var assetId=_ref3.payload;return(0,_objectPathImmutable.del)(assetState,assetId)}),_defineProperty(_handleActions,(0,_reduxActions.combineActions)(_assets.setAssets,_assets.resetAssets),function(assetState,_ref4){var payload=_ref4.payload;return payload||{}}),_handleActions),{})},3405:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.historyReducer=undefined;var _reduxActions=__webpack_require__(25);var _history=__webpack_require__(417);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var historyReducer=exports.historyReducer=(0,_reduxActions.handleActions)(_defineProperty({},_history.restoreHistory,function(persistedState,_ref){var payload=_ref.payload;return payload}),{})},3406:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getInitialState=undefined;var _lodash=__webpack_require__(1);var _defaults=__webpack_require__(415);var getInitialState=exports.getInitialState=function getInitialState(path){var state={app:{},assets:{},transient:{canUserWrite:true,fullscreen:false,selectedElement:null,resolvedArgs:{},refresh:{interval:0}},persistent:{schemaVersion:2,workpad:(0,_defaults.getDefaultWorkpad)()}};if(!path){return state}return(0,_lodash.get)(state,path)}},3407:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _canvas=__webpack_require__(3408);Object.defineProperty(exports,"CanvasRootController",{enumerable:true,get:function get(){return _canvas.CanvasRootController}})},3408:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CanvasRootController=CanvasRootController;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _reactDom=__webpack_require__(15);var _reactRedux=__webpack_require__(14);var _app=__webpack_require__(3409);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function CanvasRootController(canvasStore,$scope,$element){var domNode=$element[0];(0,_reactDom.render)(_react2.default.createElement(_reactRedux.Provider,{store:canvasStore},_react2.default.createElement(_app.App,null)),domNode);$scope.$on("$destroy",function(){(0,_reactDom.unmountComponentAtNode)(domNode)})}},3409:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.App=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _functions_registry=__webpack_require__(700);var _interpreter=__webpack_require__(352);var _public=__webpack_require__(1151);var _reactRedux=__webpack_require__(14);var _recompose=__webpack_require__(19);var _app=__webpack_require__(72);var _app2=__webpack_require__(500);var _load_private_browser_functions=__webpack_require__(3410);var _elements_registry=__webpack_require__(713);var _templates_registry=__webpack_require__(1158);var _tags_registry=__webpack_require__(705);var _render_functions_registry=__webpack_require__(1175);var _expression_types=__webpack_require__(503);var _app3=__webpack_require__(3420);var _track_route_change=__webpack_require__(3426);function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}var mapStateToProps=function mapStateToProps(state){var appState=(0,_app.getAppReady)(state);return{appState:(typeof appState==="undefined"?"undefined":_typeof(appState))==="object"?appState:{ready:appState},basePath:(0,_app.getBasePath)(state)}};var types={elements:_elements_registry.elementsRegistry,renderers:_render_functions_registry.renderFunctionsRegistry,transformUIs:_expression_types.transformRegistry,datasourceUIs:_expression_types.datasourceRegistry,modelUIs:_expression_types.modelRegistry,viewUIs:_expression_types.viewRegistry,argumentUIs:_expression_types.argTypeRegistry,templates:_templates_registry.templatesRegistry,tagUIs:_tags_registry.tagsRegistry};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setAppReady:function setAppReady(basePath){return _asyncToGenerator(regeneratorRuntime.mark(function _callee(){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return(0,_interpreter.getInterpreter)();case 3:(0,_load_private_browser_functions.loadPrivateBrowserFunctions)(_functions_registry.functionsRegistry);_context.next=6;return(0,_interpreter.updateInterpreterFunctions)();case 6:_context.next=8;return(0,_public.loadBrowserRegistries)(types,basePath);case 8:dispatch((0,_app2.appReady)());_context.next=14;break;case 11:_context.prev=11;_context.t0=_context["catch"](0);dispatch((0,_app2.appError)(_context.t0));case 14:case"end":return _context.stop()}}},_callee,undefined,[[0,11]])}))},setAppError:function setAppError(payload){return dispatch((0,_app2.appError)(payload))}}};var mergeProps=function mergeProps(stateProps,dispatchProps,ownProps){return _extends({},ownProps,stateProps,dispatchProps,{setAppReady:dispatchProps.setAppReady(stateProps.basePath)})};var App=exports.App=(0,_recompose.compose)((0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps,mergeProps),(0,_recompose.withProps)(function(){return{onRouteChange:_track_route_change.trackRouteChange}}))(_app3.App)},3410:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.loadPrivateBrowserFunctions=undefined;var _functions=__webpack_require__(3411);var _functions2=__webpack_require__(3413);var loadPrivateBrowserFunctions=exports.loadPrivateBrowserFunctions=function loadPrivateBrowserFunctions(functionsRegistry){function addFunction(fnDef){functionsRegistry.register(fnDef)}_functions2.clientFunctions.forEach(addFunction);_functions.commonFunctions.forEach(addFunction)}},3411:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.commonFunctions=undefined;var _to=__webpack_require__(3412);var commonFunctions=exports.commonFunctions=[_to.to]},3412:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.to=undefined;var _common=__webpack_require__(41);var to=exports.to=function to(){return{name:"to",aliases:[],help:"Explicitly cast from one type to another",context:{},args:{type:{types:["string"],help:"A known type",aliases:["_"],multi:true}},fn:function fn(context,args,_ref){var types=_ref.types;if(!args.type){throw new Error("Must specify a casting type")}return(0,_common.castProvider)(types)(context,args.type)}}}},3413:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.clientFunctions=undefined;var _asset=__webpack_require__(3414);var _filters=__webpack_require__(3415);var _timelion=__webpack_require__(3416);var clientFunctions=exports.clientFunctions=[_asset.asset,_filters.filters,_timelion.timelion]},3414:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.asset=undefined;var _store=__webpack_require__(698);var _assets=__webpack_require__(304);var asset=exports.asset=function asset(){return{name:"asset",aliases:[],context:{types:["null"]},type:"string",help:"Use Canvas workpad asset objects to provide argument values. Usually images",args:{id:{aliases:["_"],types:["string"],help:"The ID of the asset value to return",multi:false}},fn:function fn(context,args){var assetId=args.id;var asset=(0,_assets.getAssetById)((0,_store.getState)(),assetId);if(asset!==undefined){return asset.value}throw new Error("Could not get the asset by ID: "+assetId)}}}},3415:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.filters=undefined;var _interpreter=__webpack_require__(352);var _types_registry=__webpack_require__(1150);var _common=__webpack_require__(41);var _store=__webpack_require__(698);var _workpad=__webpack_require__(33);var filters=exports.filters=function filters(){return{name:"filters",type:"filter",context:{types:["null"]},help:"Collect element filters on the workpad, usually to provide them to a data source",fn:function fn(){var filterExpression=(0,_workpad.getGlobalFilterExpression)((0,_store.getState)());if(filterExpression&&filterExpression.length){var filterAST=(0,_common.fromExpression)(filterExpression);return(0,_interpreter.interpretAst)(filterAST)}else{var filterType=_types_registry.typesRegistry.get("filter");return filterType.from(null)}}}}},3416:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.timelion=undefined;var _chrome=__webpack_require__(8);var _chrome2=_interopRequireDefault(_chrome);var _lodash=__webpack_require__(1);var _fetch=__webpack_require__(501);var _build_bool_array=__webpack_require__(3417);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var timelion=exports.timelion=function timelion(){return{name:"timelion",context:{types:["filter"]},args:{query:{types:["string"],aliases:["_","q"],help:"A timelion query",default:'".es(*)"'},interval:{types:["string"],help:"Bucket interval for the time series",default:"auto"},from:{type:["string"],help:"Elasticsearch date math string for the start of the time range",default:"now-1y"},to:{type:["string"],help:"Elasticsearch date math string for the end of the time range",default:"now"},timezone:{type:["string"],help:"Timezone for the time range",default:"UTC"}},type:"datatable",help:"Use timelion to extract one or more timeseries from many sources",fn:function fn(context,args){var timeFilter=context.and.find(function(and){return and.type==="time"});var range=timeFilter?{from:timeFilter.from,to:timeFilter.to}:{from:args.from,to:args.to};var body={extended:{es:{filter:{bool:{must:(0,_build_bool_array.buildBoolArray)(context.and)}}}},sheet:[args.query],time:{from:range.from,to:range.to,interval:args.interval,timezone:args.timezone}};return(0,_fetch.fetch)(_chrome2.default.addBasePath("/api/timelion/run"),{method:"POST",responseType:"json",data:body}).then(function(resp){var seriesList=resp.data.sheet[0].list;var rows=(0,_lodash.flatten)(seriesList.map(function(series){return series.data.map(function(row){return{"@timestamp":row[0],value:row[1],label:series.label}})}));return{type:"datatable",columns:[{name:"@timestamp",type:"date"},{name:"value",type:"number"},{name:"label",type:"string"}],rows:rows}})}}}},3417:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.buildBoolArray=buildBoolArray;var _get_es_filter=__webpack_require__(3418);var compact=function compact(arr){return Array.isArray(arr)?arr.filter(function(val){return Boolean(val)}):[]};function buildBoolArray(canvasQueryFilterArray){return compact(canvasQueryFilterArray.map(function(clause){try{return(0,_get_es_filter.getESFilter)(clause)}catch(e){return}}))}},3418:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getESFilter=getESFilter;var _filters=__webpack_require__(3419);var filters=_interopRequireWildcard(_filters);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function getESFilter(filter){if(!filters[filter.type]){throw new Error("Unknown filter type: "+filter.type)}try{return filters[filter.type](filter)}catch(e){throw new Error("Could not create elasticsearch filter from "+filter.type)}}},3419:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.time=time;exports.luceneQueryString=luceneQueryString;exports.exactly=exactly;function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function time(filter){if(!filter.column){throw new Error("column is required for Elasticsearch range filters")}return{range:_defineProperty({},filter.column,{gte:filter.from,lte:filter.to})}}function luceneQueryString(filter){return{query_string:{query:filter.query||"*"}}}function exactly(filter){return{term:_defineProperty({},filter.column,{value:filter.value})}}},3420:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.App=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _apps=__webpack_require__(1153);var _shortcut_manager=__webpack_require__(3421);var _get_window=__webpack_require__(245);var _router=__webpack_require__(3423);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var App=exports.App=function(_React$PureComponent){_inherits(App,_React$PureComponent);function App(){var _ref;var _temp,_this,_ret;_classCallCheck(this,App);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=App.__proto__||Object.getPrototypeOf(App)).call.apply(_ref,[this].concat(args))),_this),_this.renderError=function(){console.error(_this.props.appState);return _react2.default.createElement("div",null,_react2.default.createElement("div",null,"Canvas failed to load :("),_react2.default.createElement("div",null,"Message: ",_this.props.appState.message))},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(App,[{key:"getChildContext",value:function getChildContext(){return{shortcuts:_shortcut_manager.shortcutManager}}},{key:"componentDidMount",value:function componentDidMount(){var win=(0,_get_window.getWindow)();win.canvasInitErrorHandler&&win.canvasInitErrorHandler()}},{key:"componentWillUnmount",value:function componentWillUnmount(){var win=(0,_get_window.getWindow)();win.canvasRestoreErrorHandler&&win.canvasRestoreErrorHandler()}},{key:"render",value:function render(){var _this2=this;if(this.props.appState instanceof Error){return this.renderError()}return _react2.default.createElement("div",{className:"canvas canvasContainer"},_react2.default.createElement(_router.Router,{routes:_apps.routes,showLoading:this.props.appState.ready===false,loadingMessage:"Canvas is loading",onRouteChange:this.props.onRouteChange,onLoad:function onLoad(){return _this2.props.setAppReady(true)},onError:function onError(err){return _this2.props.setAppError(err)}}))}}]);return App}(_react2.default.PureComponent);App.childContextTypes={shortcuts:_propTypes2.default.object.isRequired};App.propTypes={appState:_propTypes2.default.object.isRequired,setAppReady:_propTypes2.default.func.isRequired,setAppError:_propTypes2.default.func.isRequired,onRouteChange:_propTypes2.default.func.isRequired}},3421:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.shortcutManager=undefined;var _reactShortcuts=__webpack_require__(419);var _keymap=__webpack_require__(3422);var shortcutManager=exports.shortcutManager=new _reactShortcuts.ShortcutManager(_keymap.keymap)},3422:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var refresh={osx:"option+r",windows:"alt+r",linux:"alt+r",other:"alt+r"};var keymap=exports.keymap={EDITOR:{UNDO:{osx:"command+z",windows:"ctrl+z",linux:"ctrl+z",other:"ctrl+z"},REDO:{osx:"command+shift+y",windows:"ctrl+shift+y",linux:"ctrl+shift+y",other:"ctrl+shift+y"},NEXT:{osx:"option+]",windows:"alt+]",linux:"alt+]",other:"alt+]"},PREV:{osx:"option+[",windows:"alt+[",linux:"alt+[",other:"alt+["},FULLSCREEN:{osx:["option+p","option+f"],windows:["alt+p","alt+f"],linux:["alt+p","alt+f"],other:["alt+p","alt+f"]},FULLSCREEN_EXIT:["escape"],EDITING:{osx:"option+e",windows:"alt+e",linux:"alt+e",other:"alt+e"},GRID:{osx:"option+g",windows:"alt+g",linux:"alt+g",other:"alt+g"},REFRESH:refresh},ELEMENT:{COPY:{osx:"command+c",windows:"ctrl+c",linux:"ctrl+c",other:"ctrl+c"},CUT:{osx:"command+x",windows:"ctrl+x",linux:"ctrl+x",other:"ctrl+x"},PASTE:{osx:"command+v",windows:"ctrl+v",linux:"ctrl+v",other:"ctrl+v"},DELETE:["del","backspace"]},PRESENTATION:{NEXT:{osx:["space","right","option+]"],windows:["space","right","alt+]"],linux:["space","right","alt+]"],other:["space","right","alt+]"]},PREV:{osx:["left","option+["],windows:["left","alt+["],linux:["left","alt+["],other:["left","alt+["]},REFRESH:refresh}}},3423:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _router=__webpack_require__(3424);Object.defineProperty(exports,"Router",{enumerable:true,get:function get(){return _router.Router}})},3424:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Router=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _recompose=__webpack_require__(19);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _router_provider=__webpack_require__(714);var _canvas_loading=__webpack_require__(3425);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Router=exports.Router=function(_React$PureComponent){_inherits(Router,_React$PureComponent);function Router(){var _ref;var _temp,_this,_ret;_classCallCheck(this,Router);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=Router.__proto__||Object.getPrototypeOf(Router)).call.apply(_ref,[this].concat(args))),_this),_this.state={router:{},activeComponent:_canvas_loading.CanvasLoading},_temp),_possibleConstructorReturn(_this,_ret)}_createClass(Router,[{key:"getChildContext",value:function getChildContext(){var router=this.state.router;return{router:router}}},{key:"componentWillMount",value:function componentWillMount(){var _this2=this;var _props=this.props,routes=_props.routes,onRouteChange=_props.onRouteChange,onLoad=_props.onLoad,onError=_props.onError;var router=(0,_router_provider.routerProvider)(routes);var firstLoad=true;router.onPathChange(function(route){var pathname=route.location.pathname;var component=route.meta.component;if(!component){if(false){}return}if(firstLoad){firstLoad=false;router.execute().then(function(){return onLoad()}).catch(function(err){return onError(err)})}onRouteChange&&onRouteChange(pathname);_this2.setState({activeComponent:component})});this.setState({router:router})}},{key:"render",value:function render(){if(this.props.showLoading){return _react2.default.createElement(_canvas_loading.CanvasLoading,{msg:this.props.loadingMessage})}return(0,_recompose.isClassComponent)(this.state.activeComponent)?_react2.default.createElement(this.state.activeComponent,{}):this.state.activeComponent({})}}]);return Router}(_react2.default.PureComponent);Router.childContextTypes={router:_propTypes2.default.object.isRequired};Router.propTypes={showLoading:_propTypes2.default.bool.isRequired,onLoad:_propTypes2.default.func.isRequired,onError:_propTypes2.default.func.isRequired,routes:_propTypes2.default.array.isRequired,loadingMessage:_propTypes2.default.string,onRouteChange:_propTypes2.default.func}},3425:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CanvasLoading=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var CanvasLoading=exports.CanvasLoading=function CanvasLoading(_ref){var msg=_ref.msg;return _react2.default.createElement("div",{className:"canvasContainer--loading"},_react2.default.createElement(_eui.EuiPanel,null,_react2.default.createElement(_eui.EuiLoadingChart,{size:"m"}),_react2.default.createElement(_eui.EuiSpacer,{size:"s"}),_react2.default.createElement(_eui.EuiText,null,_react2.default.createElement("p",{style:{color:"#000"}},msg))))};CanvasLoading.propTypes={msg:_propTypes2.default.string};CanvasLoading.defaultProps={msg:"Loading..."}},3426:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.trackRouteChange=trackRouteChange;var _chrome=__webpack_require__(8);var _chrome2=_interopRequireDefault(_chrome);var _absolute_to_parsed_url=__webpack_require__(564);var _lodash=__webpack_require__(1);var _get_window=__webpack_require__(245);var _constants=__webpack_require__(229);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function trackRouteChange(){var basePath=_chrome2.default.getBasePath();_chrome2.default.trackSubUrlForApp(_constants.CANVAS_APP,(0,_absolute_to_parsed_url.absoluteToParsedUrl)((0,_lodash.get)((0,_get_window.getWindow)(),"location.href"),basePath))}},3427:function(module,exports){},3428:function(module,exports,__webpack_require__){"use strict";var _arg_types=__webpack_require__(3429);var _datasources=__webpack_require__(3445);var _expression_types=__webpack_require__(503);_arg_types.argTypeSpecs.forEach(function(expFn){return _expression_types.argTypeRegistry.register(expFn)});_datasources.datasourceSpecs.forEach(function(expFn){return _expression_types.datasourceRegistry.register(expFn)})},3429:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.argTypeSpecs=undefined;var _color=__webpack_require__(3430);var _series_style=__webpack_require__(3431);var _container_style=__webpack_require__(3434);var _font=__webpack_require__(3439);var argTypeSpecs=exports.argTypeSpecs=[_color.color,_container_style.containerStyle,_font.font,_series_style.seriesStyle]},3430:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.color=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _template_from_react_component=__webpack_require__(420);var _color_picker_mini=__webpack_require__(354);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ColorArgInput=function ColorArgInput(_ref){var onValueChange=_ref.onValueChange,argValue=_ref.argValue,workpad=_ref.workpad;return _react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_color_picker_mini.ColorPickerMini,{value:argValue,onChange:onValueChange,colors:workpad.colors})))};ColorArgInput.propTypes={argValue:_propTypes2.default.any.isRequired,onValueChange:_propTypes2.default.func.isRequired,workpad:_propTypes2.default.shape({colors:_propTypes2.default.array.isRequired}).isRequired};var color=exports.color=function color(){return{name:"color",displayName:"Color",help:"Color picker",simpleTemplate:(0,_template_from_react_component.templateFromReactComponent)(ColorArgInput),default:"#000000"}}},3431:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.seriesStyle=undefined;var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _lodash=__webpack_require__(1);var _template_from_react_component=__webpack_require__(420);var _simple_template=__webpack_require__(3432);var _extended_template=__webpack_require__(3433);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EnhancedExtendedTemplate=(0,_recompose.lifecycle)({formatLabel:function formatLabel(label){if(typeof label!=="string"){this.props.renderError()}return"Style: "+label},componentWillMount:function componentWillMount(){var label=(0,_lodash.get)(this.props.argValue,"chain.0.arguments.label.0","");if(label){this.props.setLabel(this.formatLabel(label))}},componentWillReceiveProps:function componentWillReceiveProps(newProps){var newLabel=(0,_lodash.get)(newProps.argValue,"chain.0.arguments.label.0","");if(newLabel&&this.props.label!==this.formatLabel(newLabel)){this.props.setLabel(this.formatLabel(newLabel))}}})(_extended_template.ExtendedTemplate);EnhancedExtendedTemplate.propTypes={argValue:_propTypes2.default.any.isRequired,setLabel:_propTypes2.default.func.isRequired,label:_propTypes2.default.string};var seriesStyle=exports.seriesStyle=function seriesStyle(){return{name:"seriesStyle",displayName:"Series style",help:"Set the style for a selected named series",template:(0,_template_from_react_component.templateFromReactComponent)(EnhancedExtendedTemplate),simpleTemplate:(0,_template_from_react_component.templateFromReactComponent)(_simple_template.SimpleTemplate),default:"{seriesStyle}"}}},3432:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SimpleTemplate=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _objectPathImmutable=__webpack_require__(265);var _lodash=__webpack_require__(1);var _color_picker_mini=__webpack_require__(354);var _tooltip_icon=__webpack_require__(710);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SimpleTemplate=exports.SimpleTemplate=function SimpleTemplate(props){var typeInstance=props.typeInstance,argValue=props.argValue,onValueChange=props.onValueChange,labels=props.labels,workpad=props.workpad;var name=typeInstance.name;var chain=(0,_lodash.get)(argValue,"chain.0",{});var chainArgs=(0,_lodash.get)(chain,"arguments",{});var color=(0,_lodash.get)(chainArgs,"color.0","");var handleChange=function handleChange(argName,ev){var fn=ev.target.value===""?_objectPathImmutable.del:_objectPathImmutable.set;var newValue=fn(argValue,["chain",0,"arguments",argName],[ev.target.value]);return onValueChange(newValue)};var handlePlain=function handlePlain(argName,val){return handleChange(argName,{target:{value:val}})};return _react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"none",alignItems:"center",className:"canvasArgSeries__colorPicker"},!color||color.length===0?_react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement("span",null,"Color")),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiLink,{onClick:function onClick(){return handlePlain("color","#000000")}},"Auto ",_react2.default.createElement(_eui.EuiIcon,{type:"bolt"})))):_react2.default.createElement(_react.Fragment,null,_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement("label",{htmlFor:"series-style"},"Color")),_react2.default.createElement(_eui.EuiFlexItem,{style:{fontSize:0}},_react2.default.createElement(_color_picker_mini.ColorPickerMini,{id:"series-style",value:color,onChange:function onChange(val){return handlePlain("color",val)},colors:workpad.colors,placement:"leftCenter"})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiButtonIcon,{iconType:"cross",color:"danger",onClick:function onClick(){return handlePlain("color","")},"aria-label":"Remove Series Color"}))),name!=="defaultStyle"&&(!labels||labels.length===0)&&_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_tooltip_icon.TooltipIcon,{position:"left",icon:"warning",content:"Data has no series to style, add a color dimension"})))};SimpleTemplate.displayName="SeriesStyleArgSimpleInput";SimpleTemplate.propTypes={onValueChange:_propTypes2.default.func.isRequired,argValue:_propTypes2.default.any.isRequired,labels:_propTypes2.default.array,workpad:_propTypes2.default.shape({colors:_propTypes2.default.array.isRequired}).isRequired,typeInstance:_propTypes2.default.shape({name:_propTypes2.default.string.isRequired}).isRequired}},3433:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExtendedTemplate=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _objectPathImmutable=__webpack_require__(265);var _lodash=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExtendedTemplate=exports.ExtendedTemplate=function ExtendedTemplate(props){var typeInstance=props.typeInstance,onValueChange=props.onValueChange,labels=props.labels,argValue=props.argValue;var chain=(0,_lodash.get)(argValue,"chain.0",{});var chainArgs=(0,_lodash.get)(chain,"arguments",{});var selectedSeries=(0,_lodash.get)(chainArgs,"label.0","");var name=typeInstance.name;var fields=(0,_lodash.get)(typeInstance,"options.include",[]);var hasPropFields=fields.some(function(field){return["lines","bars","points"].indexOf(field)!==-1});var handleChange=function handleChange(argName,ev){var fn=ev.target.value===""?_objectPathImmutable.del:_objectPathImmutable.set;var newValue=fn(argValue,["chain",0,"arguments",argName],[ev.target.value]);return onValueChange(newValue)};var values=[{value:0,text:"None"},{value:1,text:"1"},{value:2,text:"2"},{value:3,text:"3"},{value:4,text:"4"},{value:5,text:"5"}];var labelOptions=[{value:"",text:"Select Series"}];labels.sort().forEach(function(val){return labelOptions.push({value:val,text:val})});return _react2.default.createElement("div",null,name!=="defaultStyle"&&_react2.default.createElement(_eui.EuiFormRow,{label:"Series Identifier",compressed:true},_react2.default.createElement(_eui.EuiSelect,{value:selectedSeries,options:labelOptions,onChange:function onChange(ev){return handleChange("label",ev)}})),hasPropFields&&_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},fields.includes("lines")&&_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiFormRow,{label:"Line",compressed:true},_react2.default.createElement(_eui.EuiSelect,{value:(0,_lodash.get)(chainArgs,"lines.0",0),options:values,onChange:function onChange(ev){return handleChange("lines",ev)}}))),fields.includes("bars")&&_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiFormRow,{label:"Bar",compressed:true},_react2.default.createElement(_eui.EuiSelect,{value:(0,_lodash.get)(chainArgs,"bars.0",0),options:values,onChange:function onChange(ev){return handleChange("bars",ev)}}))),fields.includes("points")&&_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_eui.EuiFormRow,{label:"Point",compressed:true},_react2.default.createElement(_eui.EuiSelect,{value:(0,_lodash.get)(chainArgs,"points.0",0),options:values,onChange:function onChange(ev){return handleChange("points",ev)}})))))};ExtendedTemplate.displayName="SeriesStyleArgAdvancedInput";ExtendedTemplate.propTypes={onValueChange:_propTypes2.default.func.isRequired,argValue:_propTypes2.default.any.isRequired,typeInstance:_propTypes2.default.object,labels:_propTypes2.default.array.isRequired,renderError:_propTypes2.default.func}},3434:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.containerStyle=undefined;var _recompose=__webpack_require__(19);var _objectPathImmutable=__webpack_require__(265);var _lodash=__webpack_require__(1);var _template_from_react_component=__webpack_require__(420);var _simple_template=__webpack_require__(3435);var _extended_template=__webpack_require__(3436);var wrap=function wrap(Component){return(0,_recompose.withHandlers)({getArgValue:function getArgValue(_ref){var argValue=_ref.argValue;return function(name,alt){var args=(0,_lodash.get)(argValue,"chain.0.arguments",{});return(0,_lodash.get)(args,[name,0],alt)}},setArgValue:function setArgValue(_ref2){var argValue=_ref2.argValue,onValueChange=_ref2.onValueChange;return function(name,val){var newValue=(0,_objectPathImmutable.set)(argValue,["chain",0,"arguments",name,0],val);onValueChange(newValue)}}})(Component)};var containerStyle=exports.containerStyle=function containerStyle(){return{name:"containerStyle",displayName:"Container style",help:"Tweak the appearance of the element container",default:"{containerStyle}",simpleTemplate:(0,_template_from_react_component.templateFromReactComponent)(wrap(_simple_template.SimpleTemplate)),template:(0,_template_from_react_component.templateFromReactComponent)(wrap(_extended_template.ExtendedTemplate))}}},3435:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SimpleTemplate=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _color_picker_mini=__webpack_require__(354);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var SimpleTemplate=exports.SimpleTemplate=function SimpleTemplate(_ref){var getArgValue=_ref.getArgValue,setArgValue=_ref.setArgValue,workpad=_ref.workpad;return _react2.default.createElement("div",{style:{fontSize:0}},_react2.default.createElement(_color_picker_mini.ColorPickerMini,{value:getArgValue("backgroundColor"),onChange:function onChange(color){return setArgValue("backgroundColor",color)},colors:workpad.colors,anchorPosition:"leftCenter"}))};SimpleTemplate.displayName="ContainerStyleArgSimpleInput";SimpleTemplate.propTypes={onValueChange:_propTypes2.default.func.isRequired,argValue:_propTypes2.default.any.isRequired,getArgValue:_propTypes2.default.func.isRequired,setArgValue:_propTypes2.default.func.isRequired,workpad:_propTypes2.default.shape({colors:_propTypes2.default.array.isRequired})}},3436:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ExtendedTemplate=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _border_form=__webpack_require__(3437);var _appearance_form=__webpack_require__(3438);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ExtendedTemplate=exports.ExtendedTemplate=function ExtendedTemplate(_ref){var getArgValue=_ref.getArgValue,setArgValue=_ref.setArgValue,workpad=_ref.workpad;return _react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiTitle,{size:"xxxs",textTransform:"uppercase"},_react2.default.createElement("h6",null,"Appearance")),_react2.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react2.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react2.default.createElement(_appearance_form.AppearanceForm,{padding:getArgValue("padding"),backgroundColor:getArgValue("backgroundColor"),opacity:getArgValue("opacity"),overflow:getArgValue("overflow"),onChange:setArgValue}),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiTitle,{size:"xxxs",textTransform:"uppercase"},_react2.default.createElement("h6",null,"Border")),_react2.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react2.default.createElement(_eui.EuiSpacer,{size:"xs"}),_react2.default.createElement(_border_form.BorderForm,{value:getArgValue("border",""),radius:getArgValue("borderRadius"),onChange:setArgValue,colors:workpad.colors}))};ExtendedTemplate.displayName="ContainerStyleArgExtendedInput";ExtendedTemplate.propTypes={onValueChange:_propTypes2.default.func.isRequired,argValue:_propTypes2.default.any.isRequired,getArgValue:_propTypes2.default.func.isRequired,setArgValue:_propTypes2.default.func.isRequired,workpad:_propTypes2.default.shape({colors:_propTypes2.default.array.isRequired}).isRequired}},3437:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BorderForm=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _color_picker_mini=__webpack_require__(354);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var styles=["none","solid","dotted","dashed","double","groove","ridge","inset","outset"];var BorderForm=exports.BorderForm=function BorderForm(_ref){var value=_ref.value,radius=_ref.radius,onChange=_ref.onChange,colors=_ref.colors;var border=value||"";var _border$split=border.split(" "),_border$split2=_slicedToArray(_border$split,3),_border$split2$=_border$split2[0],borderWidth=_border$split2$===undefined?"":_border$split2$,_border$split2$2=_border$split2[1],borderStyle=_border$split2$2===undefined?"":_border$split2$2,_border$split2$3=_border$split2[2],borderColor=_border$split2$3===undefined?"":_border$split2$3;var borderWidthVal=borderWidth?borderWidth.replace("px",""):"";var radiusVal=radius?radius.replace("px",""):"";var namedChange=function namedChange(name){return function(val){if(name==="borderWidth"){return onChange("border",val+"px "+borderStyle+" "+borderColor)}if(name==="borderStyle"){if(val===""){return onChange("border","0px")}return onChange("border",borderWidth+" "+val+" "+borderColor)}if(name==="borderRadius"){return onChange("borderRadius",val+"px")}onChange(name,val)}};var borderColorChange=function borderColorChange(color){return onChange("border",borderWidth+" "+borderStyle+" "+color)};return _react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s"},_react2.default.createElement(_eui.EuiFlexItem,{grow:2},_react2.default.createElement(_eui.EuiFormRow,{label:"Thickness",compressed:true},_react2.default.createElement(_eui.EuiFieldNumber,{value:Number(borderWidthVal),onChange:function onChange(e){return namedChange("borderWidth")(e.target.value)}}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:3},_react2.default.createElement(_eui.EuiFormRow,{label:"Style",compressed:true},_react2.default.createElement(_eui.EuiSuperSelect,{valueOfSelected:borderStyle||"none",options:styles.map(function(style){return{value:style,inputDisplay:_react2.default.createElement("div",{style:{height:16,border:"4px "+style}})}}),onChange:namedChange("borderStyle")}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:2},_react2.default.createElement(_eui.EuiFormRow,{label:"Radius",compressed:true},_react2.default.createElement(_eui.EuiFieldNumber,{value:Number(radiusVal),onChange:function onChange(e){return namedChange("borderRadius")(e.target.value)}}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:1},_react2.default.createElement(_eui.EuiFormRow,{label:"Color",style:{fontSize:0}},_react2.default.createElement(_color_picker_mini.ColorPickerMini,{value:borderColor,onChange:borderColorChange,colors:colors,anchorPosition:"upCenter"}))))};BorderForm.propTypes={value:_propTypes2.default.string,radius:_propTypes2.default.string,onChange:_propTypes2.default.func.isRequired,colors:_propTypes2.default.array.isRequired}},3438:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AppearanceForm=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var opacities=[{value:1,text:"100%"},{value:.9,text:"90%"},{value:.7,text:"70%"},{value:.5,text:"50%"},{value:.3,text:"30%"},{value:.1,text:"10%"}];var overflows=[{value:"hidden",text:"Hidden"},{value:"visible",text:"Visible"}];var AppearanceForm=exports.AppearanceForm=function AppearanceForm(_ref){var padding=_ref.padding,opacity=_ref.opacity,overflow=_ref.overflow,onChange=_ref.onChange;var paddingVal=padding?padding.replace("px",""):"";var namedChange=function namedChange(name){return function(ev){if(name==="padding"){return onChange(name,ev.target.value+"px")}onChange(name,ev.target.value)}};return _react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"s","justify-content":"spaceBetween"},_react2.default.createElement(_eui.EuiFlexItem,{grow:2},_react2.default.createElement(_eui.EuiFormRow,{label:"Padding",compressed:true},_react2.default.createElement(_eui.EuiFieldNumber,{value:Number(paddingVal),onChange:namedChange("padding")}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:3},_react2.default.createElement(_eui.EuiFormRow,{label:"Opacity",compressed:true},_react2.default.createElement(_eui.EuiSelect,{value:opacity,options:opacities,onChange:namedChange("opacity")}))),_react2.default.createElement(_eui.EuiFlexItem,{grow:3},_react2.default.createElement(_eui.EuiFormRow,{label:"Overflow",compressed:true},_react2.default.createElement(_eui.EuiSelect,{value:overflow,options:overflows,onChange:namedChange("overflow")}))))};AppearanceForm.propTypes={padding:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.number]),opacity:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.number]),overflow:_propTypes2.default.oneOf(["hidden","visible"]),onChange:_propTypes2.default.func.isRequired};AppearanceForm.defaultProps={opacity:1,overflow:"hidden"}},3439:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.font=exports.FontArgInput=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _lodash=__webpack_require__(1);var _fonts=__webpack_require__(1181);var _template_from_react_component=__webpack_require__(420);var _text_style_picker=__webpack_require__(3440);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FontArgInput=exports.FontArgInput=function FontArgInput(props){var onValueChange=props.onValueChange,argValue=props.argValue,workpad=props.workpad;var chain=(0,_lodash.get)(argValue,"chain.0",{});var chainArgs=(0,_lodash.get)(chain,"arguments",{});var spec=(0,_lodash.mapValues)(chainArgs,"[0]");function handleChange(newSpec){var newValue=(0,_lodash.set)(argValue,["chain",0,"arguments"],(0,_lodash.mapValues)(newSpec,function(v){return[v]}));return onValueChange(newValue)}return _react2.default.createElement(_text_style_picker.TextStylePicker,{family:spec.family,color:spec.color,size:spec.size,align:spec.align,weight:spec.weight,underline:spec.underline||false,italic:spec.italic||false,onChange:handleChange,colors:workpad.colors})};FontArgInput.propTypes={onValueChange:_propTypes2.default.func.isRequired,argValue:_propTypes2.default.any.isRequired,typeInstance:_propTypes2.default.object,workpad:_propTypes2.default.shape({colors:_propTypes2.default.array.isRequired}).isRequired};FontArgInput.displayName="FontArgInput";var font=exports.font=function font(){return{name:"font",displayName:"Text settings",help:"Set the font, size and color",template:(0,_template_from_react_component.templateFromReactComponent)(FontArgInput),default:'{font size=14 family="'+_fonts.openSans.value+'" color="#000000" align=left}'}}},3440:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TextStylePicker=undefined;var _recompose=__webpack_require__(19);var _text_style_picker=__webpack_require__(3441);var TextStylePicker=exports.TextStylePicker=(0,_recompose.pure)(_text_style_picker.TextStylePicker)},3441:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TextStylePicker=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _font_picker=__webpack_require__(3442);var _color_picker_mini=__webpack_require__(354);var _font_sizes=__webpack_require__(3444);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var TextStylePicker=exports.TextStylePicker=function TextStylePicker(_ref){var _stylesSelectedMap;var family=_ref.family,size=_ref.size,align=_ref.align,color=_ref.color,weight=_ref.weight,underline=_ref.underline,italic=_ref.italic,onChange=_ref.onChange,colors=_ref.colors;var alignmentButtons=[{id:"left",label:"Align left",iconType:"editorAlignLeft"},{id:"center",label:"Align center",iconType:"editorAlignCenter"},{id:"right",label:"Align right",iconType:"editorAlignRight"}];var styleButtons=[{id:"bold",label:"Bold",iconType:"editorBold"},{id:"italic",label:"Italic",iconType:"editorItalic"},{id:"underline",label:"Underline",iconType:"editorUnderline"}];var stylesSelectedMap=(_stylesSelectedMap={},_defineProperty(_stylesSelectedMap,"bold",weight==="bold"),_defineProperty(_stylesSelectedMap,"italic",Boolean(italic)),_defineProperty(_stylesSelectedMap,"underline",Boolean(underline)),_stylesSelectedMap);if(!isNaN(size)&&_font_sizes.fontSizes.indexOf(Number(size))===-1){_font_sizes.fontSizes.push(Number(size));_font_sizes.fontSizes.sort(function(a,b){return a-b})}var doChange=function doChange(propName,value){onChange(_defineProperty({family:family,size:size,align:align,color:color,weight:weight||"normal",underline:underline||false,italic:italic||false},propName,value))};var onAlignmentChange=function onAlignmentChange(optionId){return doChange("align",optionId)};var onStyleChange=function onStyleChange(optionId){var prop=void 0;var value=void 0;if(optionId==="bold"){prop="weight";value=!stylesSelectedMap[optionId]?"bold":"normal"}else{prop=optionId;value=!stylesSelectedMap[optionId]}doChange(prop,value)};return _react2.default.createElement("div",{className:"canvasTextStylePicker"},_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiSelect,{compressed:true,value:size,onChange:function onChange(e){return doChange("size",Number(e.target.value))},options:_font_sizes.fontSizes.map(function(size){return{text:String(size),value:size}})})),_react2.default.createElement(_eui.EuiFlexItem,null,_react2.default.createElement(_font_picker.FontPicker,{value:family,onSelect:function onSelect(value){return doChange("family",value)}}))),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonGroup,{options:styleButtons,idToSelectedMap:stylesSelectedMap,onChange:onStyleChange,type:"multi",isIconOnly:true})),_react2.default.createElement(_eui.EuiFlexItem,{grow:false},_react2.default.createElement(_eui.EuiButtonGroup,{options:alignmentButtons,isIconOnly:true,idSelected:align,onChange:onAlignmentChange})),_react2.default.createElement(_eui.EuiFlexItem,{grow:false,style:{fontSize:0}},_react2.default.createElement(_color_picker_mini.ColorPickerMini,{value:color,onChange:function onChange(value){return doChange("color",value)},colors:colors}))))};TextStylePicker.propTypes={family:_propTypes2.default.string,size:_propTypes2.default.number,align:_propTypes2.default.string,color:_propTypes2.default.string,weight:_propTypes2.default.string,underline:_propTypes2.default.bool,italic:_propTypes2.default.bool,onChange:_propTypes2.default.func.isRequired,colors:_propTypes2.default.array};TextStylePicker.defaultProps={align:"left",size:14}},3442:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FontPicker=undefined;var _recompose=__webpack_require__(19);var _font_picker=__webpack_require__(3443);var FontPicker=exports.FontPicker=(0,_recompose.pure)(_font_picker.FontPicker)},3443:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FontPicker=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _fonts=__webpack_require__(1181);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FontPicker=exports.FontPicker=function FontPicker(_ref){var onSelect=_ref.onSelect,value=_ref.value;if(value&&!_fonts.fonts.find(function(font){return font.value===value})){var label=(value.indexOf(",")>=0?value.split(",")[0]:value).replace(/['"]/g,"");_fonts.fonts.push({value:value,label:label});_fonts.fonts.sort(function(a,b){return a.label.localeCompare(b.label)})}return _react2.default.createElement(_eui.EuiSuperSelect,{compressed:true,options:_fonts.fonts.map(function(_ref2){var value=_ref2.value,label=_ref2.label;return{value:value,inputDisplay:_react2.default.createElement("div",{style:{fontFamily:value}},label)}}),valueOfSelected:value,onChange:function onChange(value){return onSelect(value)}})};FontPicker.propTypes={value:_propTypes2.default.string,onSelect:_propTypes2.default.func}},3444:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var fontSizes=exports.fontSizes=[0,6,7,8,9,10,11,12,14,16,18,24,30,36,48,60,72,96]},3445:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.datasourceSpecs=undefined;var _esdocs=__webpack_require__(3446);var datasourceSpecs=exports.datasourceSpecs=[_esdocs.esdocs]},3446:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.esdocs=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _arg_helpers=__webpack_require__(3447);var _es_fields_select=__webpack_require__(3448);var _es_field_select=__webpack_require__(3450);var _es_index_select=__webpack_require__(3452);var _template_from_react_component=__webpack_require__(420);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var EsdocsDatasource=function EsdocsDatasource(_ref){var args=_ref.args,updateArgs=_ref.updateArgs;var setArg=function setArg(name,value){updateArgs&&updateArgs(_extends({},args,(0,_arg_helpers.setSimpleArg)(name,value)))};var getArgName=function getArgName(){if((0,_arg_helpers.getSimpleArg)("_",args)[0]){return"_"}if((0,_arg_helpers.getSimpleArg)("q",args)[0]){return"q"}return"query"};var getIndex=function getIndex(){return(0,_arg_helpers.getSimpleArg)("index",args)[0]||""};var getQuery=function getQuery(){return(0,_arg_helpers.getSimpleArg)(getArgName(),args)[0]||""};var getFields=function getFields(){var commas=(0,_arg_helpers.getSimpleArg)("fields",args)[0]||"";if(commas.length===0){return[]}return commas.split(",").map(function(str){return str.trim()})};var getSortBy=function getSortBy(){var commas=(0,_arg_helpers.getSimpleArg)("sort",args)[0]||", DESC";return commas.split(",").map(function(str){return str.trim()})};var fields=getFields();var _getSortBy=getSortBy(),_getSortBy2=_slicedToArray(_getSortBy,2),sortField=_getSortBy2[0],sortOrder=_getSortBy2[1];var index=getIndex().toLowerCase();var sortOptions=[{value:"asc",text:"Ascending"},{value:"desc",text:"Descending"}];return _react2.default.createElement("div",null,_react2.default.createElement(_eui.EuiCallOut,{size:"s",title:"Be careful",color:"warning"},_react2.default.createElement("p",null,"The Elasticsearch Docs datasource is used to pull documents directly from Elasticsearch without the use of aggregations. It is best used with low volume datasets and in situations where you need to view raw documents or plot exact, non-aggregated values on a chart.")),_react2.default.createElement(_eui.EuiSpacer,{size:"m"}),_react2.default.createElement(_eui.EuiFormRow,{label:"Index",helpText:"Enter an index name or select an index pattern"},_react2.default.createElement(_es_index_select.ESIndexSelect,{value:index,onChange:function onChange(index){return setArg("index",index)}})),_react2.default.createElement(_eui.EuiFormRow,{label:"Query",helpText:"Lucene query string syntax",compressed:true},_react2.default.createElement(_eui.EuiFieldText,{value:getQuery(),onChange:function onChange(e){return setArg(getArgName(),e.target.value)}})),_react2.default.createElement(_eui.EuiFormRow,{label:"Sort Field",helpText:"Document sort field"},_react2.default.createElement(_es_field_select.ESFieldSelect,{index:index,value:sortField,onChange:function onChange(field){return setArg("sort",[field,sortOrder].join(", "))}})),_react2.default.createElement(_eui.EuiFormRow,{label:"Sort Order",helpText:"Document sort order",compressed:true},_react2.default.createElement(_eui.EuiSelect,{value:sortOrder.toLowerCase(),onChange:function onChange(e){return setArg("sort",[sortField,e.target.value].join(", "))},options:sortOptions})),_react2.default.createElement(_eui.EuiFormRow,{label:"Fields",helpText:fields.length<=10?"The fields to extract. Kibana scripted fields are not currently available":"This datasource performs best with 10 or fewer fields"},_react2.default.createElement(_es_fields_select.ESFieldsSelect,{index:index,onChange:function onChange(fields){return setArg("fields",fields.join(", "))},selected:fields})))};EsdocsDatasource.propTypes={args:_propTypes2.default.object.isRequired,updateArgs:_propTypes2.default.func};var esdocs=exports.esdocs=function esdocs(){return{name:"esdocs",displayName:"Elasticsearch raw documents",help:"Pull back raw documents from elasticsearch",image:"logoElasticsearch",template:(0,_template_from_react_component.templateFromReactComponent)(EsdocsDatasource)}}},3447:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateArg=validateArg;exports.getSimpleArg=getSimpleArg;exports.setSimpleArg=setSimpleArg;var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var allowedTypes=["string","number","boolean"];var badType=function badType(){return new Error("Arg setting helpers only support "+allowedTypes.join(","))};var isAllowed=function isAllowed(type){return(0,_lodash.includes)(allowedTypes,type)};function validateArg(value){var type=(0,_common.getType)(value);if(!isAllowed(type)){throw badType()}return value}function getSimpleArg(name,args){if(!args[name]){return[]}return args[name].map(function(astVal){if(!isAllowed((0,_common.getType)(astVal))){throw badType()}return astVal})}function setSimpleArg(name,value){value=Array.isArray(value)?value:[value];return _defineProperty({},name,value.map(validateArg))}},3448:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ESFieldsSelect=undefined;var _recompose=__webpack_require__(19);var _es_service=__webpack_require__(716);var _es_fields_select=__webpack_require__(3449);var ESFieldsSelect=exports.ESFieldsSelect=(0,_recompose.compose)((0,_recompose.withState)("fields","setFields",[]),(0,_recompose.lifecycle)({componentDidMount:function componentDidMount(){var _this=this;if(this.props.index){(0,_es_service.getFields)(this.props.index).then(function(){var fields=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];return _this.props.setFields(fields)})}},componentDidUpdate:function componentDidUpdate(_ref){var index=_ref.index;var _props=this.props,setFields=_props.setFields,onChange=_props.onChange,selected=_props.selected;if(this.props.index!==index){(0,_es_service.getFields)(this.props.index).then(function(){var fields=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];setFields(fields);onChange(selected.filter(function(option){return fields.includes(option)}))})}}}))(_es_fields_select.ESFieldsSelect)},3449:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ESFieldsSelect=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ESFieldsSelect=exports.ESFieldsSelect=function ESFieldsSelect(_ref){var selected=_ref.selected,fields=_ref.fields,_onChange=_ref.onChange,onFocus=_ref.onFocus,onBlur=_ref.onBlur;var options=fields.map(function(value){return{label:value}});var selectedOptions=selected.map(function(value){return{label:value}});return _react2.default.createElement(_eui.EuiComboBox,{selectedOptions:selectedOptions,options:options,onChange:function onChange(values){return _onChange(values.map(function(_ref2){var label=_ref2.label;return label}))},className:"canvasFieldsSelect",onFocus:onFocus,onBlur:onBlur})};ESFieldsSelect.propTypes={onChange:_propTypes2.default.func,selected:_propTypes2.default.array,fields:_propTypes2.default.array,onFocus:_propTypes2.default.func,onBlur:_propTypes2.default.func};ESFieldsSelect.defaultProps={selected:[],fields:[]}},3450:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ESFieldSelect=undefined;var _recompose=__webpack_require__(19);var _es_service=__webpack_require__(716);var _es_field_select=__webpack_require__(3451);var ESFieldSelect=exports.ESFieldSelect=(0,_recompose.compose)((0,_recompose.withState)("fields","setFields",[]),(0,_recompose.lifecycle)({componentDidMount:function componentDidMount(){if(this.props.index){(0,_es_service.getFields)(this.props.index).then(this.props.setFields)}},componentDidUpdate:function componentDidUpdate(_ref){var index=_ref.index;var _props=this.props,value=_props.value,onChange=_props.onChange,setFields=_props.setFields;if(this.props.index!==index){(0,_es_service.getFields)(this.props.index).then(function(fields){setFields(fields)})}if(value&&!this.props.fields.includes(value)){onChange(null)}}}))(_es_field_select.ESFieldSelect)},3451:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ESFieldSelect=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var ESFieldSelect=exports.ESFieldSelect=function ESFieldSelect(_ref){var value=_ref.value,_ref$fields=_ref.fields,fields=_ref$fields===undefined?[]:_ref$fields,_onChange=_ref.onChange,onFocus=_ref.onFocus,onBlur=_ref.onBlur;var selectedOption=value?[{label:value}]:[];var options=fields.map(function(field){return{label:field}});return _react2.default.createElement(_eui.EuiComboBox,{selectedOptions:selectedOption,options:options,onChange:function onChange(_ref2){var _ref3=_slicedToArray(_ref2,1),field=_ref3[0];return _onChange((0,_lodash.get)(field,"label",null))},onSearchChange:function onSearchChange(searchValue){if(searchValue){_onChange(null)}},onFocus:onFocus,onBlur:onBlur,singleSelection:{asPlainText:true},isClearable:false})};ESFieldSelect.propTypes={onChange:_propTypes2.default.func,onFocus:_propTypes2.default.func,onBlur:_propTypes2.default.func,value:_propTypes2.default.string,fields:_propTypes2.default.array};ESFieldSelect.defaultProps={fields:[]}},3452:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ESIndexSelect=undefined;var _recompose=__webpack_require__(19);var _es_service=__webpack_require__(716);var _es_index_select=__webpack_require__(3453);var ESIndexSelect=exports.ESIndexSelect=(0,_recompose.compose)((0,_recompose.withState)("loading","setLoading",true),(0,_recompose.withState)("indices","setIndices",[]),(0,_recompose.lifecycle)({componentDidMount:function componentDidMount(){var _this=this;(0,_es_service.getIndices)().then(function(){var indices=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var _props=_this.props,setLoading=_props.setLoading,setIndices=_props.setIndices,value=_props.value,onChange=_props.onChange;setLoading(false);setIndices(indices.sort());if(!value&&indices.length){onChange(indices[0])}})}}))(_es_index_select.ESIndexSelect)},3453:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ESIndexSelect=undefined;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _eui=__webpack_require__(2);var _lodash=__webpack_require__(1);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var defaultIndex="_all";var ESIndexSelect=exports.ESIndexSelect=function ESIndexSelect(_ref){var value=_ref.value,loading=_ref.loading,indices=_ref.indices,_onChange=_ref.onChange,onFocus=_ref.onFocus,onBlur=_ref.onBlur;var selectedOption=value!==defaultIndex?[{label:value}]:[];var options=indices.map(function(index){return{label:index}});return _react2.default.createElement(_eui.EuiComboBox,{selectedOptions:selectedOption,onChange:function onChange(_ref2){var _ref3=_slicedToArray(_ref2,1),index=_ref3[0];return _onChange((0,_lodash.get)(index,"label",defaultIndex).toLowerCase())},onSearchChange:function onSearchChange(searchValue){if(searchValue){_onChange(defaultIndex)}},onBlur:onBlur,onFocus:onFocus,disabled:loading,options:options,singleSelection:{asPlainText:true},isClearable:false,onCreateOption:function onCreateOption(input){return _onChange(input||defaultIndex)}})};ESIndexSelect.propTypes={value:_propTypes2.default.string,onChange:_propTypes2.default.func.isRequired,onFocus:_propTypes2.default.func,onBlur:_propTypes2.default.func,indices:_propTypes2.default.array.isRequired,loading:_propTypes2.default.bool.isRequired};ESIndexSelect.defaultProps={value:defaultIndex}},3454:function(module,exports,__webpack_require__){"use strict";var _transitions=__webpack_require__(3455);var _transitions_registry=__webpack_require__(711);_transitions.transitions.forEach(function(spec){return _transitions_registry.transitionsRegistry.register(spec)})},3455:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.transitions=undefined;var _fade=__webpack_require__(3456);var _rotate=__webpack_require__(3458);var _slide=__webpack_require__(3460);var _zoom=__webpack_require__(3462);var transitions=exports.transitions=[_fade.fade,_rotate.rotate,_slide.slide,_zoom.zoom]},3456:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fade=undefined;__webpack_require__(3457);var fade=exports.fade=function fade(){return{name:"fade",displayName:"Fade",help:"Fade from one page to the next",enter:"fadeIn",exit:"fadeOut"}}},3457:function(module,exports,__webpack_require__){},3458:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.rotate=undefined;__webpack_require__(3459);var rotate=exports.rotate=function rotate(){return{name:"rotate",displayName:"Rotate",help:"Rotate from one page to the next",enter:"rotateIn",exit:"rotateOut"}}},3459:function(module,exports,__webpack_require__){},3460:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.slide=undefined;__webpack_require__(3461);var slide=exports.slide=function slide(){return{name:"slide",displayName:"Slide",help:"Slide from one page to the next",enter:"slideIn",exit:"slideOut"}}},3461:function(module,exports,__webpack_require__){},3462:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.zoom=undefined;__webpack_require__(3463);var zoom=exports.zoom=function zoom(){return{name:"zoom",displayName:"Zoom",help:"Zoom from one page to the next",enter:"zoomIn",exit:"zoomOut"}}},3463:function(module,exports,__webpack_require__){},351:function(module,exports,__webpack_require__){"use strict";function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var flatten=function flatten(arrays){var _ref;return(_ref=[]).concat.apply(_ref,_toConsumableArray(arrays))};var identity=function identity(d){return d};var map=function map(fun){return function(array){return array.map(function(value){return fun(value)})}};var log=function log(d){var printerFun=arguments.length>1&&arguments[1]!==undefined?arguments[1]:identity;console.log(printerFun(d));return d};var disjunctiveUnion=function disjunctiveUnion(keyFun,set1,set2){return set1.filter(function(s1){return!set2.find(function(s2){return keyFun(s2)===keyFun(s1)})}).concat(set2.filter(function(s2){return!set1.find(function(s1){return keyFun(s1)===keyFun(s2)})}))};var mean=function mean(a,b){return(a+b)/2};var shallowEqual=function shallowEqual(a,b){if(a===b){return true}if(a.length!==b.length){return false}for(var i=0;i<a.length;i++){if(a[i]!==b[i]){return false}}return true};var not=function not(fun){return function(){return!fun.apply(undefined,arguments)}};var removeDuplicates=function removeDuplicates(idFun,a){return a.filter(function(d,i){return a.findIndex(function(s){return idFun(s)===idFun(d)})===i})};var arrayToMap=function arrayToMap(a){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(a.map(function(d){return _defineProperty({},d,true)}))))};var subMultitree=function subMultitree(pk,fk,elements,roots){var getSubgraphs=function getSubgraphs(roots){var children=flatten(roots.map(function(r){return elements.filter(function(e){return fk(e)===pk(r)})}));return[].concat(_toConsumableArray(roots),_toConsumableArray(children.length&&getSubgraphs(children,elements)))};return getSubgraphs(roots)};module.exports={arrayToMap:arrayToMap,disjunctiveUnion:disjunctiveUnion,flatten:flatten,subMultitree:subMultitree,identity:identity,log:log,map:map,mean:mean,not:not,removeDuplicates:removeDuplicates,shallowEqual:shallowEqual}},352:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.updateInterpreterFunctions=exports.interpretAst=exports.getInterpreter=undefined;var _public=__webpack_require__(1151);var _chrome=__webpack_require__(8);var _chrome2=_interopRequireDefault(_chrome);var _functions_registry=__webpack_require__(700);var _types_registry=__webpack_require__(1150);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)})}}return step("next")})}}var basePath=_chrome2.default.getInjected("serverBasePath");var types={browserFunctions:_functions_registry.functionsRegistry,types:_types_registry.typesRegistry};var _resolve=void 0;var _interpreterPromise=void 0;var initialize=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(){var socket;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return(0,_public.loadBrowserRegistries)(types,basePath);case 2:_context.next=4;return(0,_public.createSocket)(basePath,_functions_registry.functionsRegistry);case 4:socket=_context.sent;(0,_public.initializeInterpreter)(socket,_types_registry.typesRegistry,_functions_registry.functionsRegistry).then(function(interpreter){_resolve({interpreter:interpreter,socket:socket})});case 6:case"end":return _context.stop()}}},_callee,undefined)}));return function initialize(){return _ref.apply(this,arguments)}}();var getInterpreter=exports.getInterpreter=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!_interpreterPromise){_interpreterPromise=new Promise(function(resolve){return _resolve=resolve});initialize()}_context2.next=3;return _interpreterPromise;case 3:return _context2.abrupt("return",_context2.sent);case 4:case"end":return _context2.stop()}}},_callee2,undefined)}));return function getInterpreter(){return _ref2.apply(this,arguments)}}();var interpretAst=exports.interpretAst=function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(){var _ref4,interpreter,_args3=arguments;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return getInterpreter();case 2:_ref4=_context3.sent;interpreter=_ref4.interpreter;_context3.next=6;return interpreter.interpretAst.apply(interpreter,_args3);case 6:return _context3.abrupt("return",_context3.sent);case 7:case"end":return _context3.stop()}}},_callee3,undefined)}));return function interpretAst(){return _ref3.apply(this,arguments)}}();var updateInterpreterFunctions=exports.updateInterpreterFunctions=function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(){var _ref6,socket;return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return getInterpreter();case 2:_ref6=_context4.sent;socket=_ref6.socket;socket.emit("updateFunctionList");case 5:case"end":return _context4.stop()}}},_callee4,undefined)}));return function updateInterpreterFunctions(){return _ref5.apply(this,arguments)}}()},353:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};exports.create=create;exports.get=get;exports.update=update;exports.remove=remove;exports.find=find;var _chrome=__webpack_require__(8);var _chrome2=_interopRequireDefault(_chrome);var _constants=__webpack_require__(229);var _fetch=__webpack_require__(501);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var basePath=_chrome2.default.getBasePath();var apiPath=""+basePath+_constants.API_ROUTE_WORKPAD;function create(workpad){return _fetch.fetch.post(apiPath,_extends({},workpad,{assets:workpad.assets||{}}))}function get(workpadId){return _fetch.fetch.get(apiPath+"/"+workpadId).then(function(_ref){var workpad=_ref.data;return workpad})}function update(id,workpad){return _fetch.fetch.put(apiPath+"/"+id,workpad)}function remove(id){return _fetch.fetch.delete(apiPath+"/"+id)}function find(searchTerm){var validSearchTerm=typeof searchTerm==="string"&&searchTerm.length>0;return _fetch.fetch.get(apiPath+"/find?name="+(validSearchTerm?searchTerm:"")+"&perPage=10000").then(function(_ref2){var workpads=_ref2.data;return workpads})}},354:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ColorPickerMini=undefined;var _recompose=__webpack_require__(19);var _color_picker_mini=__webpack_require__(3291);var ColorPickerMini=exports.ColorPickerMini=(0,_recompose.pure)(_color_picker_mini.ColorPickerMini)},41:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2106)},415:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getDefaultWorkpad=exports.getDefaultPage=exports.getDefaultElement=undefined;var _get_id=__webpack_require__(228);var _constants=__webpack_require__(229);var getDefaultElement=exports.getDefaultElement=function getDefaultElement(){return{id:(0,_get_id.getId)("element"),position:{top:20,left:20,height:300,width:500,angle:0,type:"element"},expression:'\n      demodata\n      | pointseries y="median(cost)" x=time color="project"\n      | plot defaultStyle={seriesStyle points=5}\n    ',filter:null}};var getDefaultPage=exports.getDefaultPage=function getDefaultPage(){return{id:(0,_get_id.getId)("page"),style:{background:"#FFF"},transition:{},elements:[],groups:[]}};var getDefaultWorkpad=exports.getDefaultWorkpad=function getDefaultWorkpad(){var page=getDefaultPage();return{name:"Untitled Workpad",id:(0,_get_id.getId)("workpad"),width:1080,height:720,css:_constants.DEFAULT_WORKPAD_CSS,page:0,pages:[page],colors:["#37988d","#c19628","#b83c6f","#3f9939","#1785b0","#ca5f35","#45bdb0","#f2bc33","#e74b8b","#4fbf48","#1ea6dc","#fd7643","#72cec3","#f5cc5d","#ec77a8","#7acf74","#4cbce4","#fd986f","#a1ded7","#f8dd91","#f2a4c5","#a6dfa2","#86d2ed","#fdba9f","#000000","#444444","#777777","#BBBBBB","#FFFFFF","rgba(255,255,255,0)"],isWriteable:true}}},416:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.inFlightComplete=exports.inFlightActive=exports.clear=exports.setValues=exports.setValue=exports.setLoading=undefined;var _reduxActions=__webpack_require__(25);var setLoading=exports.setLoading=(0,_reduxActions.createAction)("setResolvedLoading");var setValue=exports.setValue=(0,_reduxActions.createAction)("setResolvedValue");var setValues=exports.setValues=(0,_reduxActions.createAction)("setResolvedValues");var clear=exports.clear=(0,_reduxActions.createAction)("clearResolvedValue");var inFlightActive=exports.inFlightActive=(0,_reduxActions.createAction)("inFlightActive");var inFlightComplete=exports.inFlightComplete=(0,_reduxActions.createAction)("inFlightComplete")},417:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.restoreHistory=exports.redoHistory=exports.undoHistory=undefined;var _reduxActions=__webpack_require__(25);var undoHistory=exports.undoHistory=(0,_reduxActions.createAction)("undoHistory");var redoHistory=exports.redoHistory=(0,_reduxActions.createAction)("redoHistory");var restoreHistory=exports.restoreHistory=(0,_reduxActions.createAction)("restoreHistory")},419:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2999)},420:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.templateFromReactComponent=undefined;var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _reactDom=__webpack_require__(15);var _reactDom2=_interopRequireDefault(_reactDom);var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _error_boundary=__webpack_require__(1166);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var templateFromReactComponent=exports.templateFromReactComponent=function templateFromReactComponent(Component){var WrappedComponent=function WrappedComponent(props){return _react2.default.createElement(_error_boundary.ErrorBoundary,null,function(_ref){var error=_ref.error;if(error){props.renderError();return null}return _react2.default.createElement(Component,props)})};WrappedComponent.propTypes={renderError:_propTypes2.default.func};return function(domNode,config,handlers){try{var el=_react2.default.createElement(WrappedComponent,config);_reactDom2.default.render(el,domNode,function(){handlers.done()});handlers.onDestroy(function(){_reactDom2.default.unmountComponentAtNode(domNode)})}catch(err){handlers.done();config.renderError()}}}},498:function(module,exports,__webpack_require__){"use strict";var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=true;_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr)){return arr}else if(Symbol.iterator in Object(arr)){return sliceIterator(arr,i)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var transpose=function transpose(_ref){var _ref2=_slicedToArray(_ref,16),a=_ref2[0],e=_ref2[1],i=_ref2[2],m=_ref2[3],b=_ref2[4],f=_ref2[5],j=_ref2[6],n=_ref2[7],c=_ref2[8],g=_ref2[9],k=_ref2[10],o=_ref2[11],d=_ref2[12],h=_ref2[13],l=_ref2[14],p=_ref2[15];return[a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]};var ORIGIN=[0,0,0,1];var NULLVECTOR=[0,0,0,0];var NULLMATRIX=transpose([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var UNITMATRIX=transpose([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);var translate=function translate(x,y,z){return transpose([1,0,0,x,0,1,0,y,0,0,1,z,0,0,0,1])};var scale=function scale(x,y,z){return transpose([x,0,0,0,0,y,0,0,0,0,z,0,0,0,0,1])};var shear=function shear(x,y){return transpose([1,x,0,0,y,1,0,0,0,0,1,0,0,0,0,1])};var perspective=function perspective(d){return transpose([1,0,0,0,0,1,0,0,0,0,1,0,0,0,-1/d,1])};var rotate=function rotate(x,y,z,a){var sinA=Math.sin(a);var coshAi=1-Math.cos(a);return transpose([1+coshAi*(x*x-1),z*sinA+x*y*coshAi,-y*sinA+x*y*coshAi,0,-z*sinA+x*y*coshAi,1+coshAi*(y*y-1),x*sinA+y*x*coshAi,0,y*sinA+x*z*coshAi,-x*sinA+y*z*coshAi,1+coshAi*(z*z-1),0,0,0,0,1])};var rotateX=function rotateX(a){return rotate(1,0,0,a)};var rotateY=function rotateY(a){return rotate(0,1,0,a)};var rotateZ=function rotateZ(a){return rotate(0,0,1,a)};var mult=function mult(_ref3,_ref4){var _ref6=_slicedToArray(_ref3,16),a=_ref6[0],b=_ref6[1],c=_ref6[2],d=_ref6[3],e=_ref6[4],f=_ref6[5],g=_ref6[6],h=_ref6[7],i=_ref6[8],j=_ref6[9],k=_ref6[10],l=_ref6[11],m=_ref6[12],n=_ref6[13],o=_ref6[14],p=_ref6[15];var _ref5=_slicedToArray(_ref4,16),A=_ref5[0],B=_ref5[1],C=_ref5[2],D=_ref5[3],E=_ref5[4],F=_ref5[5],G=_ref5[6],H=_ref5[7],I=_ref5[8],J=_ref5[9],K=_ref5[10],L=_ref5[11],M=_ref5[12],N=_ref5[13],O=_ref5[14],P=_ref5[15];return[a*A+e*B+i*C+m*D,b*A+f*B+j*C+n*D,c*A+g*B+k*C+o*D,d*A+h*B+l*C+p*D,a*E+e*F+i*G+m*H,b*E+f*F+j*G+n*H,c*E+g*F+k*G+o*H,d*E+h*F+l*G+p*H,a*I+e*J+i*K+m*L,b*I+f*J+j*K+n*L,c*I+g*J+k*K+o*L,d*I+h*J+l*K+p*L,a*M+e*N+i*O+m*P,b*M+f*N+j*O+n*P,c*M+g*N+k*O+o*P,d*M+h*N+l*O+p*P]};var multiply=function multiply(){for(var _len=arguments.length,elements=Array(_len),_key=0;_key<_len;_key++){elements[_key]=arguments[_key]}return elements.slice(1).reduce(function(prev,next){return mult(prev,next)},elements[0])};var mvMultiply=function mvMultiply(_ref7,_ref8){var _ref10=_slicedToArray(_ref7,16),a=_ref10[0],b=_ref10[1],c=_ref10[2],d=_ref10[3],e=_ref10[4],f=_ref10[5],g=_ref10[6],h=_ref10[7],i=_ref10[8],j=_ref10[9],k=_ref10[10],l=_ref10[11],m=_ref10[12],n=_ref10[13],o=_ref10[14],p=_ref10[15];var _ref9=_slicedToArray(_ref8,4),A=_ref9[0],B=_ref9[1],C=_ref9[2],D=_ref9[3];return[a*A+e*B+i*C+m*D,b*A+f*B+j*C+n*D,c*A+g*B+k*C+o*D,d*A+h*B+l*C+p*D]};var normalize=function normalize(_ref11){var _ref12=_slicedToArray(_ref11,4),A=_ref12[0],B=_ref12[1],C=_ref12[2],D=_ref12[3];return D===1?[A,B,C,D]:[A/D,B/D,C/D,1]};var invert=function invert(_ref13){var _ref14=_slicedToArray(_ref13,16),a=_ref14[0],b=_ref14[1],c=_ref14[2],d=_ref14[3],e=_ref14[4],f=_ref14[5],g=_ref14[6],h=_ref14[7],i=_ref14[8],j=_ref14[9],k=_ref14[10],l=_ref14[11],m=_ref14[12],n=_ref14[13],o=_ref14[14],p=_ref14[15];var inv=[f*k*p-f*l*o-j*g*p+j*h*o+n*g*l-n*h*k,-b*k*p+b*l*o+j*c*p-j*d*o-n*c*l+n*d*k,b*g*p-b*h*o-f*c*p+f*d*o+n*c*h-n*d*g,-b*g*l+b*h*k+f*c*l-f*d*k-j*c*h+j*d*g,-e*k*p+e*l*o+i*g*p-i*h*o-m*g*l+m*h*k,a*k*p-a*l*o-i*c*p+i*d*o+m*c*l-m*d*k,-a*g*p+a*h*o+e*c*p-e*d*o-m*c*h+m*d*g,a*g*l-a*h*k-e*c*l+e*d*k+i*c*h-i*d*g,e*j*p-e*l*n-i*f*p+i*h*n+m*f*l-m*h*j,-a*j*p+a*l*n+i*b*p-i*d*n-m*b*l+m*d*j,a*f*p-a*h*n-e*b*p+e*d*n+m*b*h-m*d*f,-a*f*l+a*h*j+e*b*l-e*d*j-i*b*h+i*d*f,-e*j*o+e*k*n+i*f*o-i*g*n-m*f*k+m*g*j,a*j*o-a*k*n-i*b*o+i*c*n+m*b*k-m*c*j,-a*f*o+a*g*n+e*b*o-e*c*n-m*b*g+m*c*f,a*f*k-a*g*j-e*b*k+e*c*j+i*b*g-i*c*f];var det=a*inv[0]+b*inv[4]+c*inv[8]+d*inv[12];if(det===0){return false}else{var recDet=1/det;for(var index=0;index<16;index++){inv[index]*=recDet}return inv}};var translateComponent=function translateComponent(a){return[1,0,0,0,0,1,0,0,0,0,1,0,a[12],a[13],a[14],1]};var compositeComponent=function compositeComponent(_ref15){var _ref16=_slicedToArray(_ref15,16),a=_ref16[0],b=_ref16[1],c=_ref16[2],d=_ref16[3],e=_ref16[4],f=_ref16[5],g=_ref16[6],h=_ref16[7],i=_ref16[8],j=_ref16[9],k=_ref16[10],l=_ref16[11],_m=_ref16[12],_n=_ref16[13],_o=_ref16[14],p=_ref16[15];return[a,b,c,d,e,f,g,h,i,j,k,l,0,0,0,p]};var add=function add(_ref17,_ref18){var _ref20=_slicedToArray(_ref17,16),a=_ref20[0],b=_ref20[1],c=_ref20[2],d=_ref20[3],e=_ref20[4],f=_ref20[5],g=_ref20[6],h=_ref20[7],i=_ref20[8],j=_ref20[9],k=_ref20[10],l=_ref20[11],m=_ref20[12],n=_ref20[13],o=_ref20[14],p=_ref20[15];var _ref19=_slicedToArray(_ref18,16),A=_ref19[0],B=_ref19[1],C=_ref19[2],D=_ref19[3],E=_ref19[4],F=_ref19[5],G=_ref19[6],H=_ref19[7],I=_ref19[8],J=_ref19[9],K=_ref19[10],L=_ref19[11],M=_ref19[12],N=_ref19[13],O=_ref19[14],P=_ref19[15];return[a+A,b+B,c+C,d+D,e+E,f+F,g+G,h+H,i+I,j+J,k+K,l+L,m+M,n+N,o+O,p+P]};var subtract=function subtract(_ref21,_ref22){var _ref24=_slicedToArray(_ref21,16),a=_ref24[0],b=_ref24[1],c=_ref24[2],d=_ref24[3],e=_ref24[4],f=_ref24[5],g=_ref24[6],h=_ref24[7],i=_ref24[8],j=_ref24[9],k=_ref24[10],l=_ref24[11],m=_ref24[12],n=_ref24[13],o=_ref24[14],p=_ref24[15];var _ref23=_slicedToArray(_ref22,16),A=_ref23[0],B=_ref23[1],C=_ref23[2],D=_ref23[3],E=_ref23[4],F=_ref23[5],G=_ref23[6],H=_ref23[7],I=_ref23[8],J=_ref23[9],K=_ref23[10],L=_ref23[11],M=_ref23[12],N=_ref23[13],O=_ref23[14],P=_ref23[15];return[a-A,b-B,c-C,d-D,e-E,f-F,g-G,h-H,i-I,j-J,k-K,l-L,m-M,n-N,o-O,p-P]};var reduceTransforms=function reduceTransforms(transforms){return transforms.length===1?transforms[0]:transforms.slice(1).reduce(function(prev,next){return multiply(prev,next)},transforms[0])};var applyTransforms=function applyTransforms(transforms,previousTransformMatrix){return transforms.reduce(function(prev,next){return multiply(prev,next)},previousTransformMatrix)};var clamp=function clamp(low,high,value){return Math.min(high,Math.max(low,value))};var matrixToAngle=function matrixToAngle(transformMatrix){var z0=Math.acos(clamp(-1,1,transformMatrix[0]));var z1=Math.asin(clamp(-1,1,transformMatrix[1]));return z1>0?z0:-z0};module.exports={ORIGIN:ORIGIN,NULLVECTOR:NULLVECTOR,NULLMATRIX:NULLMATRIX,UNITMATRIX:UNITMATRIX,transpose:transpose,translate:translate,shear:shear,rotateX:rotateX,rotateY:rotateY,rotateZ:rotateZ,scale:scale,perspective:perspective,matrixToAngle:matrixToAngle,multiply:multiply,mvMultiply:mvMultiply,invert:invert,normalize:normalize,applyTransforms:applyTransforms,reduceTransforms:reduceTransforms,translateComponent:translateComponent,compositeComponent:compositeComponent,add:add,subtract:subtract}},499:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.prepend=prepend;exports.append=append;exports.convert=convert;var _lodash=__webpack_require__(5012);var _lodash2=_interopRequireDefault(_lodash);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function prepend(path,value){return(0,_lodash2.default)(value).concat((0,_lodash2.default)(path))}function append(path,value){return(0,_lodash2.default)(path).concat((0,_lodash2.default)(value))}function convert(path){return(0,_lodash2.default)(path)}},500:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.appError=exports.appReady=undefined;var _reduxActions=__webpack_require__(25);var appReady=exports.appReady=(0,_reduxActions.createAction)("appReady");var appError=exports.appError=(0,_reduxActions.createAction)("appError")},501:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fetch=undefined;var _axios=__webpack_require__(506);var _axios2=_interopRequireDefault(_axios);var _constants=__webpack_require__(229);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var fetch=exports.fetch=_axios2.default.create({headers:{Accept:"application/json","Content-Type":"application/json","kbn-xsrf":"professionally-crafted-string-of-text"},timeout:_constants.FETCH_TIMEOUT})},5012:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2556)},5013:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2863)},5014:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2295)},5015:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2804)},5016:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2557)},5017:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2655)},5018:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2554)},5019:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2600)},5020:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2450)},5021:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(2236)},503:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _datasource=__webpack_require__(1161);Object.defineProperty(exports,"Datasource",{enumerable:true,get:function get(){return _datasource.Datasource}});Object.defineProperty(exports,"datasourceRegistry",{enumerable:true,get:function get(){return _datasource.datasourceRegistry}});var _transform=__webpack_require__(1163);Object.defineProperty(exports,"Transform",{enumerable:true,get:function get(){return _transform.Transform}});Object.defineProperty(exports,"transformRegistry",{enumerable:true,get:function get(){return _transform.transformRegistry}});var _model=__webpack_require__(1169);Object.defineProperty(exports,"Model",{enumerable:true,get:function get(){return _model.Model}});Object.defineProperty(exports,"modelRegistry",{enumerable:true,get:function get(){return _model.modelRegistry}});var _view=__webpack_require__(1170);Object.defineProperty(exports,"View",{enumerable:true,get:function get(){return _view.View}});Object.defineProperty(exports,"viewRegistry",{enumerable:true,get:function get(){return _view.viewRegistry}});var _arg_type=__webpack_require__(1168);Object.defineProperty(exports,"ArgType",{enumerable:true,get:function get(){return _arg_type.ArgType}});Object.defineProperty(exports,"argTypeRegistry",{enumerable:true,get:function get(){return _arg_type.argTypeRegistry}});var _arg=__webpack_require__(1165);Object.defineProperty(exports,"Arg",{enumerable:true,get:function get(){return _arg.Arg}})},504:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _popover=__webpack_require__(3250);Object.defineProperty(exports,"Popover",{enumerable:true,get:function get(){return _popover.Popover}})},505:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Loading=undefined;var _recompose=__webpack_require__(19);var _loading=__webpack_require__(3263);var Loading=exports.Loading=(0,_recompose.pure)(_loading.Loading)},61:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.addElement=exports.deleteArgumentAtIndex=exports.addArgumentValueAtIndex=exports.setArgumentAtIndex=exports.setAstAtIndex=exports.setExpression=exports.setFilter=exports.removeElements=exports.insertNodes=exports.fetchAllRenderables=exports.fetchRenderable=exports.fetchRenderableWithContext=exports.fetchContext=exports.flushContextAfterIndex=exports.flushContext=exports.setMultiplePositions=exports.elementLayer=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};exports.getSiblingContext=getSiblingContext;var _interpreter=__webpack_require__(352);var _reduxActions=__webpack_require__(25);var _reduxThunks=__webpack_require__(1156);var _objectPathImmutable=__webpack_require__(265);var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);var _workpad=__webpack_require__(33);var _resolved_args=__webpack_require__(701);var _defaults=__webpack_require__(415);var _notify=__webpack_require__(199);var _run_interpreter=__webpack_require__(3215);var _functional=__webpack_require__(351);var _transient=__webpack_require__(230);var _resolved_args2=__webpack_require__(416);var args=_interopRequireWildcard(_resolved_args2);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function getSiblingContext(state,elementId,checkIndex){var prevContextPath=[elementId,"expressionContext",checkIndex];var prevContextValue=(0,_resolved_args.getValue)(state,prevContextPath);if(prevContextValue!=null){return{index:checkIndex,context:prevContextValue}}var prevContextIndex=checkIndex-1;if(prevContextIndex<0){return{}}return getSiblingContext(state,elementId,prevContextIndex)}function getBareElement(el){var includeId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var props=["position","expression","filter"];if(includeId){return(0,_lodash.pick)(el,props.concat("id"))}return(0,_lodash.cloneDeep)((0,_lodash.pick)(el,props))}var elementLayer=exports.elementLayer=(0,_reduxActions.createAction)("elementLayer");var setMultiplePositions=exports.setMultiplePositions=(0,_reduxActions.createAction)("setMultiplePosition",function(repositionedElements){return{repositionedElements:repositionedElements}});var flushContext=exports.flushContext=(0,_reduxActions.createAction)("flushContext");var flushContextAfterIndex=exports.flushContextAfterIndex=(0,_reduxActions.createAction)("flushContextAfterIndex");var fetchContext=exports.fetchContext=(0,_reduxThunks.createThunk)("fetchContext",function(_ref,index,element){var dispatch=_ref.dispatch,getState=_ref.getState;var fullRefresh=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var chain=(0,_lodash.get)(element,["ast","chain"]);var invalidIndex=chain?index>=chain.length:true;if(!element||!chain||invalidIndex){throw new Error("Invalid argument index: "+index)}var contextIndex=index-1;var contextPath=[element.id,"expressionContext",contextIndex];dispatch(args.setLoading({path:contextPath}));var getContext=function getContext(){return getSiblingContext(getState(),element.id,contextIndex-1)};var _ref2=fullRefresh!==true?getContext():{},prevContextIndex=_ref2.index,prevContextValue=_ref2.context;var astChain=element.ast.chain.filter(function(exp,i){if(prevContextValue!=null){return i>prevContextIndex&&i<index}return i<index});return(0,_interpreter.interpretAst)(_extends({},element.ast,{chain:astChain}),prevContextValue).then(function(value){dispatch(args.setValue({path:contextPath,value:value}))})});var fetchRenderableWithContextFn=function fetchRenderableWithContextFn(_ref3,element,ast,context){var dispatch=_ref3.dispatch;var argumentPath=[element.id,"expressionRenderable"];dispatch(args.setLoading({path:argumentPath}));var getAction=function getAction(renderable){return args.setValue({path:argumentPath,value:renderable})};return(0,_run_interpreter.runInterpreter)(ast,context,{castToRender:true}).then(function(renderable){dispatch(getAction(renderable))}).catch(function(err){_notify.notify.error(err);dispatch(getAction(err))})};var fetchRenderableWithContext=exports.fetchRenderableWithContext=(0,_reduxThunks.createThunk)("fetchRenderableWithContext",fetchRenderableWithContextFn);var fetchRenderable=exports.fetchRenderable=(0,_reduxThunks.createThunk)("fetchRenderable",function(_ref4,element){var dispatch=_ref4.dispatch;var ast=element.ast||(0,_common.safeElementFromExpression)(element.expression);dispatch(fetchRenderableWithContext(element,ast,null))});var fetchAllRenderables=exports.fetchAllRenderables=(0,_reduxThunks.createThunk)("fetchAllRenderables",function(_ref5){var dispatch=_ref5.dispatch,getState=_ref5.getState;var _ref6=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref6$onlyActivePage=_ref6.onlyActivePage,onlyActivePage=_ref6$onlyActivePage===undefined?false:_ref6$onlyActivePage;var workpadPages=(0,_workpad.getPages)(getState());var currentPageIndex=(0,_workpad.getSelectedPageIndex)(getState());var currentPage=workpadPages[currentPageIndex];var otherPages=(0,_lodash.without)(workpadPages,currentPage);dispatch(args.inFlightActive());function fetchElementsOnPages(pages){var elements=[];pages.forEach(function(page){page.elements.forEach(function(element){elements.push(element)})});var renderablePromises=elements.map(function(element){var ast=element.ast||(0,_common.safeElementFromExpression)(element.expression);var argumentPath=[element.id,"expressionRenderable"];return(0,_run_interpreter.runInterpreter)(ast,null,{castToRender:true}).then(function(renderable){return{path:argumentPath,value:renderable}}).catch(function(err){_notify.notify.error(err);return{path:argumentPath,value:err}})});return Promise.all(renderablePromises).then(function(renderables){dispatch(args.setValues(renderables))})}if(onlyActivePage){fetchElementsOnPages([currentPage]).then(function(){return dispatch(args.inFlightComplete())})}else{fetchElementsOnPages([currentPage]).then(function(){return fetchElementsOnPages(otherPages)}).then(function(){return dispatch(args.inFlightComplete())})}});var insertNodes=exports.insertNodes=(0,_reduxThunks.createThunk)("insertNodes",function(_ref7,elements,pageId){var dispatch=_ref7.dispatch,type=_ref7.type;var _insertNodes=(0,_reduxActions.createAction)(type);var newElements=elements.map(_lodash.cloneDeep);newElements.forEach(function(newElement){newElement.position.top=newElement.position.top+10;newElement.position.left=newElement.position.left+10});dispatch(_insertNodes({pageId:pageId,elements:newElements}));if(elements.some(function(element){return element.filter})){dispatch(fetchAllRenderables())}else{newElements.forEach(function(newElement){return dispatch(fetchRenderable(newElement))})}});var removeElements=exports.removeElements=(0,_reduxThunks.createThunk)("removeElements",function(_ref8,rootElementIds,pageId){var dispatch=_ref8.dispatch,getState=_ref8.getState;var state=getState();var allElements=(0,_workpad.getNodes)(state,pageId);var allRoots=rootElementIds.map(function(id){return allElements.find(function(e){return id===e.id})});if(allRoots.indexOf(undefined)!==-1){throw new Error("Some of the elements to be deleted do not exist")}var elementIds=(0,_functional.subMultitree)(function(e){return e.id},function(e){return e.position.parent},allElements,allRoots).map(function(e){return e.id});var shouldRefresh=elementIds.some(function(elementId){var element=(0,_workpad.getNodeById)(state,elementId,pageId);var filterIsApplied=element.filter&&element.filter.length>0;return filterIsApplied});var _removeElements=(0,_reduxActions.createAction)("removeElements",function(elementIds,pageId){return{pageId:pageId,elementIds:elementIds}});dispatch(_removeElements(elementIds,pageId));if(shouldRefresh){dispatch(fetchAllRenderables())}});var setFilter=exports.setFilter=(0,_reduxThunks.createThunk)("setFilter",function(_ref9,filter,elementId,pageId){var dispatch=_ref9.dispatch;var doRender=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;var _setFilter=(0,_reduxActions.createAction)("setFilter");dispatch(_setFilter({filter:filter,elementId:elementId,pageId:pageId}));if(doRender===true){dispatch(fetchAllRenderables())}});var setExpression=exports.setExpression=(0,_reduxThunks.createThunk)("setExpression",setExpressionFn);function setExpressionFn(_ref10,expression,elementId,pageId){var dispatch=_ref10.dispatch,getState=_ref10.getState;var doRender=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;var _setExpression=(0,_reduxActions.createAction)("setExpression");dispatch(_setExpression({expression:expression,elementId:elementId,pageId:pageId}));var updatedElement=(0,_workpad.getNodeById)(getState(),elementId,pageId);if(doRender===true){dispatch(fetchRenderable(updatedElement))}}var setAst=(0,_reduxThunks.createThunk)("setAst",function(_ref11,ast,element,pageId){var dispatch=_ref11.dispatch;var doRender=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;try{var expression=(0,_common.toExpression)(ast);dispatch(setExpression(expression,element.id,pageId,doRender))}catch(err){_notify.notify.error(err);dispatch(setExpression(element.expression,element.id,pageId,doRender))}});var setAstAtIndex=exports.setAstAtIndex=(0,_reduxThunks.createThunk)("setAstAtIndex",function(_ref12,index,ast,element,pageId){var dispatch=_ref12.dispatch,getState=_ref12.getState;dispatch(flushContextAfterIndex({elementId:element.id,index:index}));var newElement=(0,_objectPathImmutable.set)(element,["ast","chain",index],ast);var newAst=(0,_lodash.get)(newElement,"ast");var _getSiblingContext=getSiblingContext(getState(),element.id,index-1),contextIndex=_getSiblingContext.index,contextValue=_getSiblingContext.context;if(contextValue){dispatch(setAst(newAst,element,pageId,false));var partialAst=_extends({},newAst,{chain:newAst.chain.filter(function(exp,i){if(contextValue){return i>contextIndex}return i>=index})});return dispatch(fetchRenderableWithContext(newElement,partialAst,contextValue))}dispatch(setAst(newAst,element,pageId))});var setArgumentAtIndex=exports.setArgumentAtIndex=(0,_reduxThunks.createThunk)("setArgumentAtIndex",function(_ref13,args){var dispatch=_ref13.dispatch;var index=args.index,argName=args.argName,value=args.value,valueIndex=args.valueIndex,element=args.element,pageId=args.pageId;var selector=["ast","chain",index,"arguments",argName];if(valueIndex!=null){selector.push(valueIndex)}var newElement=(0,_objectPathImmutable.set)(element,selector,value);var newAst=(0,_lodash.get)(newElement,["ast","chain",index]);dispatch(setAstAtIndex(index,newAst,element,pageId))});var addArgumentValueAtIndex=exports.addArgumentValueAtIndex=(0,_reduxThunks.createThunk)("addArgumentValueAtIndex",function(_ref14,args){var dispatch=_ref14.dispatch;var index=args.index,argName=args.argName,value=args.value,element=args.element;var values=(0,_lodash.get)(element,["ast","chain",index,"arguments",argName],[]);var newValue=values.concat(value);dispatch(setArgumentAtIndex(_extends({},args,{value:newValue})))});var deleteArgumentAtIndex=exports.deleteArgumentAtIndex=(0,_reduxThunks.createThunk)("deleteArgumentAtIndex",function(_ref15,args){var dispatch=_ref15.dispatch;var index=args.index,element=args.element,pageId=args.pageId,argName=args.argName,argIndex=args.argIndex;var curVal=(0,_lodash.get)(element,["ast","chain",index,"arguments",argName]);var newElement=argIndex!=null&&curVal.length>1?(0,_objectPathImmutable.del)(element,["ast","chain",index,"arguments",argName,argIndex]):(0,_objectPathImmutable.del)(element,["ast","chain",index,"arguments",argName]);dispatch(setAstAtIndex(index,(0,_lodash.get)(newElement,["ast","chain",index]),element,pageId))});var addElement=exports.addElement=(0,_reduxThunks.createThunk)("addElement",function(_ref16,pageId,element){var dispatch=_ref16.dispatch;var newElement=_extends({},(0,_defaults.getDefaultElement)(),getBareElement(element,true));if(element.width){newElement.position.width=element.width}if(element.height){newElement.position.height=element.height}var _addElement=(0,_reduxActions.createAction)("addElement");dispatch(_addElement({pageId:pageId,element:newElement}));if(element.filter){dispatch(fetchAllRenderables())}else{dispatch(fetchRenderable(newElement))}dispatch((0,_transient.selectElement)(newElement.id))})},698:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createStore=createStore;exports.getState=getState;var _redux=__webpack_require__(28);var _lodash=__webpack_require__(1);var _middleware=__webpack_require__(3208);var _reducers=__webpack_require__(3397);var store=void 0;function createStore(initialState){if(typeof store!=="undefined"){throw new Error("Redux store can only be initialized once")}if(!(0,_lodash.isPlainObject)(initialState)){throw new Error("Initial state must be a plain object")}var rootReducer=(0,_reducers.getRootReducer)(initialState);store=(0,_redux.createStore)(rootReducer,initialState,_middleware.middleware);return store}function getState(){return store.getState()}},699:function(module,exports,__webpack_require__){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}else{return Array.from(arr)}}var _require=__webpack_require__(351),shallowEqual=_require.shallowEqual;var makeUid=function makeUid(){return 1e11+Math.floor((1e12-1e11)*Math.random())};var selectReduce=function selectReduce(fun,previousValue){var mapFun=arguments.length>2&&arguments[2]!==undefined?arguments[2]:function(d){return d};var logFun=arguments[3];return function(){for(var _len=arguments.length,inputs=Array(_len),_key=0;_key<_len;_key++){inputs[_key]=arguments[_key]}var argumentValues=[];var value=previousValue;var prevValue=previousValue;var mappedValue=void 0;return function(state){if(shallowEqual(argumentValues,argumentValues=inputs.map(function(input){return input(state)}))&&value===prevValue){return mappedValue}prevValue=value;value=fun.apply(undefined,[prevValue].concat(_toConsumableArray(argumentValues)));if(logFun){logFun(value,argumentValues)}mappedValue=mapFun(value);return mappedValue}}};var select=function select(fun,logFun){return function(){for(var _len2=arguments.length,inputs=Array(_len2),_key2=0;_key2<_len2;_key2++){inputs[_key2]=arguments[_key2]}var argumentValues=[];var value=void 0;var actionId=void 0;return function(state){var lastActionId=state.primaryUpdate.payload.uid;if(actionId===lastActionId||shallowEqual(argumentValues,argumentValues=inputs.map(function(input){return input(state)}))){return value}value=fun.apply(undefined,_toConsumableArray(argumentValues));actionId=lastActionId;if(logFun){logFun(value,argumentValues)}return value}}};var createStore=function createStore(initialState){var onChangeCallback=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var currentState=initialState;var updater=function updater(state){return state};var getCurrentState=function getCurrentState(){return currentState};var setUpdater=function setUpdater(updaterFunction){return updater=updaterFunction};var commit=function commit(type,payload){var meta=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};currentState=updater(_extends({},currentState,{primaryUpdate:{type:type,payload:_extends({},payload,{uid:makeUid()})}}));if(!meta.silent){onChangeCallback({type:type,state:currentState},meta)}};var dispatch=function dispatch(type,payload){return setTimeout(function(){return commit(type,payload)})};return{getCurrentState:getCurrentState,setUpdater:setUpdater,commit:commit,dispatch:dispatch}};module.exports={createStore:createStore,select:select,selectReduce:selectReduce,makeUid:makeUid}},7:function(module,exports){module.exports=vendors},700:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.functionsRegistry=undefined;var _common=__webpack_require__(41);var functionsRegistry=exports.functionsRegistry=new _common.FunctionsRegistry},701:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getArg=getArg;exports.getValue=getValue;exports.getState=getState;exports.getError=getError;exports.getInFlight=getInFlight;var _lodash=__webpack_require__(1);var _resolved_arg=__webpack_require__(1152);var argHelper=_interopRequireWildcard(_resolved_arg);var _modify_path=__webpack_require__(499);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key]}}newObj.default=obj;return newObj}}function getArg(state,path){return(0,_lodash.get)(state,(0,_modify_path.prepend)(path,["transient","resolvedArgs"]))}function getValue(state,path){return argHelper.getValue(getArg(state,path))}function getState(state,path){return argHelper.getState(getArg(state,path))}function getError(state,path){return argHelper.getError(getArg(state,path))}function getInFlight(state){return(0,_lodash.get)(state,["transient","inFlight"],false)}},702:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ConfirmModal=undefined;var _confirm_modal=__webpack_require__(3225);var ConfirmModal=exports.ConfirmModal=_confirm_modal.ConfirmModal},703:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _link=__webpack_require__(3226);Object.defineProperty(exports,"Link",{enumerable:true,get:function get(){return _link.Link}})},704:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Paginate=undefined;var _propTypes=__webpack_require__(6);var _propTypes2=_interopRequireDefault(_propTypes);var _recompose=__webpack_require__(19);var _paginate=__webpack_require__(3227);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var Paginate=exports.Paginate=(0,_recompose.compose)((0,_recompose.withProps)(function(_ref){var rows=_ref.rows,perPage=_ref.perPage;return{perPage:Number(perPage),totalPages:Math.ceil(rows.length/(perPage||10))}}),(0,_recompose.withState)("currentPage","setPage",function(_ref2){var startPage=_ref2.startPage,totalPages=_ref2.totalPages;if(totalPages>0){return Math.min(startPage,totalPages-1)}return 0}),(0,_recompose.withProps)(function(_ref3){var rows=_ref3.rows,totalPages=_ref3.totalPages,currentPage=_ref3.currentPage,perPage=_ref3.perPage;var maxPage=totalPages-1;var start=currentPage*perPage;var end=currentPage===0?perPage:perPage*(currentPage+1);return{pageNumber:currentPage,nextPageEnabled:currentPage<maxPage,prevPageEnabled:currentPage>0,partialRows:rows.slice(start,end)}}),(0,_recompose.withHandlers)({nextPage:function nextPage(_ref4){var currentPage=_ref4.currentPage,nextPageEnabled=_ref4.nextPageEnabled,setPage=_ref4.setPage;return function(){return nextPageEnabled&&setPage(currentPage+1)}},prevPage:function prevPage(_ref5){var currentPage=_ref5.currentPage,prevPageEnabled=_ref5.prevPageEnabled,setPage=_ref5.setPage;return function(){return prevPageEnabled&&setPage(currentPage-1)}}}),(0,_recompose.lifecycle)({componentDidUpdate:function componentDidUpdate(prevProps){if(prevProps.perPage!==this.props.perPage){this.props.setPage(0)}}}))(_paginate.Paginate);Paginate.propTypes={rows:_propTypes2.default.array.isRequired,perPage:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.number]),startPage:_propTypes2.default.number};Paginate.defaultProps={perPage:10,startPage:0}},705:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.tagsRegistry=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _common=__webpack_require__(41);var _tag=__webpack_require__(3236);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var TagRegistry=function(_Registry){_inherits(TagRegistry,_Registry);function TagRegistry(){_classCallCheck(this,TagRegistry);return _possibleConstructorReturn(this,(TagRegistry.__proto__||Object.getPrototypeOf(TagRegistry)).apply(this,arguments))}_createClass(TagRegistry,[{key:"wrapper",value:function wrapper(obj){return new _tag.Tag(obj)}}]);return TagRegistry}(_common.Registry);var tagsRegistry=exports.tagsRegistry=new TagRegistry},706:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.cloneSubgraphs=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _functional=__webpack_require__(351);var _get_id=__webpack_require__(228);var cloneSubgraphs=exports.cloneSubgraphs=function cloneSubgraphs(nodes){var idMap=(0,_functional.arrayToMap)(nodes.map(function(n){return n.id}));Object.keys(idMap).forEach(function(key){return idMap[key]=(0,_get_id.getId)(key.split("-")[0])});var newNodes=nodes.map(function(element){return _extends({},element,{id:idMap[element.id],position:_extends({},element.position,{parent:element.position.parent?idMap[element.position.parent]:null})})});return newNodes}},707:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RenderToDom=undefined;var _recompose=__webpack_require__(19);var _render_to_dom=__webpack_require__(3247);var RenderToDom=exports.RenderToDom=(0,_recompose.compose)((0,_recompose.withState)("domNode","setDomNode"))(_render_to_dom.RenderToDom)},708:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var BaseForm=exports.BaseForm=function BaseForm(props){_classCallCheck(this,BaseForm);if(!props.name){throw new Error("Expression specs require a name property")}this.name=props.name;this.displayName=props.displayName||this.name;this.help=props.help||""}},709:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FunctionForm=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _eui=__webpack_require__(2);var _react=__webpack_require__(0);var _react2=_interopRequireDefault(_react);var _lodash=__webpack_require__(1);var _common=__webpack_require__(41);var _arg_add_popover=__webpack_require__(3248);var _sidebar_section=__webpack_require__(1164);var _sidebar_section_title=__webpack_require__(3253);var _base_form=__webpack_require__(708);var _arg=__webpack_require__(1165);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i]}return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var FunctionForm=exports.FunctionForm=function(_BaseForm){_inherits(FunctionForm,_BaseForm);function FunctionForm(props){_classCallCheck(this,FunctionForm);var _this=_possibleConstructorReturn(this,(FunctionForm.__proto__||Object.getPrototypeOf(FunctionForm)).call(this,_extends({},props)));_this.args=props.args||[];_this.resolve=props.resolve||function(){return{}};return _this}_createClass(FunctionForm,[{key:"renderArg",value:function renderArg(props,dataArg){var onValueRemove=props.onValueRemove,onValueChange=props.onValueChange,passedProps=_objectWithoutProperties(props,["onValueRemove","onValueChange"]);var arg=dataArg.arg,argValues=dataArg.argValues,skipRender=dataArg.skipRender,label=dataArg.label;var argType=passedProps.argType,expressionIndex=passedProps.expressionIndex;if(!arg||skipRender){return null}var renderArgWithProps=function renderArgWithProps(argValue,valueIndex){return arg.render(_extends({key:argType+"-"+expressionIndex+"-"+arg.name+"-"+valueIndex},passedProps,{label:label,valueIndex:valueIndex,argValue:argValue,onValueChange:onValueChange(arg.name,valueIndex),onValueRemove:onValueRemove(arg.name,valueIndex)}))};if(!argValues&&arg.required){return renderArgWithProps({type:undefined,value:""},0)}return argValues&&argValues.map(renderArgWithProps)}},{key:"getAddableArg",value:function getAddableArg(props,dataArg){var onValueAdd=props.onValueAdd;var arg=dataArg.arg,argValues=dataArg.argValues,skipRender=dataArg.skipRender;if(!arg||arg.required||skipRender){return null}if(argValues&&!arg.multi){return null}var value=arg.default==null?null:(0,_common.fromExpression)(arg.default,"argument");return{arg:arg,onValueAdd:onValueAdd(arg.name,value)}}},{key:"resolveArg",value:function resolveArg(){return{}}},{key:"render",value:function render(){var _this2=this;var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var args=data.args,argTypeDef=data.argTypeDef;var argInstances=this.args.map(function(argSpec){return new _arg.Arg(argSpec)});if(!(0,_lodash.isPlainObject)(args)){throw new Error('Form "'+this.name+'" expects "args" object')}var argNames=(0,_lodash.uniq)(argInstances.map(function(arg){return arg.name}).concat(Object.keys(args)));var dataArgs=argNames.map(function(argName){var arg=argInstances.find(function(arg){return arg.name===argName});var isMulti=arg&&arg.multi;var argValues=args[argName]&&!isMulti?[(0,_lodash.last)(args[argName])]:args[argName];return{arg:arg,argValues:argValues}});var props=_extends({},data,this.resolve(data),{typeInstance:this});try{var resolvedDataArgs=dataArgs.map(function(d){return _extends({},d,_this2.resolveArg(d,props))});var argumentForms=(0,_lodash.compact)(resolvedDataArgs.map(function(d){return _this2.renderArg(props,d)}));var addableArgs=(0,_lodash.compact)(resolvedDataArgs.map(function(d){return _this2.getAddableArg(props,d)}));if(!addableArgs.length&&!argumentForms.length){return null}return _react2.default.createElement(_sidebar_section.SidebarSection,null,_react2.default.createElement(_sidebar_section_title.SidebarSectionTitle,{title:argTypeDef.displayName,tip:argTypeDef.help},addableArgs.length===0?null:_react2.default.createElement(_arg_add_popover.ArgAddPopover,{options:addableArgs})),argumentForms)}catch(e){return _react2.default.createElement(_eui.EuiCallOut,{color:"danger",iconType:"cross",title:"Expression rendering error"},_react2.default.createElement("p",null,e.message))}}}]);return FunctionForm}(_base_form.BaseForm)},710:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TooltipIcon=undefined;var _recompose=__webpack_require__(19);var _tooltip_icon=__webpack_require__(3257);var TooltipIcon=exports.TooltipIcon=(0,_recompose.pure)(_tooltip_icon.TooltipIcon)},711:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.transitionsRegistry=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _common=__webpack_require__(41);var _transition=__webpack_require__(3289);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var TransitionsRegistry=function(_Registry){_inherits(TransitionsRegistry,_Registry);function TransitionsRegistry(){_classCallCheck(this,TransitionsRegistry);return _possibleConstructorReturn(this,(TransitionsRegistry.__proto__||Object.getPrototypeOf(TransitionsRegistry)).apply(this,arguments))}_createClass(TransitionsRegistry,[{key:"wrapper",value:function wrapper(obj){return new _transition.Transition(obj)}}]);return TransitionsRegistry}(_common.Registry);var transitionsRegistry=exports.transitionsRegistry=new TransitionsRegistry},713:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.elementsRegistry=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _common=__webpack_require__(41);var _element=__webpack_require__(3366);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ElementsRegistry=function(_Registry){_inherits(ElementsRegistry,_Registry);function ElementsRegistry(){_classCallCheck(this,ElementsRegistry);return _possibleConstructorReturn(this,(ElementsRegistry.__proto__||Object.getPrototypeOf(ElementsRegistry)).apply(this,arguments))}_createClass(ElementsRegistry,[{key:"wrapper",value:function wrapper(obj){return new _element.Element(obj)}}]);return ElementsRegistry}(_common.Registry);var elementsRegistry=exports.elementsRegistry=new ElementsRegistry},714:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};exports.routerProvider=routerProvider;var _router=__webpack_require__(5021);var _router2=_interopRequireDefault(_router);var _get_window=__webpack_require__(245);var _history_provider=__webpack_require__(1180);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var router=void 0;function routerProvider(routes){if(router){return router}var baseRouter=(0,_router2.default)(routes);var history=(0,_history_provider.historyProvider)((0,_get_window.getWindow)());var componentListener=null;var isPath=function isPath(str){return typeof str==="string"&&str.substr(0,1)==="/"};var getState=function getState(name,params,state){if(isPath(name)){return params||history.getLocation().state}return state||history.getLocation().state};var updateLocation=function updateLocation(name,params,state){var replace=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var currentState=getState(name,params,state);var method=replace?"replace":"push";if(isPath(name)){return history[method](currentState,name)}history[method](currentState,baseRouter.create(name,params))};router=_extends({},baseRouter,{execute:function execute(){var path=arguments.length>0&&arguments[0]!==undefined?arguments[0]:history.getPath();return this.parse(path)},getPath:history.getPath,getFullPath:history.getFullPath,navigateTo:function navigateTo(name,params,state){updateLocation(name,params,state)},redirectTo:function redirectTo(name,params,state){updateLocation(name,params,state,true)},onPathChange:function onPathChange(fn){var _this=this;if(componentListener!=null){throw new Error("Only one route component listener is allowed")}var execOnMatch=function execOnMatch(location){var pathname=location.pathname;var match=_this.match(pathname);if(!match){console.error("No route found for path: ",pathname);return}fn(_extends({},match,{location:location}))};componentListener=history.onChange(function(locationObj,prevLocationObj){if(locationObj.pathname!==prevLocationObj.pathname){execOnMatch(locationObj)}});execOnMatch(history.getLocation())}});return router}},715:function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)(3326)},716:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getIndices=exports.getFields=undefined;var _chrome=__webpack_require__(8);var _chrome2=_interopRequireDefault(_chrome);var _constants=__webpack_require__(229);var _fetch=__webpack_require__(501);var _notify=__webpack_require__(199);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var basePath=_chrome2.default.getBasePath();var apiPath=basePath+_constants.API_ROUTE;var getFields=exports.getFields=function getFields(){var index=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"_all";return _fetch.fetch.get(apiPath+"/es_fields?index="+index).then(function(_ref){var mapping=_ref.data;return Object.keys(mapping).filter(function(field){return!field.startsWith("_")}).sort()}).catch(function(err){return _notify.notify.error(err,{title:"Couldn't fetch Elasticsearch fields for '"+index+"'"})})};var getIndices=exports.getIndices=function getIndices(){var savedObjectsClient=_chrome2.default.getSavedObjectsClient();return savedObjectsClient.find({type:"index-pattern",fields:["title"],search_fields:["title"],perPage:1e3}).then(function(resp){return resp.savedObjects.map(function(savedObject){return savedObject.attributes.title})}).catch(function(err){return _notify.notify.error(err,{title:"Couldn't fetch Elasticsearch indices"})})}},72:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.canUserWrite=canUserWrite;exports.getFullscreen=getFullscreen;exports.getServerFunctions=getServerFunctions;exports.getAppReady=getAppReady;exports.getBasePath=getBasePath;exports.getReportingBrowserType=getReportingBrowserType;exports.isAppReady=isAppReady;var _lodash=__webpack_require__(1);function canUserWrite(state){return(0,_lodash.get)(state,"transient.canUserWrite",true)}function getFullscreen(state){return(0,_lodash.get)(state,"transient.fullscreen",false)}function getServerFunctions(state){return(0,_lodash.get)(state,"app.serverFunctions")}function getAppReady(state){return(0,_lodash.get)(state,"app.ready")}function getBasePath(state){return(0,_lodash.get)(state,"app.basePath")}function getReportingBrowserType(state){return(0,_lodash.get)(state,"app.reportingBrowserType")}function isAppReady(state){var appReady=getAppReady(state);return appReady===true}}});